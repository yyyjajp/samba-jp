<samba:parameter name="password server"
                 context="G"
				 type="list"
                 advanced="1" wizard="1" developer="1"
		 xmlns:samba="http://www.samba.org/samba/DTD/samba-doc">
<description>
    <para> このオプションで、別の SMB サーバ(Windows NT マシンなど)の名前を指定した上で、
    <command moreinfo="none">security = [ads|domain|server]</command> 
    の設定を行なうことで、
    Samba が行なうユーザ名、パスワードの認証のすべてを指定した別のサーバに行なわせることが可能となる。</para>

    <para> このオプションでは、使用するパスワードサーバの名前あるいは IP アドレスを設定する。
    また、現在は、 ADS のレルムに対応するサーバへの接続時に使用するポートの指定にもこのオプ
ョンが使用できるようになっており、そのための書式も追加されている。
    デフォルトの LDAP ポートである 389 以外のポートを指定する場合には、名前あるいは IP アドレスの後にコロンを付けて指定する（例: 192.168.1.100:389）。
    ポートを指定しなかった場合、 Samba は標準の LDAP ポートである tcp/389 を使用する。このポート番号は、Windows NT 4.0 ドメインや NetBIOS 接続に対応するパスワードサーバには何の意味も持たないという点に注意。</para>

    <para> このパラメータの値が名前の名前解決は
    <smbconfoption name="name resolve order"/>
    パラメータで設定された方法と順番に従って行なわれるため、
    このパラメータで指定可能な任意の方式を任意の順番で組み合わせることができる。</para>

    <para> パスワードサーバは、
    「LM1.2X002」または「LM NT 0.12」プロトコルが利用可能であり、
    ユーザレベルのセキュリティモードで構成されたマシンである必要がある。</para>

    <note><para>パスワードサーバを利用するということは、
    Samba を実行している UNIX マシンのセキュリティはパスワードサーバに依存するということである。
    <emphasis> 完全に信頼することができるサーバ以外をパスワードサーバとして設定してはいけない</emphasis>。
    </para></note>

    <para> Samba サーバ自身をパスワードサーバに設定しないこと。
    これはループを発生させ、Samba サーバをフリーズさせてしまう!</para>

    <para> password server の値には、 Samba 変数も通常通り利用できるが、
   事実上有用なものは、Samba サーバに接続してきたクライアントをパスワードサーバとして設定することを意味する、
    <parameter moreinfo="none">%m</parameter> だけであろう。
    この設定はクライアントを信頼することになるため、
    hosts allow パラメータにより接続を制限することが望ましい。</para>

    <para> <parameter moreinfo="none">security</parameter> パラメータを
    <constant>domain</constant> もしくは <constant>ads</constant> に設定する場合、このオプションでは、
    ドメインのプライマリおよびバックアップドメインコントローラを指定するか、
    「*」という文字を指定する必要がある。これは、
    Samba サーバをドメインのメンバとして機能させるとともに、
    ユーザのログオン時に認証を行なうために、暗号化された認証済のRPCコールを利用するためである。
    <command moreinfo="none">security = domain</command> を用いる利点は、
    <parameter moreinfo="none">password server</parameter> 
    オプションで幾つかのサーバを指定した場合に、 <command moreinfo="none">
    smbd</command> が、どれかのサーバから応答があるまでリスト中のサーバに対して順番に問い合わせを行なっていくという点にある。
    これは、通常問い合わせを行なうサーバが停止してしまった時に効果を発揮する。</para>

    <para><parameter moreinfo="none">password server</parameter> オプションに文字 「*」 を指定すると、Samba は <constant>WORKGROUP&lt;1C&gt;</constant> への問い合わせを行い、名前解決機構から返却された IP アドレスリスト中の各サーバにアクセスを行って認証を実施するため、プライマリあるいはバックアップドメインコントローラの名前解決を自動的に実施する。</para>

    <para>「*」文字とサーバのリストの両方を指定した場合、
    リストは問い合わせを行なうサーバの優先順位として機能するが、
    それ以外の DC もリストには追加される。
    Samba は最も近い DC の位置を検出することによるリストの最適化は行なわない。
    </para>

    <para><parameter moreinfo="none">security</parameter> パラメータが
    <constant>server</constant> の場合、
    <command moreinfo="none">security = domain</command>
    の場合にはなかった制限事項が幾つか発生する:</para>

    <itemizedlist>
	<listitem>
            <para> 複数のパスワードサーバを <parameter moreinfo="none">
            password server</parameter> パラメータ中に設定できるが、
            一旦 <command moreinfo="none">smbd</command> が接続を行なったパスワードサーバが停止してしまうと、
            その <command moreinfo="none">smbd</command>
            ではそれ以上のユーザ認証が一切行なえなくなる。
            これは <command moinfo="none">security = server</command>
            モードにおける SMB/CIFS プロトコルでの制限で、Samba 側では対処できない。</para>
	</listitem>
        <listitem>
            <para> Windows NT サーバをパスワードサーバとして使っている場合、
            ユーザが Samba サーバからログオンできるようにする必要がある。
            これは、<command moreinfo="none">security = server</command> モードの場合、
            ネットワーク経由のログオンは、ユーザのワークステーションからではなく、
            Samba サーバから行われたものとして扱われるためである。</para>
        </listitem>
    </itemizedlist>
</description>

<related>security</related>
<value type="default"></value>
<value type="example">NT-PDC, NT-BDC1, NT-BDC2, *</value>
<value type="example">windc.mydomain.com:389 192.168.1.101 *</value>
<value type="example">*</value>
</samba:parameter>
