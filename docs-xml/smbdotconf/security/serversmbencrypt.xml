<samba:parameter name="server smb encrypt"
		 context="S"
		 type="enum"
		 enumlist="enum_smb_encryption_vals"
		 xmlns:samba="http://www.samba.org/samba/DTD/samba-doc">
<description>
	<para>
	This parameter controls whether a remote client is allowed or required
	to use SMB encryption. It has different effects depending on whether
	the connection uses SMB1 or SMB2 and newer:
        このパラメータは、リモートクライアントが SMB 暗号化を許可されるか、それが必要で
        あるかを制御する。これは、接続が SMB1 または SMB2 以降のどちらかに
        よって影響が異なる:
	</para>

	<itemizedlist>
	<listitem>
		<para>
                SMB1 で接続する場合、このオプションは、Unix 拡張を使う、Samba 3.2 で
                導入された、SMB プロトコルに対する Samba 固有の拡張の使用を制御する。
		</para>
	</listitem>

	<listitem>
		<para>
                SMB2 以降で接続する場合、このオプションは、SMB バージョン 3.0 以降と
                Windows 8 以降でサポートされている、SMB レベルの暗号化の使用を制御する。
		</para>
	</listitem>
	</itemizedlist>

	<para>
               このパラメータはグローバルに設定できる。取り得る値は以下の通り

		<emphasis>off</emphasis>,
		<emphasis>if_required</emphasis>,
		<emphasis>desired</emphasis>,
		and
		<emphasis>required</emphasis>.
		特別な値 <emphasis>default</emphasis> は、<emphasis>if_required</emphasis>
		の暗黙の設定である。
	</para>

	<variablelist>
		<varlistentry>
		<term><emphasis>SMB1 に対する効果</emphasis></term>
		<listitem>
		<para>
		Samba 固有の SMB1 に対する暗号化接続は、SMB プロトコルの拡張で、
                UNIX 拡張の一部としてネゴシエーションされる。SMB 暗号化は
                SMB プロトコルストリームの、すべてのリクエスト/レスポンスの暗号化と
                署名に GSSAPI (SSPI on Windows) 機能を使う。これを有効化すると、
                ssh による保護されたセッションと似た形で、SMB/CIFS 通信のセキュアな
                手法を提供するが、SMB/CIFS 認証を使用して、暗号化と署名キーを
                ネゴシエートする。現在これは、Samba 3.2 以降の smbclient のみで
                サポートされていて、早急に Linux CIFSFS と MacOS/X クライアントで
		サポートされることを期待している。Windows クライアントはこの機能を
		サポートしていない。
		</para>

		<para>これは共有毎に設定できるが、特定の共有に対する通信だけではなく、
		クライアントは全セッションを暗号化することも選べる。これが必須に
		設定された場合、共有に対するすべての通信は、共有に対して接続
		された場合、暗号化<emphasis>しなければならない</emphasis>。
		そのような共有に対して暗号化していないすべての要求には、
		サーバは、"アクセス拒否" を返す。暗号化通信を選択すると、
		より小さなサイズのパケットを使わなければならなく
		(巨大な UNIX 風の読み書きは許可されない)、すべてのデータに対して
		暗号化と署名のオーバヘッドがかかるため、スループットを減少させる。
		</para>

		<para>
		If SMB encryption is selected, Windows style SMB signing (see
		the <smbconfoption name="server signing"/> option) is no longer
		necessary, as the GSSAPI flags use select both signing and
		sealing of the data.
		SMB 暗号化を選択した場合、Windows 風の SMB 署名
		(<smbconfoption name="server signing"/>オプションを参照)
		はもはや不要で、GSSAPI フラグが署名とデータの署名とシーリング
		両方を選択する。
		</para>

		<para>
		When set to auto or default, SMB encryption is offered, but not
		enforced.  When set to mandatory, SMB encryption is required and
		if set to disabled, SMB encryption can not be negotiated.
		auto 又は 既定値に設定した場合、SMB 暗号化は提供されるが、強制
		ではない。mandatory に設定された場合、SMB 暗号化が要求され、
		無効に設定された場合は、SMB 暗号化はネゴシエートされない。
		</para>
		</listitem>
		</varlistentry>

		<varlistentry>
		<term><emphasis>SMB2 以降に対する効果</emphasis></term>
		<listitem>
		<para>
		本来の SMB トランスポート暗号化は、SMB バージョン 3.0以降で有効
                である。これは、<emphasis>server max protocol</emphasis>が
		<emphasis>SMB3</emphasis> 以降に設定された場合にのみ、
		Samba から提供される。
		クライアントは、Windows 8 以降、Windows Serer 2012 以降、
		Samba 4.1 以降の smbclient の場合、このタイプの暗号化をサポートする。
		</para>

		<para>
		プロトコルの実装は種々のオプションを提供している:
		</para>

		<itemizedlist>
			<listitem>
			<para>
			SMB 暗号化を実行する能力は、プロトコルのネゴシエーション中で
			ネゴシエートできる。
			</para>
			</listitem>

			<listitem>
			<para>
			データの暗号化はグローバルに有効に出来る。この場合、
			暗号化が可能な接続は、そのすべてのセッションのすべての
			トラフィックで暗号化される。特に、すべての共有接続は
			暗号化される。
			</para>
			</listitem>

			<listitem>
			<para>
			データの暗号化も、グローバルに有効になっていない場合は、
			共有単位に有効化できる。暗号化可能な接続では
			暗号化が有効になっている共有に対するすべての接続は
			暗号化される。
			</para>
			</listitem>

			<listitem>
			<para>
			暗号化は強制できる。これは、データの暗号化がグローバルに
			有効になっていた場合、暗号化が出来ない接続は、
			セッションのセットアップ時に拒否されることを意味する。
			そして、データの暗号化が有効になっている共有に対する
			暗号化できない接続に対して、tree 接続は拒否される。
			</para>
			</listitem>
		</itemizedlist>

		<para>
		これらの機能は、以下のように、<emphasis>server smb encrypt</emphasis>
		の設定で制御できる:
		</para>

		<itemizedlist>
			<listitem>
			<para>
                        既定のままにするには、明示的に
                        <emphasis>default</emphasis> を設定するか、
                        <emphasis>if_required</emphasis>をグローバルに設定すると、
                        暗号化をネゴシエーションするが、データ暗号化はグローバル
			あるいは共有単位には有効にならない。
			</para>
			</listitem>

			<listitem>
			<para>
			グローバルに、<emphasis>desired</emphasis> を設定すると、
                        ネゴシエーションを有効化し、これをサポートするクライアントに
			対して、セッション上と共有接続のデータ暗号化を有効化する。
			</para>
			</listitem>

			<listitem>
			<para>
			グローバルに、<emphasis>required</emphasis> を設定すると、
                        ネゴシエーションを有効化し、セッション上と共有接続のデータ
                        暗号化を有効化する。暗号化をサポートしないクライアントは
                        サーバに対するアクセスが拒否される。
			</para>
			</listitem>

			<listitem>
			<para>
			これをグローバルに<emphasis>off</emphasis>に設定すると、
			すべての接続に対して完全に暗号化機能を無効にする。
			<parameter>server smb encrypt = required</parameter>
			を特定の共有(グローバルにオフの時)に設定すると、
			すべてのクライアントからこの共有に対するアクセスを
			拒否する。
			</para>
			</listitem>

			<listitem>
			<para>
			共有に対して <emphasis>desired</emphasis> を設定すると、
			ネゴシエーションがグローバルに有効になっているとき、
			暗号化をサポートするクライアントに対して、この共有への
			データ暗号化を有効にする。
			</para>
			</listitem>

			<listitem>
			<para>
			共有に対して <emphasis>required</emphasis> を設定すると、
			ネゴシエーションがグローバルに有効になっていた場合、
			この共有に対してデータの暗号化を強制する。すなわち、
			暗号化をサポートしないクライアントはこの共有へのアクセスを
			拒否される。
			</para>
			<para>
			このことは、Windows とは異なる方法で、Samba で共有単位の強制を
			制御できることに注意:
			Windows では、<emphasis>RejectUnencryptedAccess</emphasis>が
			グローバルな設定であり、これが設定されていた場合、データの暗号化が
			有効なすべての共有は自動的に暗号化を強制される。そのため、
			Samba で同じことを行うには、<emphasis>if_required</emphasis>を
			グローバルに <emphasis>server smb encrypt</emphasis> に設定し、
			次に、暗号化を行うように、<emphasis>required</emphasis>を
			すべての共有に設定する。
			さらに、暗号化が <emphasis>required</emphasis> ないくつかの
			共有があり、暗号化のみ  <emphasis>desired</emphasis> な
			いくつかの共有を、持つことは Samba では可能であるが、これは
			Windows ではできない。
			</para>
			</listitem>

			<listitem>
			<para>
			<emphasis>off</emphasis>または<emphasis>if_required</emphasis>を
			共有に対して設定することは意味がない。
			</para>
			</listitem>
		</itemizedlist>
		</listitem>
		</varlistentry>
	</variablelist>
</description>

<value type="default">default</value>
</samba:parameter>
