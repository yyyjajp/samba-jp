'\" t
.\"     Title: vfs_shadow_copy2
.\"    Author: [FIXME: author] [see http://docbook.sf.net/el/author]
.\" Generator: DocBook XSL Stylesheets v1.75.2 <http://docbook.sf.net/>
.\"      Date: 03/20/2010
.\"    Manual: システム管理ツール
.\"    Source: Samba 3.4
.\"  Language: English
.\"
.TH "VFS_SHADOW_COPY2" "8" "03/20/2010" "Samba 3\&.4" "システム管理ツール"
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
vfs_shadow_copy2 \- Windows クライアントに対して、スナップショットを シャドウコピーとして見せる。
.SH "SYNOPSIS"
.HP \w'\ 'u
vfs objects = shadow_copy2
.SH "説明"
.PP
この VFS モジュールは
\fBsamba\fR(7)
システムの一部である。
.PP
vfs_shadow_copy2
VFS モジュールは Microsoft のシャドウコピーサービスと似た機能を提供する。 適切に設定されると、このモジュールにより Microsoft シャドウコピークライアントから Samba の共有上にある "シャドウコピー" を参照できるようになる。
.PP
これはシャドウコピーの第２版となるモジュールである。 このバージョンでは以下の機能を持つ：
.sp
.RS 4
.ie n \{\
\h'-04' 1.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  1." 4.2
.\}
あなたの共有をシンボリックリンクを使って スナップショットに向ける必要がない。これは数千個の共有があったり [homes] を使ったりする場合にとても重要なことである。
.RE
.sp
.RS 4
.ie n \{\
\h'-04' 2.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  2." 4.2
.\}
それぞれのファイルの inode 番号は変更され、 オリジナルのものとは異なる。これにより「リストア」ボタンを 押した際に共有が壊れたりすることがなくなる。
.RE
.sp
.RE
.PP
このモジュールはスタック可能である。
.SH "設定"
.PP
vfs_shadow_copy2は、ファイルシステムが スナップショットを実装していることを前提にしている。 一般的なファイルシステムの多くが標準でこれをサポートしている。
.PP
vfs_shadow_copy2が認識できるように、 ファイルシステムのスナップショットが特定の名称のディレクトリにマウント されている必要がある。スナップショットのマウントポイントは 共有ディレクトリの直下でなければならない。
.PP
スナップショットの名前形式は @GMT\-YYYY\&.MM\&.DD\-hh\&.mm\&.ss となる。 それぞれ
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
YYYYは4桁の年
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
MMは2桁の月
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
DDは2桁の日
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
hhは2桁の時
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
mm>は2桁の分
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
ss>は2桁の秒
.sp
.RE
で指定する。
.PP
vfs_shadow_copy2のスナップショットの名前形式は、 以下の\fBdate\fR(1)コマンドで生成できる：
.sp
.if n \{\
.RS 4
.\}
.nf
	TZ=GMT date +@GMT\-%Y\&.%m\&.%d\-%H\&.%M\&.%S
	
.fi
.if n \{\
.RE
.\}
.SH "オプション"
.PP
shadow:snapdir = SNAPDIR
.RS 4
スナップショットがあるディレクトリへのパス。
.RE
.PP
shadow:basedir = BASEDIR
.RS 4
スナップショットが参照するベースディレクトリへのパス。
.RE
.PP
shadow:fixinodes = yes/no
.RS 4
shadow:fixinodes
が有効の場合、このモジュールはスナップショット中のそれぞれの ファイルの見かけの inode 番号を、そのファイルのパスのハッシュ値で 修正する。これは（たとえば GPFS のスナップショットのように） スナップショットがオリジナルのファイルと同じデバイス名＋ inode 番号を持つ場合に必要となる。（訳注：そのようなシステムにおいて） このオプションを設定しないでシャドウコピー UI の「リストア」 ボタンを押すと、共有違反で失敗してしまう。
.RE
.SH "設定例"
.PP
ユーザーのホームディレクトリでシャドウコピーをサポートするには 以下の設定を行なう：
.sp
.if n \{\
.RS 4
.\}
.nf
    \fI[homes]\fR
	\m[blue]\fBvfs objects = shadow_copy2\fR\m[]
	\m[blue]\fBshadow:snapdir = /data/snaphots\fR\m[]
	\m[blue]\fBshadow:basedir = /data/home\fR\m[]
.fi
.if n \{\
.RE
.\}
.SH "警告"
.PP
これはバックアップでも、アーカイブでも、バージョン管理のための 機能でもないことに注意。
.PP
Samba と Windows の双方において、vfs_shadow_copy2
はエンドユーザのための機能として設計されている。これはバックアップや アーカイ機能を代替、もしくは拡張するものではないので、そのような認識 は禁物である。バージョン管理機能が必要であれば、バージョン管理機能を 実装する必要がある。
.SH "バージョン"
.PP
このマニュアルページは Samba システムのバージョン3\&.2\&.7(訳注:3\&.x?) に適合する。
.SH "著者"
.PP
オリジナルの Samba ソフトウェアと関連するユーティリティは、Andrew Tridgell によって作成された。現在 Samba は Samba Team に よって、Linuxカーネルの開発と同様にオープンソースプロジェクト として開発が行なわれている。
.SH "日本語訳"
.PP
このマニュアルページは Samba 3\&.2\&.7 \- 3\&.5\&.1 対応のものである。
.PP
このドキュメントの Samba 3\&.2\&.4 \- 3\&.5\&.1 対応の翻訳は
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
堀田 倫英(hotta@net\-newbie\&.com)
.sp
.RE
によって行なわれた。
