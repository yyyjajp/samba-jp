<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 46. LDAP&#12392;&#12488;&#12521;&#12531;&#12473;&#12509;&#12540;&#12488;&#23652;&#12398;&#12475;&#12461;&#12517;&#12522;&#12486;&#12451;</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="&#20844;&#24335;&#12398;Samba 3.2.x HOWTO&#12392;&#12522;&#12501;&#12449;&#12524;&#12531;&#12473;&#12460;&#12452;&#12489;"><link rel="up" href="Appendix.html" title="Part VI. Reference Section"><link rel="prev" href="speed.html" title="Chapter 45. Samba&#12497;&#12501;&#12457;&#12540;&#12510;&#12531;&#12473;&#12481;&#12517;&#12540;&#12491;&#12531;&#12464;"><link rel="next" href="ch47.html" title="&#31532;47&#31456; Samba &#12469;&#12509;&#12540;&#12488;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 46. LDAP&#12392;&#12488;&#12521;&#12531;&#12473;&#12509;&#12540;&#12488;&#23652;&#12398;&#12475;&#12461;&#12517;&#12522;&#12486;&#12451;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="speed.html">Prev</a> </td><th width="60%" align="center">Part VI. Reference Section</th><td width="20%" align="right"> <a accesskey="n" href="ch47.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 46. LDAP&#12392;&#12488;&#12521;&#12531;&#12473;&#12509;&#12540;&#12488;&#23652;&#12398;&#12475;&#12461;&#12517;&#12522;&#12486;&#12451;"><div class="titlepage"><div><div><h2 class="title"><a name="ch-ldap-tls"></a>Chapter 46. LDAP&#12392;&#12488;&#12521;&#12531;&#12473;&#12509;&#12540;&#12488;&#23652;&#12398;&#12475;&#12461;&#12517;&#12522;&#12486;&#12451;</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Gavin</span> <span class="surname">Henry</span></h3><div class="affiliation"><span class="orgname">Suretec Systems Limited, UK<br></span><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:ghenry@suretecsystems.com">ghenry@suretecsystems.com</a>&gt;</code></p></div></div></div></div><div><p class="pubdate">July 8, 2005</p></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch-ldap-tls.html#s1-intro-ldap-tls">&#27010;&#35201;</a></span></dt><dt><span class="sect1"><a href="ch-ldap-tls.html#s1-config-ldap-tls">&#35373;&#23450;</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch-ldap-tls.html#s1-config-ldap-tls-certs">&#35469;&#35388;&#23616;&#12398;&#20316;&#25104;</a></span></dt><dt><span class="sect2"><a href="ch-ldap-tls.html#s1-config-ldap-tls-server">&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#29983;&#25104;</a></span></dt><dt><span class="sect2"><a href="ch-ldap-tls.html#s1-config-ldap-tls-install">&#35388;&#26126;&#26360;&#12398;&#12452;&#12531;&#12473;&#12488;&#12540;&#12523;</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch-ldap-tls.html#s1-test-ldap-tls">&#35413;&#20385;</a></span></dt><dt><span class="sect1"><a href="ch-ldap-tls.html#s1-int-ldap-tls">&#12488;&#12521;&#12502;&#12523;&#12471;&#12517;&#12540;&#12486;&#12451;&#12531;&#12464;</a></span></dt></dl></div><div class="sect1" title="&#27010;&#35201;"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s1-intro-ldap-tls"></a>&#27010;&#35201;</h2></div></div></div><p>
	<a class="indexterm" name="id2717027"></a>
<a class="indexterm" name="id2717037"></a>
	&#29694;&#22312;&#12395;&#33267;&#12427;&#12414;&#12391;&#12289;ACL&#12398;&#12424;&#12358;&#12394;&#12289;&#12356;&#12367;&#12388;&#12363;&#12398;&#39640;&#24230;&#12394;&#27231;&#33021;&#12434;&#21547;&#12416;&#12289;
	<span class="trademark">OpenLDAP</span>&#8482;&#12398;&#31777;&#21336;&#12394;&#35373;&#23450;&#12395;&#12388;&#12356;&#12390;&#35696;&#35542;&#12375;&#12390;&#12365;&#12383;&#12290;
	&#12375;&#12363;&#12375;&#12289;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#19978;&#12398;&#36890;&#20449;&#12364;&#24341;&#12365;&#32154;&#12365;&#24179;&#25991;&#12391;&#12354;&#12427;&#12392;&#12356;&#12358;&#29694;&#29366;&#12395;&#12399;&#23550;&#24540;&#12375;&#12394;&#12356;&#12290;
	&#12371;&#12428;&#12364;&#12289;<em class="firstterm">Transport Layer Security (TLS)</em>&#12364;&#23566;&#20837;&#12373;&#12428;&#12383;
	&#29702;&#30001;&#12391;&#12354;&#12427;&#12290;
	</p><p>
<a class="indexterm" name="id2717063"></a>
	<span class="trademark">OpenLDAP</span>&#8482;&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12392;&#12469;&#12540;&#12496;&#12399;&#12289;
	<a class="ulink" href="http://rfc.net/rfc2830.html" target="_top">RFC 2830</a>(&#35379;&#27880;:&#29694;&#22312;&#12399;
	<a class="ulink" href="http://rfc.net/rfc4513.html" target="_top">RFC 4513</a>&#12364;&#26368;&#26032;)
	<span class="emphasis"><em>Lightweight Directory Access Protocol (v3):
        Extension for Transport Layer Security.</em></span>
	&#12395;&#12424;&#12427;&#12289;&#23436;&#20840;&#24615;&#12392;&#27231;&#23494;&#24615;&#12434;&#25552;&#20379;&#12377;&#12427;&#12383;&#12417;&#12289;Transport Layer Security (TLS)&#12434;&#20351;&#12358;
	&#33021;&#21147;&#12364;&#12354;&#12427;&#12290;
	</p><p>
<a class="indexterm" name="id2717102"></a>
	TLS&#12399;X.509&#35388;&#26126;&#26360;&#12434;&#20351;&#12358;&#12290;&#12377;&#12409;&#12390;&#12398;&#12469;&#12540;&#12496;&#12399;&#26377;&#21177;&#12394;&#35388;&#26126;&#26360;&#12434;&#25345;&#12388;&#24517;&#35201;&#12364;&#12354;&#12427;&#12364;&#12289;
	&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#35388;&#26126;&#26360;&#12399;&#12354;&#12387;&#12390;&#12418;&#12394;&#12367;&#12390;&#12418;&#12424;&#12356;&#12290;&#12371;&#12371;&#12391;&#12399;&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#12415;&#12434;
	&#35696;&#35542;&#12398;&#23550;&#35937;&#12392;&#12377;&#12427;&#12290;
	</p><div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>
<a class="indexterm" name="id2717121"></a>
<a class="indexterm" name="id2717128"></a>
<a class="indexterm" name="id2717134"></a>
	&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;DN&#12399;&#12469;&#12540;&#12496;&#12398;&#21517;&#21069;&#12434;&#25351;&#23450;&#12377;&#12427;CN&#23646;&#24615;&#12434;&#20351;&#12358;&#24517;&#35201;&#12364;&#12354;&#12426;&#12289;CN&#12399;&#12289;&#12469;&#12540;&#12496;&#12398;&#12289;
	&#23436;&#20840;&#12395;&#35352;&#36848;&#12373;&#12428;&#12383;&#12489;&#12513;&#12452;&#12531;&#21517;(FQDN)&#12434;&#24341;&#12365;&#32153;&#12368;&#24517;&#35201;&#12364;&#12354;&#12427;&#12290;&#36861;&#21152;&#12398;&#21029;&#21517;&#12392;
	&#12527;&#12452;&#12523;&#12489;&#12459;&#12540;&#12489;&#12399;&#12289;<code class="option">subjectAltName</code>&#35388;&#26126;&#26360;&#12456;&#12463;&#12473;&#12486;&#12531;&#12471;&#12519;&#12531;&#12395;&#23384;&#22312;&#12375;&#12390;&#12418;
	&#12424;&#12356;&#12290;&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#21517;&#21069;&#12395;&#12388;&#12356;&#12390;&#12398;&#12424;&#12426;&#35443;&#32048;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;
	<a class="ulink" href="http://rfc.net/rfc2830.html" target="_top">RFC2830</a>&#12395;&#12354;&#12427;&#12290;
	</p></div><p>
	&#12371;&#12428;&#12395;&#12388;&#12356;&#12390;&#12399;&#27425;&#12398;&#31680;&#12391;&#35443;&#32048;&#12395;&#35500;&#26126;&#12377;&#12427;&#12290;
	</p></div><div class="sect1" title="&#35373;&#23450;"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s1-config-ldap-tls"></a>&#35373;&#23450;</h2></div></div></div><p>
	<a class="indexterm" name="id2717182"></a>
	&#12371;&#12428;&#12363;&#12425;&#37325;&#35201;&#12394;&#12392;&#12371;&#12429;&#12434;&#35500;&#26126;&#12377;&#12427;&#12290;
	</p><div class="sect2" title="&#35469;&#35388;&#23616;&#12398;&#20316;&#25104;"><div class="titlepage"><div><div><h3 class="title"><a name="s1-config-ldap-tls-certs"></a>&#35469;&#35388;&#23616;&#12398;&#20316;&#25104;</h3></div></div></div><p>
<a class="indexterm" name="id2717206"></a>
	&#36969;&#20999;&#12394;&#35388;&#26126;&#26360;&#12434;&#20316;&#25104;&#12377;&#12427;&#12383;&#12417;&#12395;&#12289;&#22266;&#26377;&#12398;&#35469;&#35388;&#23616;(CA)&#12434;&#31435;&#12390;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#12290;
	<sup>[<a name="id2717219" href="#ftn.id2717219" class="footnote">8</a>]</sup>
	&#12371;&#12428;&#12399;&#24517;&#35201;&#12391;&#12354;&#12426;&#12289;&#12381;&#12358;&#12377;&#12427;&#12392;&#12289;&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12395;&#32626;&#21517;&#12391;&#12365;&#12427;&#12290;
	</p><p>
<a class="indexterm" name="id2717251"></a>
	&#12371;&#12428;&#12395;&#23550;&#12375;&#12390;&#12399;&#12289;&#12411;&#12392;&#12435;&#12393;&#12398;<span class="trademark">Linux</span>®
	&#12487;&#12451;&#12473;&#12488;&#12522;&#12499;&#12517;&#12540;&#12471;&#12519;&#12531;&#12395;&#21547;&#12414;&#12428;&#12390;&#12356;&#12427;<a class="ulink" href="http://www.openssl.org" target="_top">OpenSSL</a>
	<sup>[<a name="id2717273" href="#ftn.id2717273" class="footnote">9</a>]</sup>
	&#12434;&#20351;&#12358;&#12371;&#12392;&#12395;&#12394;&#12427;&#12290;
	</p><p>
	TLS&#12399;&#22810;&#12367;&#12398;&#31278;&#39006;&#12398;&#12469;&#12540;&#12496;&#12395;&#12424;&#12387;&#12390;&#20351;&#12431;&#12428;&#12427;&#12364;&#12289;&#12381;&#12398;&#25163;&#32154;&#12365;&#12399;&#12289;
	<sup>[<a name="id2717288" href="#ftn.id2717288" class="footnote">10</a>]</sup>
	&#12371;&#12371;&#12391;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12390;&#12289;<span class="application">OpenLDAP</span> &#12395;&#29305;&#21270;&#12375;&#12390;&#12356;&#12427;&#12290;
	</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	&#20197;&#19979;&#12398;&#20363;&#12395;&#12362;&#12369;&#12427;<span class="emphasis"><em>Common Name (CN)</em></span>&#12399;&#12289;&#20351;&#29992;&#12375;&#12390;&#12356;&#12427;LDAP&#12469;&#12540;&#12496;&#12398;
	&#23436;&#20840;&#12395;&#35352;&#36848;&#12373;&#12428;&#12383;&#12489;&#12513;&#12452;&#12531;&#21517;(FQDN)&#12391;<span class="emphasis"><em>&#12394;&#12369;&#12428;&#12400;&#12394;&#12425;&#12394;&#12356;</em></span>&#12290;
	</p></div><p>
	&#26368;&#21021;&#12395;&#35469;&#35388;&#23616;(CA)&#12434;&#29983;&#25104;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> mkdir myCA
</code>
</pre><p>
	&#12381;&#12398;&#12487;&#12451;&#12524;&#12463;&#12488;&#12522;&#12395;&#31227;&#21205;&#12377;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> cd myCA
</code>
</pre><p>
	Now generate the CA:<sup>[<a name="id2717371" href="#ftn.id2717371" class="footnote">11</a>]</sup>
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> /usr/share/ssl/misc/CA.pl -newca
CA certificate filename (or enter to create)
  
Making CA certificate ...
Generating a 1024 bit RSA private key
.......................++++++
.............................++++++
writing new private key to './demoCA/private/cakey.pem'
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:NSW
Locality Name (eg, city) []:Sydney
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Abmas
Organizational Unit Name (eg, section) []:IT
Common Name (eg, YOUR name) []:ldap.abmas.biz
Email Address []:support@abmas.biz
</code>
</pre><p>
	</p><p>
	&#27880;&#24847;&#12377;&#12409;&#12365;&#28857;&#12364;&#12356;&#12367;&#12388;&#12363;&#12354;&#12427;&#12290;
	</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
			&#12469;&#12540;&#12496;&#12398;&#35388;&#26126;&#26360;&#12395;&#32626;&#21517;&#12377;&#12427;&#12398;&#12395;&#24517;&#35201;&#12394;&#12398;&#12391;&#12289;
			&#12497;&#12473;&#12527;&#12540;&#12489;&#12434;<span class="emphasis"><em>&#35226;&#12360;&#12390;&#12362;&#12367;&#24517;&#35201;&#12364;&#12354;&#12427;</em></span>&#12290;
			</p></li><li class="listitem"><p>
			<span class="emphasis"><em>Common Name (CN)</em></span>&#12399;&#20351;&#29992;&#12375;&#12390;&#12356;&#12427;LDAP&#12469;&#12540;&#12496;&#12398;
			&#23436;&#20840;&#12395;&#35352;&#36848;&#12373;&#12428;&#12383;&#12489;&#12513;&#12452;&#12531;&#21517;(FQDN)&#12391;<span class="emphasis"><em>&#12394;&#12369;&#12428;&#12400;&#12394;&#12425;&#12394;&#12356;</em></span>&#12290;
			</p></li></ol></div></div><div class="sect2" title="&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#29983;&#25104;"><div class="titlepage"><div><div><h3 class="title"><a name="s1-config-ldap-tls-server"></a>&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#29983;&#25104;</h3></div></div></div><p>
	&#27425;&#12395;&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12434;&#29983;&#25104;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> openssl req -new -nodes -keyout newreq.pem -out newreq.pem
Generating a 1024 bit RSA private key
.............++++++
........................................................++++++
writing new private key to 'newreq.pem'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:AU
State or Province Name (full name) [Some-State]:NSW
Locality Name (eg, city) []:Sydney
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Abmas
Organizational Unit Name (eg, section) []:IT
Common Name (eg, YOUR name) []:ldap.abmas.biz
Email Address []:support@abmas.biz
  
Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:
</code>
</pre><p>
	</p><p>
	&#32368;&#12426;&#36820;&#12377;&#12364;&#12289;&#12371;&#12371;&#12391;&#12418;&#12356;&#12367;&#12388;&#12363;&#27880;&#24847;&#12377;&#12409;&#12365;&#20107;&#12364;&#12354;&#12427;&#12290;
	</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
			&#12497;&#12473;&#12527;&#12540;&#12489;&#12434;&#20837;&#21147;<span class="emphasis"><em>&#12377;&#12409;&#12365;&#12391;&#12399;&#12394;&#12356;</em></span>&#12290;
			</p></li><li class="listitem"><p>
                        <span class="emphasis"><em>Common Name (CN)</em></span>&#12399;&#20351;&#29992;&#12375;&#12390;&#12356;&#12427;LDAP&#12469;&#12540;&#12496;&#12398;
                        &#23436;&#20840;&#12395;&#35352;&#36848;&#12373;&#12428;&#12383;&#12489;&#12513;&#12452;&#12531;&#21517;(FQDN)&#12391;<span class="emphasis"><em>&#12394;&#12369;&#12428;&#12400;&#12394;&#12425;&#12394;&#12356;</em></span>&#12290;
			</p></li></ol></div><p>
	&#27425;&#12395;&#26032;&#12375;&#12356;&#35469;&#35388;&#23616;(CA)&#12398;&#35388;&#26126;&#26360;&#12395;&#32626;&#21517;&#12377;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> /usr/share/ssl/misc/CA.pl -sign
Using configuration from /etc/ssl/openssl.cnf
Enter pass phrase for ./demoCA/private/cakey.pem:
Check that the request matches the signature
Signature ok
Certificate Details:
Serial Number: 1 (0x1)
Validity
	Not Before: Mar  6 18:22:26 2005 EDT
	Not After : Mar  6 18:22:26 2006 EDT
Subject:
	countryName               = AU
	stateOrProvinceName       = NSW
	localityName              = Sydney
	organizationName          = Abmas
	organizationalUnitName    = IT
	commonName                = ldap.abmas.biz
	emailAddress              = support@abmas.biz
X509v3 extensions:
	X509v3 Basic Constraints:
	    CA:FALSE
	Netscape Comment:
	    OpenSSL Generated Certificate
	X509v3 Subject Key Identifier:
	    F7:84:87:25:C4:E8:46:6D:0F:47:27:91:F0:16:E0:86:6A:EE:A3:CE
	X509v3 Authority Key Identifier:
	    keyid:27:44:63:3A:CB:09:DC:B1:FF:32:CC:93:23:A4:F1:B4:D5:F0:7E:CC
	    DirName:/C=AU/ST=NSW/L=Sydney/O=Abmas/OU=IT/
						CN=ldap.abmas.biz/emailAddress=support@abmas.biz
	    serial:00

Certificate is to be certified until Mar  6 18:22:26 2006 EDT (365 days)
Sign the certificate? [y/n]:y


1 out of 1 certificate requests certified, commit? [y/n]y
Write out database with 1 new entries
Data Base Updated
Signed certificate is in newcert.pem
</code>
</pre><p>
	</p><p>
	&#12371;&#12428;&#12391;&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#29983;&#25104;&#12364;&#23436;&#20102;&#12377;&#12427;&#12290;
	</p></div><div class="sect2" title="&#35388;&#26126;&#26360;&#12398;&#12452;&#12531;&#12473;&#12488;&#12540;&#12523;"><div class="titlepage"><div><div><h3 class="title"><a name="s1-config-ldap-tls-install"></a>&#35388;&#26126;&#26360;&#12398;&#12452;&#12531;&#12473;&#12488;&#12540;&#12523;</h3></div></div></div><p>
	&#27425;&#12395;&#12289;&#27491;&#12375;&#12356;&#35373;&#23450;&#12487;&#12451;&#12524;&#12463;&#12488;&#12522;&#20013;&#12395;&#35388;&#26126;&#26360;&#12434;&#12467;&#12500;&#12540;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12426;&#12289;&#12381;&#12398;&#24460;&#21516;&#26178;&#12395;&#25913;&#21517;&#12375;&#12390;
	(&#21033;&#20415;&#24615;&#12398;&#12383;&#12417;&#12395;)&#12289;&#25152;&#26377;&#27177;&#12434;&#22793;&#26356;&#12375;&#12289;&#26368;&#24460;&#12395;&#12450;&#12463;&#12475;&#12473;&#35377;&#21487;&#12434;&#19982;&#12360;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> cp demoCA/cacert.pem /etc/openldap/
<code class="prompt">root# </code> cp newcert.pem /etc/openldap/servercrt.pem
<code class="prompt">root# </code> cp newreq.pem /etc/openldap/serverkey.pem
<code class="prompt">root# </code> chown ldap.ldap /etc/openldap/*.pem
<code class="prompt">root# </code> chmod 640 /etc/openldap/cacert.pem;
<code class="prompt">root# </code> chmod 600 /etc/openldap/serverkey.pem
</code>
</pre><p>
	</p><p>
	&#27425;&#12395;&#12289;&#12371;&#12428;&#12425;&#12398;&#12501;&#12449;&#12452;&#12523;&#20301;&#32622;&#24773;&#22577;&#12434;&#12289;&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#12375;&#12390;&#12289;<code class="filename">slapd.conf</code>
	&#12398;&#12289;<code class="option">database</code>&#23450;&#32681;&#12398;&#21069;&#12398;&#12393;&#12371;&#12363;&#12395;&#36861;&#21152;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
TLSCertificateFile /etc/openldap/servercrt.pem
TLSCertificateKeyFile /etc/openldap/serverkey.pem
TLSCACertificateFile /etc/openldap/cacert.pem
</code>
</pre><p>
	</p><p>
	&#20197;&#19979;&#12399;&#12289;<code class="filename">ldap.conf</code>&#12391;&#12398;&#23450;&#32681;&#12391;&#12354;&#12427;:
<code class="filename">ldap.conf</code>
</p><pre class="screen" width="90">
<code class="computeroutput">
TLS_CACERT /etc/openldap/cacert.pem
</code>
</pre><p>
	</p><p>
	&#12371;&#12428;&#12391;&#12377;&#12409;&#12390;&#12391;&#12354;&#12427;&#12290;&#27425;&#12395;<a class="xref" href="ch-ldap-tls.html#s1-test-ldap-tls" title="&#35413;&#20385;">the section called &#8220;&#35413;&#20385;&#8221;</a>&#12434;&#34892;&#12358;&#12290;
	</p></div></div><div class="sect1" title="&#35413;&#20385;"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s1-test-ldap-tls"></a>&#35413;&#20385;</h2></div></div></div><p>
<a class="indexterm" name="id2717797"></a>
&#12371;&#12371;&#12399;&#31777;&#21336;&#12394;&#37096;&#20998;&#12391;&#12354;&#12427;&#12290;&#12469;&#12540;&#12496;&#12434;&#20877;&#36215;&#21205;&#12377;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> /etc/init.d/ldap restart
Stopping slapd:                                            [  OK  ]
Checking configuration files for slapd: config file testing succeeded
Starting slapd:                                            [  OK  ]
</code>
</pre><p>
	&#27425;&#12395;&#12289;<code class="literal">ldapsearch</code>&#12434;&#20351;&#12356;&#12289;<code class="option">-ZZ</code>&#12458;&#12503;&#12471;&#12519;&#12531;&#12434;&#20351;&#12387;&#12390;
	<sup>[<a name="id2717842" href="#ftn.id2717842" class="footnote">12</a>]</sup>
	&#21311;&#21517;&#26908;&#32034;&#12391;&#35413;&#20385;&#12377;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> ldapsearch -x -b "dc=ldap,dc=abmas,dc=biz" \
        -H 'ldap://ldap.abmas.biz:389' -ZZ
</code>
</pre><p>
	&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#12289;&#12469;&#12540;&#12496;&#12434;&#20877;&#36215;&#21205;&#12377;&#12427;&#21069;&#12392;&#32080;&#26524;&#12399;&#21516;&#12376;&#12391;&#12354;&#12427;&#12409;&#12365;&#12391;&#12354;&#12427;:
</p><pre class="screen" width="90">
<code class="computeroutput">
<code class="prompt">root# </code> ldapsearch -x -b "dc=ldap,dc=abmas,dc=biz" \
    -H 'ldap://ldap.abmas.biz:389' -ZZ

# extended LDIF
#
# LDAPv3
# base &lt;&gt; with scope sub
# filter: (objectclass=*)
# requesting: ALL
#

# abmas.biz
dn: dc=ldap,dc=abmas,dc=biz
objectClass: dcObject
objectClass: organization
o: Abmas
dc: abmas

# Manager, ldap.abmas.biz
dn: cn=Manager,dc=ldap,dc=abmas,dc=biz
objectClass: organizationalRole
cn: Manager

# ABMAS, abmas.biz
dn: sambaDomainName=ABMAS,dc=ldap,dc=abmas,dc=biz
sambaDomainName: ABMAS
sambaSID: S-1-5-21-238355452-1056757430-1592208922
sambaAlgorithmicRidBase: 1000
objectClass: sambaDomain
sambaNextUserRid: 67109862
sambaNextGroupRid: 67109863
</code>
</pre><p>
	&#20309;&#12363;&#21839;&#38988;&#12364;&#36215;&#12365;&#12383;&#22580;&#21512;&#12399;&#12289;<a class="xref" href="ch-ldap-tls.html#s1-int-ldap-tls" title="&#12488;&#12521;&#12502;&#12523;&#12471;&#12517;&#12540;&#12486;&#12451;&#12531;&#12464;">the section called &#8220;&#12488;&#12521;&#12502;&#12523;&#12471;&#12517;&#12540;&#12486;&#12451;&#12531;&#12464;&#8221;</a>&#12434;&#35501;&#12435;&#12391;&#12415;&#12390;&#12411;&#12375;&#12356;&#12290;
</p></div><div class="sect1" title="&#12488;&#12521;&#12502;&#12523;&#12471;&#12517;&#12540;&#12486;&#12451;&#12531;&#12464;"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s1-int-ldap-tls"></a>&#12488;&#12521;&#12502;&#12523;&#12471;&#12517;&#12540;&#12486;&#12451;&#12531;&#12464;</h2></div></div></div><p>
<a class="indexterm" name="id2717945"></a>
TLS&#12434;&#35373;&#23450;&#12375;&#12390;&#12356;&#12427;&#12392;&#12365;&#12395;&#26368;&#12418;&#12424;&#12367;&#12354;&#12427;&#12456;&#12521;&#12540;&#12399;&#12289;&#20309;&#22238;&#12418;&#35500;&#26126;&#12375;&#12383;&#12424;&#12358;&#12395;&#12289;
<a class="xref" href="ch-ldap-tls.html#s1-config-ldap-tls-server" title="&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#29983;&#25104;">the section called &#8220;&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12398;&#29983;&#25104;&#8221;</a>&#12391;&#20837;&#21147;&#12375;&#12383;<span class="emphasis"><em>Common Name (CN)</em></span>&#12364;&#12289;
&#20351;&#29992;&#12375;&#12390;&#12356;&#12427;LDAP&#12469;&#12540;&#12496;&#12398;&#12289;&#23436;&#20840;&#12395;&#35352;&#36848;&#12373;&#12428;&#12383;&#12489;&#12513;&#12452;&#12531;&#21517;(FQDN)<span class="emphasis"><em>&#12391;&#12394;&#12356;</em></span>&#12392;&#12356;&#12358;
&#12418;&#12398;&#12391;&#12354;&#12427;&#12290;
</p><p>
&#20182;&#12398;&#12456;&#12521;&#12540;&#12392;&#12375;&#12390;&#12399;&#12289;<code class="literal">ldapsearch</code>&#12467;&#12510;&#12531;&#12489;&#12398;&#12393;&#12371;&#12363;&#12391;&#12479;&#12452;&#12503;&#12511;&#12473;&#12375;&#12383;&#12392;&#12363;&#12289;
<code class="filename">servercrt.pem</code>&#12392;<code class="filename">cacert.pem</code>&#12395;&#38291;&#36949;&#12387;&#12383;&#12450;&#12463;&#12475;&#12473;
&#35377;&#21487;&#12434;&#35373;&#23450;&#12375;&#12390;&#12356;&#12427;&#12363;&#12391;&#12354;&#12427;&#12290;<a class="xref" href="ch-ldap-tls.html#s1-config-ldap-tls-install" title="&#35388;&#26126;&#26360;&#12398;&#12452;&#12531;&#12473;&#12488;&#12540;&#12523;">the section called &#8220;&#35388;&#26126;&#26360;&#12398;&#12452;&#12531;&#12473;&#12488;&#12540;&#12523;&#8221;</a>&#21336;&#20301;&#12395;
<code class="literal">chmod 640</code>&#12391;&#35373;&#23450;&#12377;&#12409;&#12365;&#12391;&#12354;&#12427;&#12290;
</p><p>
&#12381;&#12428;&#20197;&#22806;&#12399;&#12289;ldap&#12398;&#12525;&#12464;&#12501;&#12449;&#12452;&#12523;&#12434;&#35501;&#12416;&#12363;&#12289;<span class="application">OpenLDAP</span>&#12513;&#12540;&#12522;&#12531;&#12464;&#12522;&#12473;&#12488;&#12395;&#21442;&#21152;&#12377;&#12427;&#12398;&#12364;&#26368;&#12418;&#33391;&#12356;&#26041;&#27861;
&#12391;&#12354;&#12427;&#12290;
</p></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.id2717219" href="#id2717219" class="para">8</a>] </sup>&#12375;&#12363;&#12375;&#12289;&#20316;&#25104;&#12375;&#12383;&#12469;&#12540;&#12496;&#35388;&#26126;&#26360;&#12399;&#12289;&#12383;&#12392;&#12360;&#12400;&#12289;
	<a class="ulink" href="http://www.thawte.com/" target="_top">Thawte</a>&#12392;
	<a class="ulink" href="http://www.verisign.com/" target="_top">VeriSign</a>&#12398;&#12424;&#12358;&#12394;&#12289;&#26377;&#26009;&#12414;&#12383;&#12399;
	<a class="ulink" href="http://www.cacert.org/" target="_top">CAcert</a>&#32076;&#30001;&#12398;&#12289;&#28961;&#26009;&#12398;&#12418;&#12398;&#12434;&#20351;&#12387;&#12390;&#12289;
	&#36969;&#20999;&#12394;CA&#12395;&#12424;&#12387;&#12390;&#32626;&#21517;&#12373;&#12428;&#12427;&#12424;&#12358;&#12395;&#12391;&#12365;&#12427;&#12290;</p></div><div class="footnote"><p><sup>[<a name="ftn.id2717273" href="#id2717273" class="para">9</a>] </sup>&#22266;&#26377;&#12398;&#35469;&#35388;&#23616;(CA)&#12434;&#20316;&#12427;&#12371;&#12392;&#12398;&#19981;&#37117;&#21512;&#12394;&#28857;&#12399;&#12289;&#21830;&#29992;&#12398;&#12418;&#12398;&#12364;&#12381;&#12358;&#12391;&#12354;&#12427;&#12424;&#12358;&#12395;&#12289;
	&#35388;&#26126;&#26360;&#12364;&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12395;&#12424;&#12387;&#12390;&#33258;&#21205;&#30340;&#12395;&#35469;&#35672;&#12373;&#12428;&#12394;&#12356;&#12392;&#12356;&#12358;&#12371;&#12392;&#12391;&#12354;&#12427;&#12290;</p></div><div class="footnote"><p><sup>[<a name="ftn.id2717288" href="#id2717288" class="para">10</a>] </sup>&#19968;&#30058;&#30906;&#12363;&#12394;&#12392;&#12371;&#12429;&#12363;&#12425;&#12398;&#24773;&#22577;&#12399;&#12289;
	<a class="ulink" href="http://www.openssl.org/docs/HOWTO/" target="_top">http://www.openssl.org/docs/HOWTO/</a>
	&#12398;main OpenSSL&#12469;&#12452;&#12488;&#12434;&#21442;&#29031;&#12398;&#12371;&#12392;&#12290;</p></div><div class="footnote"><p><sup>[<a name="ftn.id2717371" href="#id2717371" class="para">11</a>] </sup>Your <code class="filename">CA.pl</code> or <code class="filename">CA.sh</code> might not be
	in the same location as mine is, you can find it by using the <code class="literal">locate</code> command, i.e.,
	<code class="literal">locate CA.pl</code>.  If the command complains about the database being too old, run
	<code class="literal">updatedb</code> as <span class="emphasis"><em>root</em></span> to update it.</p></div><div class="footnote"><p><sup>[<a name="ftn.id2717842" href="#id2717842" class="para">12</a>] </sup><code class="literal">man ldapsearch</code>&#12434;&#21442;&#29031;</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="speed.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="Appendix.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch47.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 45. Samba&#12497;&#12501;&#12457;&#12540;&#12510;&#12531;&#12473;&#12481;&#12517;&#12540;&#12491;&#12531;&#12464; </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> &#31532;47&#31456; Samba &#12469;&#12509;&#12540;&#12488;</td></tr></table></div></body></html>
