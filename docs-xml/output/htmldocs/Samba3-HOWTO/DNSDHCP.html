<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 48. DNSとDHCP設定ガイド</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="公式のSamba 3.2.x HOWTOとリファレンスガイド"><link rel="up" href="Appendix.html" title="Part VI. Reference Section"><link rel="prev" href="ch47.html" title="第47章 Samba サポート"><link rel="next" href="apa.html" title="Appendix A.  GNU General Public License version 3"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 48. DNSとDHCP設定ガイド</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch47.html">Prev</a> </td><th width="60%" align="center">Part VI. Reference Section</th><td width="20%" align="right"> <a accesskey="n" href="apa.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 48. DNSとDHCP設定ガイド"><div class="titlepage"><div><div><h2 class="title"><a name="DNSDHCP"></a>Chapter 48. DNSとDHCP設定ガイド</h2></div><div><div class="author"><h3 class="author"><span class="firstname">John</span> <span class="othername">H.</span> <span class="surname">Terpstra</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jht@samba.org">jht@samba.org</a>></code></p></div></div></div></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="DNSDHCP.html#id2718527">機能と利便性</a></span></dt><dt><span class="sect1"><a href="DNSDHCP.html#id2718759">設定例</a></span></dt><dd><dl><dt><span class="sect2"><a href="DNSDHCP.html#id2718875">ダイナミックDNS</a></span></dt><dt><span class="sect2"><a href="DNSDHCP.html#DHCP">DHCPサーバ</a></span></dt></dl></dd></dl></div><div class="sect1" title="機能と利便性"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2718527"></a>機能と利便性</h2></div></div></div><p><a class="indexterm" name="id2718535"></a><a class="indexterm" name="id2718544"></a>UNIXの領域においては、Domain Name System (DNS) と Dynamic Host Configuration Protocol (DHCP)と同じくらいたくさんの論争が起こる主題はない。DNSとDHCPの特定の実装に賛成、反対する意見の一部は有効である。There are few subjects in the UNIX world that might raise as much contention asDomain Name System (DNS) and Dynamic Host Configuration Protocol (DHCP).Not all opinions held for or against particular implementations of DNS and DHCPare valid.</p><p>多くの情報技術を利用する人が、携帯性と利用の自由を要求する現代に、我々は生きている。Microsoft Windows ユーザは特に、使用しているノートPCをネットワークに繋げば、<span class="quote">“<span class="quote">ちゃんと動く</span>”</span>事を期待している。</p><p><a class="indexterm" name="id2718582"></a>UNIX管理者はpoint。Microsoft Windowsの領域における多くの標準的な習慣が、セキュリティの観点からは悪い習慣上で最も良い境界にある(???)。Microsoft Windows ネットワークプロトコルは、ネットワーク上に、ワークステーションそれ自身を登録する機能を用意している。Windows 2000のActive DirectoryはDNS名前空間に、UNIX管理者が困惑するような、エントリを登録する。世界は変わってしまったのである!UNIX administrators have a point. Many of the normative practices in the MicrosoftWindows world at best border on bad practice from a security perspective.Microsoft Windows networking protocols allow workstations to arbitrarily registerthemselves on a network. Windows 2000 Active Directory registers entries in the DNS namespacethat are equally perplexing to UNIX administrators. Welcome to the new world!</p><p><a class="indexterm" name="id2718623"></a><a class="indexterm" name="id2718632"></a><a class="indexterm" name="id2718641"></a>この章の目的は、Microsoft Windows 2000 サーバ製品中でのものと互換性のある、動的サービスを提供するために、Internet Software Consortium (ISC) のDNSとDHCPサーバの設定をデモすることである。</p><p>この章では、DNSとDHCPサーバの両方に対する、動く設定ファイルの例を提供する以上のものではない。例は、このドキュメント中のどこかで使われている設定例に一致するものを使う。</p><p><a class="indexterm" name="id2718674"></a><a class="indexterm" name="id2718680"></a><a class="indexterm" name="id2718687"></a>この章では、明示的にチュートリアルでも、全体として、この文書の意図と範囲を超えているので、DNSとDHCPのリファレンスガイドの代替品を提供しない。DNSまたはDHCPについてのより詳細な参考情報を知りたいのであれば、ISCのWebサイト <a class="ulink" href="http://www.isc.org" target="_top"> http://www.isc.org</a>を参照のこと。書籍として情報が欲しいのであれば、<a class="ulink" href="http://www.oreilly.com/catalog/dns/index.htm" target="_top">オライリー</a>のWebサイトに行って、DNSの本の情報を、また、<a class="ulink" href="http://www.bind9.net/books-dhcp" target="_top">BIND9.NET</a>というWebサイトを見てみると良い。書籍情報は以下の通り:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>DNS and BIND, By Cricket Liu, Paul Albitz, ISBN: 1-56592-010-4(訳注:日本語訳あり)</p></li><li class="listitem"><p>DNS & Bind Cookbook, By Cricket Liu, ISBN: 0-596-00410-9</p></li><li class="listitem"><p>The DHCP Handbook (2nd Edition), By: Ralph Droms, Ted Lemon, ISBN 0-672-32327-3</p></li></ol></div></div><div class="sect1" title="設定例"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2718759"></a>設定例</h2></div></div></div><p><a class="indexterm" name="id2718767"></a><a class="indexterm" name="id2718774"></a>DNSは、インターネットにとっては、生活における水のようなものである。ほとんどすべての情報リソース(ホスト名)はDNSを通してそのIPアドレスに解決される。WindowsネットワークはDNSの複雑さを防ぐために、かなりいろいろな事をやっていたが、結局DNSの勝ちであった。<a class="indexterm" name="id2718790"></a>DNSの代わりとしてWindows Internet Name Service (WINS) がある。NetBIOS networking over the TCP/IPプロトコルの悪い点は、情報技術ネットワークの複雑さと規模が発展していく時に、管理できなくなる、平坦で階層構造のない名前空間のような拡張性の問題が明らかとなっていることである。</p><p><a class="indexterm" name="id2718816"></a><a class="indexterm" name="id2718823"></a>WINSはMicrosoftによるRFC1001/1002 NetBIOS Name Service (NBNS)の実装である。これは、NetBIOSクライアント(Microsoft Windowsマシンのような)に、マシンに与えられたIPアドレスと一緒に管理者かユーザが選べる任意のマシン名を解決することができる。WINSを使うと、ネットワーククライアントマシンは、マシン名をそのIPアドレスに解決できる。</p><p>NetBIOSネットワークファミリの制限に対する代替のための要求は、最終的に、MicrosoftがDNSとActive Directoryを使うように追い込んだ。Microsoftの新しい実装は、NetBIOSネットワークにおいて、WINSが使われる方法と同様のやり方で、DNSを使うことを試みている。WINSとMicrosoft DNSの両方は、動的な名前登録に頼っている。</p><p>Microsoft Windows クライアントは起動時にDNSサーバに対して動的な名前登録を行うことができる。その代わりに、ワークステーションのIPアドレスを割り当てるところにDNSが使われる場面において、クライアントが、IPアドレスの貸出を受け取ったら直ちに、DHCPサーバによってそのホスト名とIPアドレスを登録することが出来る。最後に、Microsoft DNSは、Microsoft WINS経由でホスト名を解決できる。</p><p>以下の設定は、単純な、セキュリティを考慮していないDNSサーバと、DNSの設定にあわせた単純なDHCPサーバの例を提示している。</p><div class="sect2" title="ダイナミックDNS"><div class="titlepage"><div><div><h3 class="title"><a name="id2718875"></a>ダイナミックDNS</h3></div></div></div><p>	<a class="indexterm" name="id2718883"></a>	DNS設定の例は、ネットワーク 192.168.1.0/25のIPアドレス範囲中のプライベート	ネットワーク用である。プライベートなネットワークアドレス空間はRFC1918に	説明がある。	</p><p>	<a class="indexterm" name="id2718903"></a>	このネットワークは安全なファイアウォールの内側に位置していることを仮定している。	以下のファイルはISC BINDバージョン9用である。BINDは	Berkeley Internet Name Daemonの略である。	</p><p>	マスタ設定ファイル<code class="filename">/etc/named.conf</code>は、この後使用する	すべての設定ファイルの位置を決める。このファイルの位置と名前は、OSの一部である	起動スクリプト内で指定されている。</p><pre class="programlisting"># Quenya.Org の設定ファイルacl mynet {	192.168.1.0/24;	127.0.0.1;};options {	directory "/var/named";	listen-on-v6 { any; };	notify no;	forward first;	forwarders {		192.168.1.1;		};	auth-nxdomain yes;	multiple-cnames yes;	listen-on {		mynet;		};};# The following three zone definitions do not need any modification.# The first one defines localhost while the second defines the# reverse lookup for localhost. The last zone "." is the# definition of the root name servers.zone "localhost" in {	type master;	file "localhost.zone";};zone "0.0.127.in-addr.arpa" in {	type master;	file "127.0.0.zone";};zone "." in {	type hint;	file "root.hint";};# You can insert further zone records for your own domains below.zone "quenya.org" {	type master;	file "/var/named/quenya.org.hosts";	allow-query {		mynet;		};	allow-transfer {		mynet;		};	allow-update {		mynet;		};	};zone "1.168.192.in-addr.arpa" {	type master;	file "/var/named/192.168.1.0.rev";	allow-query {		mynet;	};	allow-transfer {		mynet;	};	allow-update {		mynet;	};};</pre><p>	</p><p>	以下のファイルはすべて<code class="filename">/var/named</code>というディレクトリにある。	これは<code class="filename">/var/named/localhost.zone</code>ファイルである:</p><pre class="programlisting">$TTL 1W@               IN SOA  @   root (				42              ; serial (d. adams)				2D              ; refresh				4H              ; retry				6W              ; expiry				1W )            ; minimum		IN NS           @		IN A            127.0.0.1	</pre><p>	</p><p>	<code class="filename">/var/named/127.0.0.zone</code>ファイルである:</p><pre class="programlisting">$TTL 1W@               IN SOA          localhost.  root.localhost. (				42              ; serial (d. adams)				2D              ; refresh				4H              ; retry				6W              ; expiry				1W )            ; minimum				IN NS           localhost.1               IN PTR          localhost.</pre><p>	</p><p>		<code class="filename">/var/named/quenya.org.host</code>ファイルである:</p><pre class="programlisting">$ORIGIN .$TTL 38400      ; 10 hours 40 minutesquenya.org      IN SOA  marvel.quenya.org. root.quenya.org. (				2003021832 ; serial				10800      ; refresh (3 hours)				3600       ; retry (1 hour)				604800     ; expire (1 week)				38400      ; minimum (10 hours 40 minutes)				)			NS      marvel.quenya.org.			MX      10 mail.quenya.org.$ORIGIN quenya.org.frodo                   A       192.168.1.1marvel                  A       192.168.1.2;mail                    CNAME   marvelwww                     CNAME   marvel</pre><p></p><p>	<code class="filename">/var/named/192.168.1.0.rev</code>ファイルである:</p><pre class="programlisting">$ORIGIN .$TTL 38400      ; 10 hours 40 minutes1.168.192.in-addr.arpa  IN SOA  marvel.quenya.org. root.quenya.org. (				2003021824 ; serial				10800      ; refresh (3 hours)				3600       ; retry (1 hour)				604800     ; expire (1 week)				38400      ; minimum (10 hours 40 minutes)				)			NS      marvel.quenya.org.$ORIGIN 1.168.192.in-addr.arpa.1                       PTR     frodo.quenya.org.2                       PTR     marvel.quenya.org.</pre><p>	</p><p><a class="indexterm" name="id2719067"></a><a class="indexterm" name="id2719074"></a>	ここで示された設定ファイルは完全に動くシステムからコピーしたものである。すべての	動的に登録されるエントリは削除されている。それらのファイルに対してはさらに、	BINDバージョン9が、<code class="filename">.jnl</code>という拡張子を持つファイルである、	各動的登録ファイルを作成する。構成ファイルと作成された<code class="filename">.jnl</code>	ファイルを編集したり、不正に変更してはならない。	</p></div><div class="sect2" title="DHCPサーバ"><div class="titlepage"><div><div><h3 class="title"><a name="DHCP"></a>DHCPサーバ</h3></div></div></div><p>	以下のファイルはISC DHCPサーバ バージョン3で使われる。ファイルは、	<code class="filename">/etc/dhcpd.conf</code>にある:	</p><p>	</p><pre class="programlisting">ddns-updates on;ddns-domainname "quenya.org";option ntp-servers 192.168.1.2;ddns-update-style ad-hoc;allow unknown-clients;default-lease-time 86400;max-lease-time 172800;option domain-name "quenya.org";option domain-name-servers 192.168.1.2;option netbios-name-servers 192.168.1.2;option netbios-dd-server 192.168.1.2;option netbios-node-type 8;subnet 192.168.1.0 netmask 255.255.255.0 {	range dynamic-bootp 192.168.1.60 192.168.1.254;	option subnet-mask 255.255.255.0;	option routers 192.168.1.2;	allow unknown-clients;}</pre><p>	</p><p>	この例では、192.168.1.1と192.168.1.59のIPアドレス範囲は固定IPアドレス	(よく<code class="constant">hard-wired</code>と呼ばれる)のために予約されている。	192.168.1.60から192.168.1.254の間のアドレスは動的な割り当てに使われる。	</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch47.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="Appendix.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="apa.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">第47章 Samba サポート </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Appendix A.     <acronym class="acronym">GNU</acronym> General Public License version 3  </td></tr></table></div></body></html>