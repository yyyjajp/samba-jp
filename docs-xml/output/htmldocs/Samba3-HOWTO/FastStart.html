<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 2. 手軽な始め方: 短気な方への手引き</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="公式のSamba 3.2.x HOWTOとリファレンスガイド"><link rel="up" href="introduction.html" title="Part I. 概要"><link rel="prev" href="install.html" title="Chapter 1. SAMBAのインストールとテスト方法"><link rel="next" href="type.html" title="Part II. サーバ設定の基本"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 2. 手軽な始め方: 短気な方への手引き</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="install.html">Prev</a> </td><th width="60%" align="center">Part I. 概要</th><td width="20%" align="right"> <a accesskey="n" href="type.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 2. 手軽な始め方: 短気な方への手引き"><div class="titlepage"><div><div><h2 class="title"><a name="FastStart"></a>Chapter 2. 手軽な始め方: 短気な方への手引き</h2></div><div><div class="author"><h3 class="author"><span class="firstname">John</span> <span class="othername">H.</span> <span class="surname">Terpstra</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jht@samba.org">jht@samba.org</a>></code></p></div></div></div></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="FastStart.html#id2560639">機能と利点</a></span></dt><dt><span class="sect1"><a href="FastStart.html#id2560672">例題サイトの説明</a></span></dt><dt><span class="sect1"><a href="FastStart.html#id2560778">動く例</a></span></dt><dd><dl><dt><span class="sect2"><a href="FastStart.html#id2560805">スタンドアロンサーバ</a></span></dt><dt><span class="sect2"><a href="FastStart.html#id2562709">ドメインメンバサーバ</a></span></dt><dt><span class="sect2"><a href="FastStart.html#id2563629">ドメインコントローラ</a></span></dt></dl></dd></dl></div><p>Samba HOWTO文書中に含めるものについての最初に提案を受けた時、だれかが問い合わせのためのサンプル設定をたくさん書いた。これは、動いているシステムからたくさんのエッセンスを提示することに由来するたくさんの価値を失わないで行う事が甚だしく難しい。それがドキュメントに抜けているものである。それをカバーする章の内容の中に設定の可能性の広範囲な説明がある。この章は、要求されたことに対する処方であると思いたい。</p><p>この章中の情報は、ほとんど完成したこの本のオリジナルバージョンの後に書かれた<span class="quote">“<span class="quote">Samba-3 by Example</span>”</span>という本と比較してとてもまばらである。<span class="quote">“<span class="quote">Samba-3 by Example</span>”</span>は最初の版の最終稿をレビューした結果をフィードバックしたものである。読者フィードバックが、オリジナルのレビュアにより反映が行われることを見ることは興味深かった。どの場合にも、経験あるネットワーク管理者がそこから得るものと同様、何が新しいかをより理解するための基礎的な調査に1ヶ月半かかった。<span class="quote">“<span class="quote">Samba-3 by Example</span>”</span>はその調査の結果である。この本のいくつかのページで提供されているものは、より包括的に<span class="quote">“<span class="quote">Samba-3 by Example</span>”</span>の第二版でカバーしている。両方のほんの第二版は同じ時期にリリースされた。</p><p>まとめると、<span class="quote">“<span class="quote">公式のSamba-3 HOWTO & リファレンスガイド</span>”</span>は自動車修理工の修理ガイドと同等のものとして意図されている。<span class="quote">“<span class="quote">Samba-3 by Example</span>”</span>は、どのように車を運転するかを説明するドライバ向けのガイドと同等である。もしもネットワークの設定例を完全にしたいのであれば、<a class="ulink" href="http://www.samba.org/samba/docs/Samba3-ByExample.pdf" target="_top">Samba-3 byExample</a>を参照すること。</p><div class="sect1" title="機能と利点"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2560639"></a>機能と利点</h2></div></div></div><p>基本的な動作するシステムを作成するために、Sambaは最小限の設定しか必要としない。この節では、簡単なものから複雑なものへ、おのおのを動かすために必要とされる設定ファイルの変更とすべてのステップを順番に提供する。徹底的に設定されたシステムは、追加の高機能な機能を使うだろう。それらの追加機能はこの文書の残りの部分で触れられている。</p><p>ここで使っている例は、数多くの人が設定の例のために要求したものに依っている。すべての識別子は問題がないようにしてあり、非現実的な存在しないサイトへ何らかの形で似ていることは計画的に行われている。</p></div><div class="sect1" title="例題サイトの説明"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2560672"></a>例題サイトの説明</h2></div></div></div><p>最初の設定例中では、例外的な、簡単なシステム要求の場合を考えてみる。ほとんど取り組みを必要としないものを複雑にしようとする真の誘惑がある。</p><p><a class="link" href="FastStart.html#anon-ro" title="匿名リードオンリ文書サーバ">“匿名リードオンリ文書サーバ”</a> はCD-ROMイメージを提供するのに十分かもしれないサーバのタイプか、ネットワーククライアントが使う用途向けの参考文書を提供する。この設定は<a class="link" href="StandAloneServer.html" title="Chapter 7. スタンドアロンサーバ">“スタンドアロンサーバ”</a>、<a class="link" href="StandAloneServer.html#RefDocServer" title="参照用文書サーバ">“参照用文書サーバ”</a>でも取り上げている。この設定の目的は、ゲストも含めて誰でもリードオンリでアクセスできる共有ボリュームを提供することである。</p><p>2番目の例は、コンピュータ上にインストールされた正しいプリンタドライバを持つのと同じくらい長く、誰でも印刷できるプリントサーバのための最低限の設定である。これは<a class="link" href="StandAloneServer.html" title="Chapter 7. スタンドアロンサーバ">“スタンドアロンサーバ”</a>, <a class="link" href="StandAloneServer.html#SimplePrintServer" title="集中印刷サーバ">“集中印刷サーバ”</a>で説明されているものと同じである。</p><p>次の例は、システム上にアカウントを持つユーザのみがアクセス可能な、安全なオフィス用ファイル/プリントサーバである。このサーバはワークグループのファイル/プリントサーバととてもよく似ているが、匿名でアクセスするマシンよりはより安全である。このタイプのシステムは、一般的に小さなオフィスの用途に適合している。サー派はネットワークログオン機能、ドメイン制御を提供しない。その代わりにネットワーク経由のストレージデバイス(NAS)とプリントサーバである。</p><p>最後の例は存在するMicrosoft Windowsネットワークを統合するか、それを完全に置き換えるより複雑なシステムである。これらはSambaドメイン制御(PDC/BDC)と同様なドメインメンバサーバとリモートの場所中にあるブランチオフィスでの、大きな分散ネットワーク中で詳細が説明されるものをカバーする。</p></div><div class="sect1" title="動く例"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2560778"></a>動く例</h2></div></div></div><p>設定の例はSambaが動くために必要なすべてをカバーするためにデザインされている。それはこのテキストの範囲を明らかに超えている、基本的なOSプラットフォームの設定をカバーしていない。</p><p>また、OSベンダによって提供されているパッケージにか、他の手段でSambaが正しくインストールされていることも仮定している。</p><div class="sect2" title="スタンドアロンサーバ"><div class="titlepage"><div><div><h3 class="title"><a name="id2560805"></a>スタンドアロンサーバ</h3></div></div></div><p>	<a class="indexterm" name="id2560813"></a>	スタンドアロンサーバであるということは、それがドメインコントローラでないこと、	ドメイン制御下に参加していないと言う事実以上のことを何も暗示しない。これは	単純で、ワークグループ風のサーバであるか、ドメインセキュリティ管理下のメンバ	であることができる。	</p><p>	  例題が作成されている間、真のビジネスオフィスが、そのオフィスの大きさが	  増えたり必要に応じて変わるようなことが起こると思うかもしれないのと同じ          ように、システムガソのすばらしい能力に向かって進歩するすべての試みが行	  われた。	</p><div class="sect3" title="匿名リードオンリ文書サーバ"><div class="titlepage"><div><div><h4 class="title"><a name="anon-ro"></a>匿名リードオンリ文書サーバ</h4></div></div></div><p>		<a class="indexterm" name="id2560856"></a>		このタイプのサーバの目的は、共有リソース上にある任意の文書やファイルを		任意のユーザに有効にさせることである。共有リソースはCD-ROMでもファイル		領域でも可能である。		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>			ファイルシステムの共有位置は<code class="filename">/export</code>である。			</p></li><li class="listitem"><p>			すべてのファイルはJack Baumbachと呼ばれるユーザが所有している。			Jackのログイン名は<span class="emphasis"><em>jackb</em></span>である。そのパス			ワードは<span class="emphasis"><em>m0r3pa1n</em></span>である。 			もちろんこれは例として使っているものである。すべての、この			文書の読者がこのことを知っているため、実環境でこれを使っては			いけない。			</p></li></ul></div><div class="procedure" title="Procedure 2.1. インストール手順: リードオンリサーバ"><a name="id2560914"></a><p class="title"><b>Procedure 2.1. インストール手順: リードオンリサーバ</b></p><div class="example"><a name="anon-example"></a><p class="title"><b>Example 2.1. 匿名リードオンリサーバ設定</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td># グローバルパラメータ</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2561047"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2561057"></a><em class="parameter"><code>netbios name = HOBBIT</code></em></td></tr><tr><td><a class="indexterm" name="id2561067"></a><em class="parameter"><code>security = share</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[data]</code></em></td></tr><tr><td><a class="indexterm" name="id2561086"></a><em class="parameter"><code>comment = Data</code></em></td></tr><tr><td><a class="indexterm" name="id2561097"></a><em class="parameter"><code>path = /export</code></em></td></tr><tr><td><a class="indexterm" name="id2561107"></a><em class="parameter"><code>read only = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2561117"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr></table></div></div><br class="example-break"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>			ユーザをシステムに登録する(ユーザのホームディレクトリも作る):</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>useradd -c "Jack Baumbach" -m -g users -p m0r3pa1n jackb</code></strong></pre><p>			</p></li><li class="step" title="Step 2"><p>			ディレクトリを作りパーミッションと所有者を設定する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>mkdir /export</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chmod u+rwx,g+rx,o+rx /export</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chown jackb.users /export</code></strong></pre><p>			</p></li><li class="step" title="Step 3"><p>			<code class="filename">/export</code>ディレクトリに共有したいファイルをコピーする。			</p></li><li class="step" title="Step 4"><p>						<a class="link" href="FastStart.html#anon-example" title="Example 2.1. 匿名リードオンリサーバ設定">匿名リードオンリサーバ設定</a>で			表示されているSamba設定ファイル(<code class="filename">/etc/samba/smb.conf</code>)を			インストールする。			</p></li><li class="step" title="Step 5"><p>			以下のコマンドを実行して設定ファイルをテストする:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>testparm</code></strong></pre><p>                        代替として、<code class="filename">smb.conf.master</code>と呼ばれるマスタ                        設定ファイルから操作している場合、以下のコマンドシーケンスの方が                        より適切である:</p><pre class="screen"><code class="prompt">root# </code> cd /etc/samba<code class="prompt">root# </code> testparm -s smb.conf.master > smb.conf<code class="prompt">root# </code> testparm</pre><p>                        何らかのエラーメッセージが出力されるかもしれないことに注意。                        エラー出力がない場合にのみ先に進むこと。上記の設定ファイルで                        生成される典型的な出力の例は以下の通り:</p><pre class="screen">Load smb config files from /etc/samba/smb.confProcessing section "[data]"Loaded services file OK.Server role: ROLE_STANDALONEPress enter to see a dump of your service definitions<strong class="userinput"><code>[Press enter]</code></strong># Global parameters[global]	workgroup = MIDEARTH	netbios name = HOBBIT	security = share[data]	comment = Data	path = /export	read only = Yes	guest only = Yes</pre><p>			</p></li><li class="step" title="Step 6"><p>                        OSプラットフォームに適した方法でSambaを起動する。その方法は			プラットフォーム依存である。Sambaを起動することに関するそれ			以上の情報は、<a class="link" href="compiling.html#startingSamba" title="smbd nmbdとwinbinddの起動">Starting Samba</a>			を参照のこと。			</p></li><li class="step" title="Step 7"><p>			Microsoft Windowsクライアントをワークグループ			<span class="emphasis"><em>MIDEARTH</em></span>に設定し、コンピュータ名を			ROBBINSに設定し再起動し、数分待ち、Windowsエクスプローラ			を開いてマイネットワークをクリックする。そこにマシンHOBBIT			がある。このマシンアイコンをクリックすると、			<span class="emphasis"><em>data</em></span>共有が現れる。共有をクリック後、			<code class="filename">/export</code>ディレクトリ中にある、以前に			そこにおいたファイルが現れる。			</p></li></ol></div><p>		上記の情報(#グローバルパラメータ以下)は		<code class="filename">/etc/samba/smb.conf</code>ファイルの完全な内容を提供		する。		</p></div><div class="sect3" title="匿名の読み書き可能な文書サーバ"><div class="titlepage"><div><div><h4 class="title"><a name="id2561274"></a>匿名の読み書き可能な文書サーバ</h4></div></div></div><p>		<a class="indexterm" name="id2561282"></a>                以前の例からこの設定を発展系と見なすべきである。違いは、共有アクセスが		jackbというユーザIDに、プライマリグループがjackbに強制的に設定されると		いうことである。その他1つの改善点は、ユーザjackbを		<code class="filename">smbpasswd</code>に追加することが出来るということである。		これを行うのには以下を実行する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>smbpasswd -a jackb</code></strong>New SMB password: <strong class="userinput"><code>m0r3pa1n</code></strong>Retype new SMB password: <strong class="userinput"><code>m0r3pa1n</code></strong>Added user jackb.</pre><p>		<code class="filename">smbpasswd</code>ファイルへのこのユーザの追加は、エクス		プローラのプロパティにおいて所有者が<span class="emphasis"><em>User Unknown</em></span>		の代わりに<span class="emphasis"><em>jackb</em></span>が表示されると言うことである。		</p><p>		完全な変更後の<code class="filename">smb.conf</code>ファイルは<a class="link" href="FastStart.html#anon-rw" title="Example 2.2. 変更後の匿名の読み書き可能な設定の smb.conf">“変更後の匿名の読み書き可能な設定の smb.conf”</a>である。		</p><div class="example"><a name="anon-rw"></a><p class="title"><b>Example 2.2. 変更後の匿名の読み書き可能な設定の smb.conf</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td># Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2561388"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2561398"></a><em class="parameter"><code>netbios name = HOBBIT</code></em></td></tr><tr><td><a class="indexterm" name="id2561409"></a><em class="parameter"><code>security = SHARE</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[data]</code></em></td></tr><tr><td><a class="indexterm" name="id2561428"></a><em class="parameter"><code>comment = Data</code></em></td></tr><tr><td><a class="indexterm" name="id2561438"></a><em class="parameter"><code>path = /export</code></em></td></tr><tr><td><a class="indexterm" name="id2561448"></a><em class="parameter"><code>force user = jackb</code></em></td></tr><tr><td><a class="indexterm" name="id2561459"></a><em class="parameter"><code>force group = users</code></em></td></tr><tr><td><a class="indexterm" name="id2561469"></a><em class="parameter"><code>read only = No</code></em></td></tr><tr><td><a class="indexterm" name="id2561480"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr></table></div></div><br class="example-break"></div><div class="sect3" title="匿名プリントサーバ"><div class="titlepage"><div><div><h4 class="title"><a name="id2561492"></a>匿名プリントサーバ</h4></div></div></div><p>		<a class="indexterm" name="id2561500"></a>		匿名プリントサーバは2つの目的で提供される:		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>			1つの所から、すべてのプリンタに印刷を許可する。			</p></li><li class="listitem"><p>			制限された数のプリンタに対するアクセスのため、たくさんの			ユーザのためにネットワークのトラフィック輻輳を減らす。			</p></li></ul></div><p>		最も単純な匿名印刷サーバ中で、Windowsワークステーション上での正しい		プリンタドライバのインストール要求は共通である。この場合、プリント		サーバはスプーラに対して印刷ジョブを単に渡すだけに設定され、		スプーラはプリンタに対して素通しになるように設定される。別の言い方		をすると、プリントスプーラはプリンタに対して渡されたデータストリーム		をフィルタリングもなんらかの処理もしない。		</p><p>		この設定中で、プリンタの追加ウィザードを使うのは好ましくなく、		また、自動ドライバダウンロードを行うのも望まない。そのため、		以下の設定でそれを無効にする。		<a class="link" href="FastStart.html#anon-print" title="Example 2.3. 匿名プリントサーバのsmb.conf">“匿名プリントサーバのsmb.conf”</a>は結果の <code class="filename">smb.conf</code>ファイルである。		</p><div class="example"><a name="anon-print"></a><p class="title"><b>Example 2.3. 匿名プリントサーバのsmb.conf</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td># Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2561591"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2561602"></a><em class="parameter"><code>netbios name = LUTHIEN</code></em></td></tr><tr><td><a class="indexterm" name="id2561612"></a><em class="parameter"><code>security = share</code></em></td></tr><tr><td><a class="indexterm" name="id2561622"></a><em class="parameter"><code>printcap name = cups</code></em></td></tr><tr><td><a class="indexterm" name="id2561633"></a><em class="parameter"><code>disable spoolss = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2561643"></a><em class="parameter"><code>show add printer wizard = No</code></em></td></tr><tr><td><a class="indexterm" name="id2561654"></a><em class="parameter"><code>printing = cups</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[printers]</code></em></td></tr><tr><td><a class="indexterm" name="id2561672"></a><em class="parameter"><code>comment = All Printers</code></em></td></tr><tr><td><a class="indexterm" name="id2561683"></a><em class="parameter"><code>path = /var/spool/samba</code></em></td></tr><tr><td><a class="indexterm" name="id2561693"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2561704"></a><em class="parameter"><code>printable = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2561714"></a><em class="parameter"><code>use client driver = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2561724"></a><em class="parameter"><code>browseable = No</code></em></td></tr></table></div></div><br class="example-break"><p>		上記の設定は理想的なものではない。よりよい機能を使っておらず、		故意にエレガントではない解決方法を提示している。しかし、これは		基本であり、これで印刷は出来る。SambaはCUPSによって提供される		直接印刷APIを使える。CUPSライブラリを、Sambaコンパイル時に指定		してリンクした場合、既定値の印刷システムはCUPSになる。princap name		がCUPSを指定した場合、Sambaはすべての印刷機能のためにCUPSに直接		通信を行うため、CUPSライブラリAPIを使う。		<em class="parameter"><code>printing</code></em>の値をSYSVかBSDに設定して外部印刷		コマンドを強制的に使うことが可能で、パラメータ		<em class="parameter"><code>printcap name</code></em>の値はCUPS以外の何かに設定		しなければならない。この場合、Windowsクライアントに対して有効に		させるためのプリンタの一覧が含まれている任意のファイルの名前を設定		する。		</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>		Windowsユーザはローカルプリンタのインストールが必要で、ドライバの		インストール後に通常使うプリンタを切り替える。通常使うプリンタは		そのマシン上のネットワークプリンタに設定できる。		</p></div><p>		ディレクトリ<code class="filename">/var/spool/samba</code>が使えるように		なっていることを確かめておくこと。以下の手順はこれを達成するため		に行わなければならない:		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>			ディレクトリはスーパーユーザ(root)のユーザとグループに属さねば                        ならない:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>chown root.root /var/spool/samba</code></strong></pre><p>			</p></li><li class="listitem"><p>			ディレクトリのパーミッションは以下のようにスティッキービット			を設定して「その他」をRWに設定しなければならない:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>chmod a+twrx /var/spool/samba</code></strong></pre><p>                スティッキービット設定の目的は、一時印刷ファイルを所有していない                ユーザが誤用で制御を得てしまう可能性を防止するためである。			</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>		<a class="indexterm" name="id2561865"></a>		<a class="indexterm" name="id2561873"></a>		CUPSが有効になっているシステムで、中間のCUPSプリントフィルタ処理なしで、		直接プリンタに生データを渡す機能がある。このモードの操作を使うことが		要求される場合、生データを印刷するデバイスを設定することが必要である。		また、<code class="filename">/etc/mime.conv</code>と		<code class="filename">/etc/mime.types</code>ファイル中のraw mime ハンドラを		有効にする必要もある。<a class="link" href="CUPS-printing.html#cups-raw" title="application/octet-streamのための“raw”印刷を明示的に有効にする">“application/octet-streamのためのraw印刷を明示的に有効にする”</a>を参照のこと。		</p></div></div><div class="sect3" title="セキュアな読み書き可能ファイルと印刷サーバ"><div class="titlepage"><div><div><h4 class="title"><a name="id2561908"></a>セキュアな読み書き可能ファイルと印刷サーバ</h4></div></div></div><p>		続いて、簡単なシステムからやや複雑なサーバの例に説明を進めよう。		</p><p>		新しいサーバは認証されたユーザのみ(すなわち、ローカルアカウントを持つ)が、		ホームディレクトリと同様にファイルを保存できる共用データ領域を必要とする。		また、誰でも使える1つのプリンタも提供する。		</p><p>		この仮想の環境(このデータを入手するための盗聴は無いものとする)中で、		使うのに難しくない、<span class="emphasis"><em>十分な安全性</em></span>を持つ簡単な環境に		サイトは依存する。		</p><p>		サイトユーザは Jack Baumbach, Mary Orvilleと Amed Sehkahである。おのおのは		パスワード(これ以降の例では表示しない)を持つ。Maryはプリンタ管理者で、		共通の共有中のファイルの所有者である。		</p><p>		この設定は既定値である<span class="emphasis"><em>ユーザレベルのセキュリティ</em></span>を		ベースとしていて、<code class="filename">/etc/samba/smbpasswd</code>中に		Windows互換の暗号化パスワードを格納している。この設定にするための既定値		の<code class="filename">smb.conf</code>エントリは		<a class="link" href="smb.conf.5.html#PASSDBBACKEND" target="_top">passdb backend = smbpasswd, guest</a>である。		これが既定値になっているので、設定ファイルにこれを記述する必要はない。		guest バックエンドはSamba設定ファイル中で指定されるか否かに関わらす、		有効なpassdb backendに追加されることに注意。		</p><div class="procedure" title="Procedure 2.2. セキュアなオフィスサーバのインストール"><a name="id2561996"></a><p class="title"><b>Procedure 2.2. セキュアなオフィスサーバのインストール</b></p><div class="example"><a name="OfficeServer"></a><p class="title"><b>Example 2.4. セキュアなオフィスサーバのsmb.conf</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td># Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2562093"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2562104"></a><em class="parameter"><code>netbios name = OLORIN</code></em></td></tr><tr><td><a class="indexterm" name="id2562114"></a><em class="parameter"><code>printcap name = cups</code></em></td></tr><tr><td><a class="indexterm" name="id2562125"></a><em class="parameter"><code>disable spoolss = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2562135"></a><em class="parameter"><code>show add printer wizard = No</code></em></td></tr><tr><td><a class="indexterm" name="id2562146"></a><em class="parameter"><code>printing = cups</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[homes]</code></em></td></tr><tr><td><a class="indexterm" name="id2562165"></a><em class="parameter"><code>comment = Home Directories</code></em></td></tr><tr><td><a class="indexterm" name="id2562175"></a><em class="parameter"><code>valid users = %S</code></em></td></tr><tr><td><a class="indexterm" name="id2562186"></a><em class="parameter"><code>read only = No</code></em></td></tr><tr><td><a class="indexterm" name="id2562196"></a><em class="parameter"><code>browseable = No</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[public]</code></em></td></tr><tr><td><a class="indexterm" name="id2562215"></a><em class="parameter"><code>comment = Data</code></em></td></tr><tr><td><a class="indexterm" name="id2562225"></a><em class="parameter"><code>path = /export</code></em></td></tr><tr><td><a class="indexterm" name="id2562236"></a><em class="parameter"><code>force user = maryo</code></em></td></tr><tr><td><a class="indexterm" name="id2562246"></a><em class="parameter"><code>force group = users</code></em></td></tr><tr><td><a class="indexterm" name="id2562256"></a><em class="parameter"><code>read only = No</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[printers]</code></em></td></tr><tr><td><a class="indexterm" name="id2562275"></a><em class="parameter"><code>comment = All Printers</code></em></td></tr><tr><td><a class="indexterm" name="id2562286"></a><em class="parameter"><code>path = /var/spool/samba</code></em></td></tr><tr><td><a class="indexterm" name="id2562296"></a><em class="parameter"><code>printer admin = root, maryo</code></em></td></tr><tr><td><a class="indexterm" name="id2562306"></a><em class="parameter"><code>create mask = 0600</code></em></td></tr><tr><td><a class="indexterm" name="id2562317"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2562327"></a><em class="parameter"><code>printable = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2562338"></a><em class="parameter"><code>use client driver = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2562348"></a><em class="parameter"><code>browseable = No</code></em></td></tr></table></div></div><br class="example-break"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>		<a class="indexterm" name="id2562007"></a>			すべてのユーザをOSに追加する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>useradd -c "Jack Baumbach" -m -g users -p m0r3pa1n jackb</code></strong><code class="prompt">root# </code><strong class="userinput"><code>useradd -c "Mary Orville" -m -g users -p secret maryo</code></strong><code class="prompt">root# </code><strong class="userinput"><code>useradd -c "Amed Sehkah" -m -g users -p secret ameds</code></strong></pre><p>			</p></li><li class="step" title="Step 2"><p>			<a class="link" href="FastStart.html#OfficeServer" title="Example 2.4. セキュアなオフィスサーバのsmb.conf">“セキュアなオフィスサーバのsmb.conf”</a>中で示されているようにSambaの <code class="filename">smb.conf</code>を設定する。			</p></li><li class="step" title="Step 3"><p>			Microsoft Windowsパスワードデータベースに新規ユーザを追加する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>smbpasswd -a root</code></strong>New SMB password: <strong class="userinput"><code>bigsecret</code></strong>Reenter smb password: <strong class="userinput"><code>bigsecret</code></strong>Added user root.<code class="prompt">root# </code><strong class="userinput"><code>smbpasswd -a jackb</code></strong>New SMB password: <strong class="userinput"><code>m0r3pa1n</code></strong>Retype new SMB password: <strong class="userinput"><code>m0r3pa1n</code></strong>Added user jackb.<code class="prompt">root# </code><strong class="userinput"><code>smbpasswd -a maryo</code></strong>New SMB password: <strong class="userinput"><code>secret</code></strong>Reenter smb password: <strong class="userinput"><code>secret</code></strong>Added user maryo.<code class="prompt">root# </code><strong class="userinput"><code>smbpasswd -a ameds</code></strong>New SMB password: <strong class="userinput"><code>mysecret</code></strong>Reenter smb password: <strong class="userinput"><code>mysecret</code></strong>Added user ameds.</pre><p>			</p></li><li class="step" title="Step 4"><p>			CUPS Webインタフェースを使ってプリンタをインストールする。生データを			印刷するデバイスとしてMicrosoft Windowsクライアントで共有するプリンタ			をインストールするようにすること。			</p></li><li class="step" title="Step 5"><p>			OSの管理インタフェースを使ってSambaを起動する。それは以下の方法でも			手動で可能である:			<a class="indexterm" name="id2562478"></a>			<a class="indexterm" name="id2562484"></a>			<a class="indexterm" name="id2562490"></a>			<a class="indexterm" name="id2562499"></a></p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code> nmbd; smbd;</code></strong></pre><p>                        両方のアプリケーションは自動的にdaemonとして動く。daemonモードで開始                        することを強制する、パラノイド的な<code class="constant">-D</code>フラグを追加                        することも可能である。			</p></li><li class="step" title="Step 6"><p>			<code class="filename">/export</code>ディレクトリを設定する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>mkdir /export</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chown maryo.users /export</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chmod u=rwx,g=rwx,o-rwx /export</code></strong></pre><p>			</p></li><li class="step" title="Step 7"><p>			Sambaが正しく動いているかを調べる:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>smbclient -L localhost -U%</code></strong>Domain=[MIDEARTH] OS=[UNIX] Server=[Samba-3.0.20]Sharename      Type      Comment---------      ----      -------public         Disk      DataIPC$           IPC       IPC Service (Samba-3.0.20)ADMIN$         IPC       IPC Service (Samba-3.0.20)hplj4          Printer   hplj4Server               Comment---------            -------OLORIN               Samba-3.0.20Workgroup            Master---------            -------MIDEARTH             OLORIN</pre><p>                        以下のエラーメッセージはSambaが動作していないことを示している:</p><pre class="screen"><code class="prompt">root# </code> smbclient -L olorin -U%Error connecting to 192.168.1.40 (Connection refused)Connection to olorin failed</pre><p>			</p></li><li class="step" title="Step 8"><p>			ユーザmaryoでOLORINに接続する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>smbclient //olorin/maryo -Umaryo%secret</code></strong>OS=[UNIX] Server=[Samba-3.0.20]smb: \> <strong class="userinput"><code>dir</code></strong>.                              D        0  Sat Jun 21 10:58:16 2003..                             D        0  Sat Jun 21 10:54:32 2003Documents                      D        0  Fri Apr 25 13:23:58 2003DOCWORK                        D        0  Sat Jun 14 15:40:34 2003OpenOffice.org                 D        0  Fri Apr 25 13:55:16 2003.bashrc                        H     1286  Fri Apr 25 13:23:58 2003.netscape6                    DH        0  Fri Apr 25 13:55:13 2003.mozilla                      DH        0  Wed Mar  5 11:50:50 2003.kermrc                        H      164  Fri Apr 25 13:23:58 2003.acrobat                      DH        0  Fri Apr 25 15:41:02 2003		55817 blocks of size 524288. 34725 blocks availablesmb: \> <strong class="userinput"><code>q</code></strong></pre><p>			</p></li></ol></div><p>			ここまでのことで、設定の基礎を会得したかと思う。これからはより複雑な			例を見ていく。この節の残りの部分は、いままでの例で説明した手順の部分			は省略する。			</p></div></div><div class="sect2" title="ドメインメンバサーバ"><div class="titlepage"><div><div><h3 class="title"><a name="id2562709"></a>ドメインメンバサーバ</h3></div></div></div><p>	<a class="indexterm" name="id2562717"></a>	ここでは、経理部門が幸せにできるような、最も簡単なサーバ設定を題材にする。ユーザは	会計担当で、小難しい要求をしてくることに注意しよう。この部門のために1台のサーバ予算	がある。	</p><p>	ネットワークは社内情報サービスグループ(Information Services Group (ISG))で管理され、そこ	に所属しているものとする。内部の製作は典型的な中規模の組織である。いつでもユーザの追加削	除を行っているという理由でISGを運営しているのがHuman Resources is of the opinion。        また、スタッフのために基本的なネットワークリソースアクセスを得るために、部門の管理者は	死力を尽くして戦わなければならない。けれども経理部門は違い、彼らは性格に彼らがほしい	ものを手に入れる。そのため、これは場面を設定すべきである。	</p><p>        ここでは最後の例からのユーザを使うことにする。経理部門にはその部門のユーザが使える	汎用プリンタがある。また、小切手を印刷するための権限を持つ人のそばにその人だけが	使える小切手印刷プリンタもある。最高会計責任者(CFO)はオフィス内の個人用収納場所	中に配置して完全にそのプリンタの使用を制限したいと望んでいる。そのため、それは	ネットワークプリンタである必要がある。	</p><p>	経理部門は中央のアプリケーションサーバから動かさなければならない	<span class="emphasis"><em>SpytFull</em></span>という会計アプリケーションを使っている。ソフトウェア	は1台のサーバだけで動かすようにライセンスされていて、底にはワークステーション	コンポーネントがなく、マップされた共有で動く。データはUNIXベースのSQLバックエンド	にある。UNIXの専門家はそれをみて、それはUNIX屋の問題ではないと言う。	</p><p>	経理部門のマネージャ(maryo)はフォームレター(いやなメール)のために分離したファイル	格納領域と同じような汎用ファイリングシステムを希望している。フォームレター領域は	マネージャを除いてすべての経理スタッフにはリードオンリにすべきである。汎用ファイ	リングシステムは、経理のチームのメンバの、その人固有の階層構造ファイル領域を持つ	必要があるが、マネージャにはすべての領域にアクセスできることを希望している。各	ユーザは、個人に関連したファイルのための固有のホーム領域を持つが、それは部門の	作業に関連しない。	</p><div class="sect3" title="設定例"><div class="titlepage"><div><div><h4 class="title"><a name="id2562829"></a>設定例</h4></div></div></div><p>		サーバ<span class="emphasis"><em>valinor</em></span>は会社のドメインのメンバサーバである。		経理部門はローカルサーバのみを持つ。ユーザのアカウントはドメインコント		ローラ上にあり、そこにはデスクトッププロファイルとすべてのネットワーク		ポリシファイルがある。		</p><div class="procedure"><div class="example"><a name="fast-member-server"></a><p class="title"><b>Example 2.5. メンバサーバのsmb.conf (Globals)</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td># Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2562913"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2562923"></a><em class="parameter"><code>netbios name = VALINOR</code></em></td></tr><tr><td><a class="indexterm" name="id2562934"></a><em class="parameter"><code>security = DOMAIN</code></em></td></tr><tr><td><a class="indexterm" name="id2562944"></a><em class="parameter"><code>printcap name = cups</code></em></td></tr><tr><td><a class="indexterm" name="id2562954"></a><em class="parameter"><code>disable spoolss = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2562965"></a><em class="parameter"><code>show add printer wizard = No</code></em></td></tr><tr><td><a class="indexterm" name="id2562976"></a><em class="parameter"><code>idmap uid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2562986"></a><em class="parameter"><code>idmap gid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2562997"></a><em class="parameter"><code>winbind use default domain = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2563008"></a><em class="parameter"><code>printing = cups</code></em></td></tr></table></div></div><br class="example-break"><div class="example"><a name="fast-memberserver-shares"></a><p class="title"><b>Example 2.6. メンバサーバのsmb.conf (Shares and Services)</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td> </td></tr><tr><td><em class="parameter"><code>[homes]</code></em></td></tr><tr><td><a class="indexterm" name="id2563041"></a><em class="parameter"><code>comment = Home Directories</code></em></td></tr><tr><td><a class="indexterm" name="id2563052"></a><em class="parameter"><code>valid users = %S</code></em></td></tr><tr><td><a class="indexterm" name="id2563062"></a><em class="parameter"><code>read only = No</code></em></td></tr><tr><td><a class="indexterm" name="id2563072"></a><em class="parameter"><code>browseable = No</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[spytfull]</code></em></td></tr><tr><td><a class="indexterm" name="id2563091"></a><em class="parameter"><code>comment = Accounting Application Only</code></em></td></tr><tr><td><a class="indexterm" name="id2563102"></a><em class="parameter"><code>path = /export/spytfull</code></em></td></tr><tr><td><a class="indexterm" name="id2563113"></a><em class="parameter"><code>valid users = @Accounts</code></em></td></tr><tr><td><a class="indexterm" name="id2563123"></a><em class="parameter"><code>admin users = maryo</code></em></td></tr><tr><td><a class="indexterm" name="id2563134"></a><em class="parameter"><code>read only = Yes</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[public]</code></em></td></tr><tr><td><a class="indexterm" name="id2563152"></a><em class="parameter"><code>comment = Data</code></em></td></tr><tr><td><a class="indexterm" name="id2563163"></a><em class="parameter"><code>path = /export/public</code></em></td></tr><tr><td><a class="indexterm" name="id2563173"></a><em class="parameter"><code>read only = No</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[printers]</code></em></td></tr><tr><td><a class="indexterm" name="id2563192"></a><em class="parameter"><code>comment = All Printers</code></em></td></tr><tr><td><a class="indexterm" name="id2563202"></a><em class="parameter"><code>path = /var/spool/samba</code></em></td></tr><tr><td><a class="indexterm" name="id2563213"></a><em class="parameter"><code>printer admin = root, maryo</code></em></td></tr><tr><td><a class="indexterm" name="id2563223"></a><em class="parameter"><code>create mask = 0600</code></em></td></tr><tr><td><a class="indexterm" name="id2563234"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2563244"></a><em class="parameter"><code>printable = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2563254"></a><em class="parameter"><code>use client driver = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2563265"></a><em class="parameter"><code>browseable = No</code></em></td></tr></table></div></div><br class="example-break"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>			UNIX/Linuxサーバにユーザを追加してはならない。すべては中央の			ドメインで行う。			</p></li><li class="step" title="Step 2"><p>			<a class="link" href="FastStart.html#fast-member-server" title="Example 2.5. メンバサーバのsmb.conf (Globals)">メンバサーバのsmb.conf			(globals)</a>と			<a class="link" href="FastStart.html#fast-memberserver-shares" title="Example 2.6. メンバサーバのsmb.conf (Shares and Services)">メンバサーバのsmb.conf (shares			and services)</a>と一致するように<code class="filename">smb.conf</code>を設定する。			</p></li><li class="step" title="Step 3"><p>			<a class="indexterm" name="id2563281"></a>			ドメインに参加する。注意:このステップが終わるまでSambaを起動してはいけない!</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>net rpc join -Uroot%'bigsecret'</code></strong>Joined domain MIDEARTH.</pre><p>			</p></li><li class="step" title="Step 4"><p>			<code class="literal">winbind</code>が設定されて動いている任意のシステム上で			<code class="literal">nscd</code> daemonを停止する(シャットダウンする)ことを必ず行うこと。			</p></li><li class="step" title="Step 5"><p>			OSプラットフォームの通常の方法で、Sambaを起動する。			手動で動かしたい場合は、rootになって以下の手順で起動する:			<a class="indexterm" name="id2563342"></a>			<a class="indexterm" name="id2563348"></a>			<a class="indexterm" name="id2563354"></a>			<a class="indexterm" name="id2563361"></a>			<a class="indexterm" name="id2563369"></a>			<a class="indexterm" name="id2563377"></a></p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>nmbd; smbd; winbindd;</code></strong></pre><p>			</p></li><li class="step" title="Step 6"><p>			winbind経由でユーザとグループ名を解決するために、システム上にあるネーム			サービススイッチ(NSS)制御ファイルを設定する。			<code class="filename">/etc/nsswitch.conf</code>中の以下の行を編集する。</p><pre class="programlisting">passwd: files winbindgroup:  files winbindhosts:  files dns winbind</pre><p>			</p></li><li class="step" title="Step 7"><p>			<code class="literal">wbinfo</code>に対するパスワードを以下の方法で設定する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>wbinfo --set-auth-user=root%'bigsecret'</code></strong></pre><p>			</p></li><li class="step" title="Step 8"><p>		        ドメインユーザとグループの認証が以下を実行することで正しく解決されるかを			検証すること:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>wbinfo -u</code></strong>MIDEARTH\maryoMIDEARTH\jackbMIDEARTH\ameds...MIDEARTH\root<code class="prompt">root# </code><strong class="userinput"><code>wbinfo -g</code></strong>MIDEARTH\Domain UsersMIDEARTH\Domain AdminsMIDEARTH\Domain Guests...MIDEARTH\Accounts</pre><p>			</p></li><li class="step" title="Step 9"><p>			<code class="literal">winbind</code>が動作しているかをチェックすること。以下は、			<code class="literal">getent</code>システムユーティリティ経由で正しいユーザ名の			解決を行っている例である:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>getent passwd maryo</code></strong>maryo:x:15000:15003:Mary Orville:/home/MIDEARTH/maryo:/bin/false</pre><p>			</p></li><li class="step" title="Step 10"><p>			A final test that we have this under control might be reassuring:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>touch /export/a_file</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chown maryo /export/a_file</code></strong><code class="prompt">root# </code><strong class="userinput"><code>ls -al /export/a_file</code></strong>...-rw-r--r--    1 maryo    users       11234 Jun 21 15:32 a_file...<code class="prompt">root# </code><strong class="userinput"><code>rm /export/a_file</code></strong></pre><p>			</p></li><li class="step" title="Step 11"><p>			ここまでで設定はほぼ終わり、この後、このサイト用にディレクトリ			構造を設定する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>mkdir -p /export/{spytfull,public}</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chmod ug=rwxS,o=x /export/{spytfull,public}</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chown maryo.Accounts /export/{spytfull,public}</code></strong></pre><p>			</p></li></ol></div></div></div><div class="sect2" title="ドメインコントローラ"><div class="titlepage"><div><div><h3 class="title"><a name="id2563629"></a>ドメインコントローラ</h3></div></div></div><p>	<a class="indexterm" name="id2563637"></a>	この節の残りの部分は、ドメイン制御の設定に焦点を当てる。以下は2つの実装方法の例である。	ここでの例は、簡単に作れるが、ちゃんと動くものを提示するのが目的であることを思い出して	ほしい。この本の残りではより大きな機能性とそれに付随する複雑性に注目する機会を手助け	するべきである。	</p><p>	ドメインコントローラの設定は新しいtdbsamパスワードバックエンドを使う簡単な設定	で達成できる。このタイプの設定は小さなオフィスに適しているが、拡張性が制限され	ていて(複製が出来ない)、ドメインの大きさと複雑さが増大するとパフォーマンスが	下がることが予想される。	</p><p>	tdbsamの使用は、PDC以外の必要性がないサイトにのみ最適である。ドメインが大きく	なると、追加のドメインコントローラが必要となるのは必定である。Microsoftネット	ワーク環境に過小なリソースを提供しようと試みてはいけない;ドメインコントローラは	基本的な認証サービスを提供する。以下は過小なリソースでのドメインコントロール	環境の症状である:	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>		 ドメインログオンが断続的に失敗する。		</p></li><li class="listitem"><p>		ドメインメンバサーバ上のファイルアクセスが断続的に失敗し、		パーミッション拒否エラーメッセージが出る。		</p></li></ul></div><p>	より拡張性のあるドメインコントロール認証バックエンドオプションは、	Microsoft Active DirectoryかLDAPベースのバックエンドを使うことである。	Samba-3はドメインメンバサーバとして両方のオプションを提供する。PDC	として、Samba-3はActive Directoryで有効な機能の完全な代替を提供でき	ない。Samba-3は拡張性のあるLDAPベースの PDC/BDCソリューションを提供	できる。	</p><p>	tdbsam認証バックエンドは、外部手段を除いて、データベースの内容を複製	する機能は提供していない(すなわち、独立したSamba-3のためのSAM複製	手順はない)。	</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>	もしも1つ以上のドメインコントローラが必要ならば、tdbsam認証バックエンドは	使えない。	</p></div><div class="sect3" title="例: エンジニアリングオフィス"><div class="titlepage"><div><div><h4 class="title"><a name="id2563736"></a>例: エンジニアリングオフィス</h4></div></div></div><p>		ここで提供するエンジニアリングオフィスのネットワークサーバは、新しい		tdbsamパスワードバックエンドの使い方をデモするように設計されている。		tdbsam機能はSamba-3で取り入れられた。Microsoft Windows NT4で可能な		たくさんのユーザとマシンアカウント制御を提供するように設計された。		小さなネットワーク中で使うのには、これは安全である。		</p><div class="procedure"><div class="example"><a name="fast-engoffice-global"></a><p class="title"><b>Example 2.7. エンジニアリングオフィスのsmb.conf (globals)</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2563809"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2563819"></a><em class="parameter"><code>netbios name = FRODO</code></em></td></tr><tr><td><a class="indexterm" name="id2563830"></a><em class="parameter"><code>passdb backend = tdbsam</code></em></td></tr><tr><td><a class="indexterm" name="id2563840"></a><em class="parameter"><code>printcap name = cups</code></em></td></tr><tr><td><a class="indexterm" name="id2563850"></a><em class="parameter"><code>add user script = /usr/sbin/useradd -m %u</code></em></td></tr><tr><td><a class="indexterm" name="id2563862"></a><em class="parameter"><code>delete user script = /usr/sbin/userdel -r %u</code></em></td></tr><tr><td><a class="indexterm" name="id2563873"></a><em class="parameter"><code>add group script = /usr/sbin/groupadd %g</code></em></td></tr><tr><td><a class="indexterm" name="id2563884"></a><em class="parameter"><code>delete group script = /usr/sbin/groupdel %g</code></em></td></tr><tr><td><a class="indexterm" name="id2563895"></a><em class="parameter"><code>add user to group script = /usr/sbin/groupmod -A %u %g</code></em></td></tr><tr><td><a class="indexterm" name="id2563907"></a><em class="parameter"><code>delete user from group script = /usr/sbin/groupmod -R %u %g</code></em></td></tr><tr><td><a class="indexterm" name="id2563919"></a><em class="parameter"><code>add machine script = /usr/sbin/useradd -s /bin/false -d /var/lib/nobody %u</code></em></td></tr><tr><td># 注意: 以下は既定値のログオンスクリプトを指定する。</td></tr><tr><td># ユーザ単位のログオンスクリプトは、pdbeditを使って、ユーザアカウント中で指定できる。</td></tr><tr><td><a class="indexterm" name="id2563944"></a><em class="parameter"><code>logon script = scripts\logon.bat</code></em></td></tr><tr><td># This sets the default profile path. Set per user paths with pdbedit</td></tr><tr><td><a class="indexterm" name="id2563960"></a><em class="parameter"><code>logon path = \\%L\Profiles\%U</code></em></td></tr><tr><td><a class="indexterm" name="id2563971"></a><em class="parameter"><code>logon drive = H:</code></em></td></tr><tr><td><a class="indexterm" name="id2563981"></a><em class="parameter"><code>logon home = \\%L\%U</code></em></td></tr><tr><td><a class="indexterm" name="id2563991"></a><em class="parameter"><code>domain logons = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2564002"></a><em class="parameter"><code>os level = 35</code></em></td></tr><tr><td><a class="indexterm" name="id2564012"></a><em class="parameter"><code>preferred master = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2564023"></a><em class="parameter"><code>domain master = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2564033"></a><em class="parameter"><code>idmap uid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2564043"></a><em class="parameter"><code>idmap gid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2564054"></a><em class="parameter"><code>printing = cups</code></em></td></tr></table></div></div><br class="example-break"><div class="example"><a name="fast-engoffice-shares"></a><p class="title"><b>Example 2.8. エンジニアリングオフィスのOffice smb.conf (shares and services)</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td> </td></tr><tr><td><em class="parameter"><code>[homes]</code></em></td></tr><tr><td><a class="indexterm" name="id2564088"></a><em class="parameter"><code>comment = Home Directories</code></em></td></tr><tr><td><a class="indexterm" name="id2564098"></a><em class="parameter"><code>valid users = %S</code></em></td></tr><tr><td><a class="indexterm" name="id2564108"></a><em class="parameter"><code>read only = No</code></em></td></tr><tr><td><a class="indexterm" name="id2564119"></a><em class="parameter"><code>browseable = No</code></em></td></tr><tr><td># Printing auto-share (makes printers available thru CUPS)</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[printers]</code></em></td></tr><tr><td><a class="indexterm" name="id2564142"></a><em class="parameter"><code>comment = All Printers</code></em></td></tr><tr><td><a class="indexterm" name="id2564152"></a><em class="parameter"><code>path = /var/spool/samba</code></em></td></tr><tr><td><a class="indexterm" name="id2564163"></a><em class="parameter"><code>printer admin = root, maryo</code></em></td></tr><tr><td><a class="indexterm" name="id2564173"></a><em class="parameter"><code>create mask = 0600</code></em></td></tr><tr><td><a class="indexterm" name="id2564184"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2564194"></a><em class="parameter"><code>printable = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2564204"></a><em class="parameter"><code>browseable = No</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[print$]</code></em></td></tr><tr><td><a class="indexterm" name="id2564223"></a><em class="parameter"><code>comment = Printer Drivers Share</code></em></td></tr><tr><td><a class="indexterm" name="id2564234"></a><em class="parameter"><code>path = /var/lib/samba/drivers</code></em></td></tr><tr><td><a class="indexterm" name="id2564245"></a><em class="parameter"><code>write list = maryo, root</code></em></td></tr><tr><td><a class="indexterm" name="id2564256"></a><em class="parameter"><code>printer admin = maryo, root</code></em></td></tr><tr><td># Needed to support domain logons</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[netlogon]</code></em></td></tr><tr><td><a class="indexterm" name="id2564278"></a><em class="parameter"><code>comment = Network Logon Service</code></em></td></tr><tr><td><a class="indexterm" name="id2564289"></a><em class="parameter"><code>path = /var/lib/samba/netlogon</code></em></td></tr><tr><td><a class="indexterm" name="id2564300"></a><em class="parameter"><code>admin users = root, maryo</code></em></td></tr><tr><td><a class="indexterm" name="id2564311"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2564321"></a><em class="parameter"><code>browseable = No</code></em></td></tr><tr><td># For profiles to work, create a user directory under the path</td></tr><tr><td>#  shown. i.e., mkdir -p /var/lib/samba/profiles/maryo</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[Profiles]</code></em></td></tr><tr><td><a class="indexterm" name="id2564349"></a><em class="parameter"><code>comment = Roaming Profile Share</code></em></td></tr><tr><td><a class="indexterm" name="id2564360"></a><em class="parameter"><code>path = /var/lib/samba/profiles</code></em></td></tr><tr><td><a class="indexterm" name="id2564371"></a><em class="parameter"><code>read only = No</code></em></td></tr><tr><td><a class="indexterm" name="id2564381"></a><em class="parameter"><code>profile acls = Yes</code></em></td></tr><tr><td># Other resource (share/printer) definitions would follow below.</td></tr></table></div></div><br class="example-break"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>			tdbsamパスワードバックエンドを使う動作するPDCの設定は、			<a class="link" href="FastStart.html#fast-engoffice-global" title="Example 2.7. エンジニアリングオフィスのsmb.conf (globals)">エンジニアリングオフィスのsmb.conf			(globals)</a>と			<a class="link" href="FastStart.html#fast-engoffice-shares" title="Example 2.8. エンジニアリングオフィスのOffice smb.conf (shares and services)">エンジニアリングオフィスのsmb.conf			(shares and services)</a>にある:			<a class="indexterm" name="id2563779"></a>			</p></li><li class="step" title="Step 2"><p>			OSで提供されているツールを使って、必要に応じUNIXグループを作成する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>groupadd ntadmins</code></strong><code class="prompt">root# </code><strong class="userinput"><code>groupadd designers</code></strong><code class="prompt">root# </code><strong class="userinput"><code>groupadd engineers</code></strong><code class="prompt">root# </code><strong class="userinput"><code>groupadd qateam</code></strong></pre><p>			</p></li><li class="step" title="Step 3"><p>			OSで提供されている適当なツールを使ってシステム上にユーザアカウントを			作成する。同時にユーザ毎のホームディレクトリを作っておくこと。Samba			環境で使うときに要求されるグループのファイル、ディレクトリ、プリンタ			のアクセス制御に対し、ユーザを追加する。			</p></li><li class="step" title="Step 4"><p>			<a class="indexterm" name="id2564471"></a>			<a class="indexterm" name="id2564480"></a>			このシェルスクリプトを動かしてNTグループにおのおののUNIXグループを割り当			てる(スクリプトの名前は<code class="filename">initGroups.sh</code>とする)。</p><pre class="screen">#!/bin/bash#### Keep this as a shell script for future re-use			# First assign well known groupsnet groupmap add ntgroup="Domain Admins" unixgroup=ntadmins rid=512 type=dnet groupmap add ntgroup="Domain Users"  unixgroup=users rid=513 type=net groupmap add ntgroup="Domain Guests" unixgroup=nobody rid=514 type=d# Now for our added Domain Groupsnet groupmap add ntgroup="Designers" unixgroup=designers type=dnet groupmap add ntgroup="Engineers" unixgroup=engineers type=dnet groupmap add ntgroup="QA Team"   unixgroup=qateam    type=d</pre><p>			</p></li><li class="step" title="Step 5"><p>			<em class="parameter"><code>[NETLOGON]</code></em> 共有中で使うための			<code class="filename">scripts</code>ディレクトリを作成する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>mkdir -p /var/lib/samba/netlogon/scripts</code></strong></pre><p>                        使用するログオンスクリプト(バッチまたはcmdスクリプト)をこの                        ディレクトリに配置する。			</p></li></ol></div><p>		上記の設定で、ファイル共有とプリンタ共有を必要に応じて追加しなければ		ならない、基本的なPDCシステムが提供される。		</p></div><div class="sect3" title="大きな組織の場合"><div class="titlepage"><div><div><h4 class="title"><a name="id2564563"></a>大きな組織の場合</h4></div></div></div><p>		この節では、LDAPベースの認証バックエンドを使うSamba-3の設定の簡単な		紹介を行う。このことを行う主旨は、より高次のレベルのスケーラビリティ		に適合するのを可能にするための、とても分散した環境と同じように、		PDC/BDCホストを可能にすることを提供することである。		</p><div class="sect4" title="プライマリドメインコントローラ"><div class="titlepage"><div><div><h5 class="title"><a name="id2564582"></a>プライマリドメインコントローラ</h5></div></div></div><p>			これは、LDAP認証バックエンドを使うSamba-3 PDCを動かすための			最小限の設定例である。OSが正しく設定されていることを仮定して			いる。			</p><p>			Idealx スクリプト(か同等のもの)が、LDAPベースのPOSIXとSambaSamAccount			を管理するのに必要である。Idealxスクリプトはサイト			<a class="ulink" href="http://www.idealx.org" target="_top">Idealx</a>からダウンロードする			ことが出来る。また、Sambaのリリースtarファイルから得ることも出来る。			Linuxディストリビューションは、Idealxスクリプトを			<code class="filename">/usr/share/doc/packages/sambaXXXXXX/examples/LDAP/smbldap-tools</code>			ディレクトリにインストールする傾向がある。			Idealxスクリプトバージョン<code class="constant">smbldap-tools-0.9.1</code>は			よく動作することが知られている。			</p><div class="procedure"><div class="example"><a name="fast-ldap"></a><p class="title"><b>Example 2.9. PDC用のLDAPバックエンドを使うsmb.conf</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td># Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2564832"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2564843"></a><em class="parameter"><code>netbios name = FRODO</code></em></td></tr><tr><td><a class="indexterm" name="id2564853"></a><em class="parameter"><code>passdb backend = ldapsam:ldap://localhost</code></em></td></tr><tr><td><a class="indexterm" name="id2564864"></a><em class="parameter"><code>username map = /etc/samba/smbusers</code></em></td></tr><tr><td><a class="indexterm" name="id2564875"></a><em class="parameter"><code>printcap name = cups</code></em></td></tr><tr><td><a class="indexterm" name="id2564886"></a><em class="parameter"><code>add user script = /usr/local/sbin/smbldap-useradd -m '%u'</code></em></td></tr><tr><td><a class="indexterm" name="id2564897"></a><em class="parameter"><code>delete user script = /usr/local/sbin/smbldap-userdel %u</code></em></td></tr><tr><td><a class="indexterm" name="id2564909"></a><em class="parameter"><code>add group script = /usr/local/sbin/smbldap-groupadd -p '%g'</code></em></td></tr><tr><td><a class="indexterm" name="id2564920"></a><em class="parameter"><code>delete group script = /usr/local/sbin/smbldap-groupdel '%g'</code></em></td></tr><tr><td><a class="indexterm" name="id2564932"></a><em class="parameter"><code>add user to group script = /usr/local/sbin/smbldap-groupmod -m '%u' '%g'</code></em></td></tr><tr><td><a class="indexterm" name="id2564943"></a><em class="parameter"><code>delete user from group script = /usr/local/sbin/smbldap-groupmod -x '%u' '%g'</code></em></td></tr><tr><td><a class="indexterm" name="id2564956"></a><em class="parameter"><code>set primary group script = /usr/local/sbin/smbldap-usermod -g '%g' '%u'</code></em></td></tr><tr><td><a class="indexterm" name="id2564968"></a><em class="parameter"><code>add machine script = /usr/local/sbin/smbldap-useradd -w '%u'</code></em></td></tr><tr><td><a class="indexterm" name="id2564979"></a><em class="parameter"><code>logon script = scripts\logon.bat</code></em></td></tr><tr><td><a class="indexterm" name="id2564990"></a><em class="parameter"><code>logon path = \\%L\Profiles\%U</code></em></td></tr><tr><td><a class="indexterm" name="id2565001"></a><em class="parameter"><code>logon drive = H:</code></em></td></tr><tr><td><a class="indexterm" name="id2565012"></a><em class="parameter"><code>logon home = \\%L\%U</code></em></td></tr><tr><td><a class="indexterm" name="id2565022"></a><em class="parameter"><code>domain logons = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2565032"></a><em class="parameter"><code>os level = 35</code></em></td></tr><tr><td><a class="indexterm" name="id2565043"></a><em class="parameter"><code>preferred master = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2565053"></a><em class="parameter"><code>domain master = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2565064"></a><em class="parameter"><code>ldap suffix = dc=quenya,dc=org</code></em></td></tr><tr><td><a class="indexterm" name="id2565075"></a><em class="parameter"><code>ldap machine suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565086"></a><em class="parameter"><code>ldap user suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565097"></a><em class="parameter"><code>ldap group suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565108"></a><em class="parameter"><code>ldap idmap suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565119"></a><em class="parameter"><code>ldap admin dn = cn=Manager</code></em></td></tr><tr><td><a class="indexterm" name="id2565129"></a><em class="parameter"><code>ldap ssl = no</code></em></td></tr><tr><td><a class="indexterm" name="id2565140"></a><em class="parameter"><code>ldap passwd sync = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2565150"></a><em class="parameter"><code>idmap uid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2565161"></a><em class="parameter"><code>idmap gid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2565171"></a><em class="parameter"><code>printing = cups</code></em></td></tr></table></div></div><br class="example-break"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>				Sambaのソース<code class="filename">~/examples/LDAP/samba.schema</code>				から入手し、<code class="filename">/etc/openldap/schema/</code>				ディレクトリにそれをコピーする。				</p></li><li class="step" title="Step 2"><p>				LDAPサーバを設定する。この例はOpenLDAP 2.1.xに対応している。				The <code class="filename">/etc/openldap/slapd.conf</code> file.				<a class="indexterm" name="id2564667"></a><span style="color: red"><title>Example slapd.conf File</title></span></p><pre class="screen"># Note commented out lines have been removedinclude         /etc/openldap/schema/core.schemainclude         /etc/openldap/schema/cosine.schemainclude         /etc/openldap/schema/inetorgperson.schemainclude         /etc/openldap/schema/nis.schemainclude         /etc/openldap/schema/samba.schemapidfile         /var/run/slapd/slapd.pidargsfile        /var/run/slapd/slapd.argsdatabase        bdbsuffix          "dc=quenya,dc=org"rootdn          "cn=Manager,dc=quenya,dc=org"rootpw          {SSHA}06qDkonA8hk6W6SSnRzWj0/pBcU3m0/P# The password for the above is 'nastyon3'directory     /var/lib/ldapindex   objectClass     eqindex cn                      pres,sub,eqindex sn                      pres,sub,eqindex uid                     pres,sub,eqindex displayName             pres,sub,eqindex uidNumber               eqindex gidNumber               eqindex memberUid               eqindex   sambaSID              eqindex   sambaPrimaryGroupSID  eqindex   sambaDomainName       eqindex   default               sub</pre><p>				</p></li><li class="step" title="Step 3"><p>				<code class="filename">initdb.ldif</code>ファイルを作成する:				<a class="indexterm" name="id2564712"></a></p><pre class="programlisting"># Organization for SambaXP Demodn: dc=quenya,dc=orgobjectclass: dcObjectobjectclass: organizationdc: quenyao: SambaXP Demodescription: The SambaXP Demo LDAP Tree# Organizational Role for Directory Managementdn: cn=Manager,dc=quenya,dc=orgobjectclass: organizationalRolecn: Managerdescription: Directory Manager# Setting up the container for usersdn: ou=People, dc=quenya, dc=orgobjectclass: topobjectclass: organizationalUnitou: People# Set up an admin handle for People OUdn: cn=admin, ou=People, dc=quenya, dc=orgcn: adminobjectclass: topobjectclass: organizationalRoleobjectclass: simpleSecurityObjectuserPassword: {SSHA}0jBHgQ1vp4EDX2rEMMfIudvRMJoGwjVb# The password for above is 'mordonL8'</pre><p>				</p></li><li class="step" title="Step 4"><p>				LDAPデータベース中に初期データを投入する:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>slapadd -v -l initdb.ldif</code></strong></pre><p>				</p></li><li class="step" title="Step 5"><p>				OSにインストールされている方法か適当なツールを使ってLDAP				サーバを起動する。				</p></li><li class="step" title="Step 6"><p>				<code class="filename">/usr/local/sbin</code>ディレクトリ中にIdealx				スクリプトファイルをインストールし、システム設定に合わせて、				smbldap_conf.pmを設定する。				</p></li><li class="step" title="Step 7"><p>				このバックエンドを制御する<code class="filename">smb.conf</code>ファイルの例は				<a class="link" href="FastStart.html#fast-ldap" title="Example 2.9. PDC用のLDAPバックエンドを使うsmb.conf">PDC用のLDAPバックエンドを使うsmb.conf</a>				にある。必要に応じて追加する。				</p></li><li class="step" title="Step 8"><p>				<code class="filename">secrets.tdb</code>ファイルにLDAPパスワードを				追加すると、SambaはLDAPデータベースを更新できるようになる:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>smbpasswd -w mordonL8</code></strong></pre><p>				</p></li><li class="step" title="Step 9"><p>				必要に応じてユーザとグループを追加する。Sambaツールを使った				ユーザとグループの追加は必要に応じて、自動的にLDAPバックエ				ンドとOSに追加される。				</p></li></ol></div></div><div class="sect4" title="バックアップドメインコントローラ"><div class="titlepage"><div><div><h5 class="title"><a name="id2565227"></a>バックアップドメインコントローラ</h5></div></div></div><p>			<a class="link" href="FastStart.html#fast-bdc" title="Example 2.10. リモートのLDAPを使うBDCのsmb.conf">“リモートのLDAPを使うBDCのsmb.conf”</a> ではBDCの設定例を示している。<code class="filename">smb.conf</code>			ファイルがBDC上で必要でないsmbldap-toolsスクリプトを			指定していないことに注意。必要に応じて追加の共有とプリンタを			追加する。			</p><div class="procedure"><div class="example"><a name="fast-bdc"></a><p class="title"><b>Example 2.10. リモートのLDAPを使うBDCのsmb.conf</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td># Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2565309"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2565320"></a><em class="parameter"><code>netbios name = GANDALF</code></em></td></tr><tr><td><a class="indexterm" name="id2565330"></a><em class="parameter"><code>passdb backend = ldapsam:ldap://frodo.quenya.org</code></em></td></tr><tr><td><a class="indexterm" name="id2565341"></a><em class="parameter"><code>username map = /etc/samba/smbusers</code></em></td></tr><tr><td><a class="indexterm" name="id2565352"></a><em class="parameter"><code>printcap name = cups</code></em></td></tr><tr><td><a class="indexterm" name="id2565362"></a><em class="parameter"><code>logon script = scripts\logon.bat</code></em></td></tr><tr><td><a class="indexterm" name="id2565373"></a><em class="parameter"><code>logon path = \\%L\Profiles\%U</code></em></td></tr><tr><td><a class="indexterm" name="id2565384"></a><em class="parameter"><code>logon drive = H:</code></em></td></tr><tr><td><a class="indexterm" name="id2565395"></a><em class="parameter"><code>logon home = \\%L\%U</code></em></td></tr><tr><td><a class="indexterm" name="id2565405"></a><em class="parameter"><code>domain logons = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2565415"></a><em class="parameter"><code>os level = 33</code></em></td></tr><tr><td><a class="indexterm" name="id2565426"></a><em class="parameter"><code>preferred master = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2565436"></a><em class="parameter"><code>domain master = No</code></em></td></tr><tr><td><a class="indexterm" name="id2565447"></a><em class="parameter"><code>ldap suffix = dc=quenya,dc=org</code></em></td></tr><tr><td><a class="indexterm" name="id2565458"></a><em class="parameter"><code>ldap machine suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565469"></a><em class="parameter"><code>ldap user suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565480"></a><em class="parameter"><code>ldap group suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565491"></a><em class="parameter"><code>ldap idmap suffix = ou=People</code></em></td></tr><tr><td><a class="indexterm" name="id2565502"></a><em class="parameter"><code>ldap admin dn = cn=Manager</code></em></td></tr><tr><td><a class="indexterm" name="id2565512"></a><em class="parameter"><code>ldap ssl = no</code></em></td></tr><tr><td><a class="indexterm" name="id2565523"></a><em class="parameter"><code>ldap passwd sync = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2565533"></a><em class="parameter"><code>idmap uid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2565544"></a><em class="parameter"><code>idmap gid = 15000-20000</code></em></td></tr><tr><td><a class="indexterm" name="id2565554"></a><em class="parameter"><code>printing = cups</code></em></td></tr></table></div></div><br class="example-break"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>				BDCが固有のLDAPサーバを持つかどうかを決める。もしもBDCが				LDAPサーバであるならば、以下の<code class="filename">smb.conf</code>を示されたように				変更する。既定値の				<a class="link" href="FastStart.html#fast-bdc" title="Example 2.10. リモートのLDAPを使うBDCのsmb.conf">リモートのLDAPを使うBDCのsmb.conf</a>				中の設定は、中央のLDAPサーバを使う。				</p></li><li class="step" title="Step 2"><p>				<a class="link" href="FastStart.html#fast-bdc" title="Example 2.10. リモートのLDAPを使うBDCのsmb.conf">“リモートのLDAPを使うBDCのsmb.conf”</a>中にあるようにNETLOGONとPROFILES				ディレクトリを設定する。				</p></li></ol></div></div></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="install.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="introduction.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="type.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 1. SAMBAのインストールとテスト方法 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Part II. サーバ設定の基本</td></tr></table></div></body></html>