<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 7. スタンドアロンサーバ</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="公式のSamba 3.2.x HOWTOとリファレンスガイド"><link rel="up" href="type.html" title="Part II. サーバ設定の基本"><link rel="prev" href="domain-member.html" title="Chapter 6. ドメインメンバシップ"><link rel="next" href="ClientConfig.html" title="Chapter 8. Microsoft Windows ネットワーク設定ガイド"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 7. スタンドアロンサーバ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="domain-member.html">Prev</a> </td><th width="60%" align="center">Part II. サーバ設定の基本</th><td width="20%" align="right"> <a accesskey="n" href="ClientConfig.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 7. スタンドアロンサーバ"><div class="titlepage"><div><div><h2 class="title"><a name="StandAloneServer"></a>Chapter 7. スタンドアロンサーバ</h2></div><div><div class="author"><h3 class="author"><span class="firstname">John</span> <span class="othername">H.</span> <span class="surname">Terpstra</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jht@samba.org">jht@samba.org</a>></code></p></div></div></div></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="StandAloneServer.html#id2583538">機能と利便性</a></span></dt><dt><span class="sect1"><a href="StandAloneServer.html#id2583648">背景</a></span></dt><dt><span class="sect1"><a href="StandAloneServer.html#id2583880">設定例</a></span></dt><dd><dl><dt><span class="sect2"><a href="StandAloneServer.html#RefDocServer">参照用文書サーバ</a></span></dt><dt><span class="sect2"><a href="StandAloneServer.html#SimplePrintServer">集中印刷サーバ</a></span></dt></dl></dd><dt><span class="sect1"><a href="StandAloneServer.html#id2584946">よくあるエラー</a></span></dt></dl></div><p><a class="indexterm" name="id2583506"></a><a class="indexterm" name="id2583513"></a><a class="indexterm" name="id2583520"></a>スタンドアロンサーバは、ネットワーク上での独立したドメインコントローラである。それらはドメインメンバではなく、ワークグループサーバのように機能する。多くの場合、スタンドアロンサーバは、提供されたデータが容易にすべての利用者からアクセス可能という意図で、最低限のセキュリティ制御で設定されているサーバである。</p><div class="sect1" title="機能と利便性"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2583538"></a>機能と利便性</h2></div></div></div><p><a class="indexterm" name="id2583546"></a><a class="indexterm" name="id2583553"></a>スタンドアロンサーバは、必要性によって、セキュアにも非セキュアにもできる。単純あるいは複雑な設定を取ることが出来る。上記のように、ドメインセキュリティについて、過大な説明にもかかわらず、多くは普通のインストールのままである。</p><p><a class="indexterm" name="id2583574"></a><a class="indexterm" name="id2583581"></a><a class="indexterm" name="id2583588"></a><a class="indexterm" name="id2583595"></a>もしも、サーバに必要とされるものがすべて読み込み専用ファイルか、プリンタのみならば、複雑な設定をするのは意味をなさない。たとえば、設計事務所が古い設計図と設計標準を格納しておく必要があるとする。すべての文書が変更されないままでいることが法律的に重要なので、誰もサーバにファイルを書き込めない。シェアモードのリードオンリスタンドアロンサーバは理想的な解決方法である。</p><p><a class="indexterm" name="id2583615"></a><a class="indexterm" name="id2583622"></a><a class="indexterm" name="id2583629"></a>単純さを正当化するもう1つの状態は、一つの中央サーバから待ち行列に入れられる多くのプリンタを持っているオフィスである。全員がプリンタに印刷出来る要求があるが、アクセス制御の必要がなく、プリンタサーバにはファイルがない場合である。繰り返すと、シェアモードスタンドアロンサーバはとても優れた解決方法を提供する。</p></div><div class="sect1" title="背景"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2583648"></a>背景</h2></div></div></div><p><a class="indexterm" name="id2583656"></a><a class="indexterm" name="id2583663"></a><a class="indexterm" name="id2583670"></a><span class="emphasis"><em>standalone server</em></span>という言葉は、ローカルな認証とその上で有効なすべてのリソースのアクセスを制御する機能を提供するという意味である。一般的に、これは、ローカルユーザデータベースがあると言うことを意味する。もう少し技術的な言葉で言うと、これは、マシン上のリソースは、<span class="emphasis"><em>share</em></span>モードか<span class="emphasis"><em>user</em></span>モードのいずれかが有効であるということである。</p><p><a class="indexterm" name="id2583705"></a><a class="indexterm" name="id2583712"></a><a class="indexterm" name="id2583720"></a>ユーザアカウントを作成するため以外に特別な操作は必要ない。スタンドアロンサーバはネットワークログオンサービスを提供しない。これは、このサーバを使うマシンはこれに対するドメインログオンを実行しないことを意味する。ワークステーションが使うどんなログオン機能も、このマシンからは独立している。しかし、使用するログオン名がローカルで持っているユーザ名をスタンドアロンサーバ上でローカルに変換(マップ)するために、任意のネットワークユーザを一致させることは必要である。このことを実行するためにはいくつかの方法がある。</p><p><a class="indexterm" name="id2583755"></a><a class="indexterm" name="id2583762"></a><a class="indexterm" name="id2583768"></a>Sambaはスタンドアロンサーバの定義中で少しだけ区別を曖昧にするのに役立つ。これは、SMBプロトコルの視点から、Sambaサーバがドメインセキュリティコンテキストのメンバでないとしても、認証データベースがローカルかリモートサーバ上にあるという理由である。</p><p><a class="indexterm" name="id2583789"></a><a class="indexterm" name="id2583796"></a><a class="indexterm" name="id2583802"></a><a class="indexterm" name="id2583810"></a><a class="indexterm" name="id2583817"></a><a class="indexterm" name="id2583824"></a><a class="indexterm" name="id2583831"></a><a class="indexterm" name="id2583838"></a>UNIXユーザデータベースを操作するPAMとネームサービススイッチ(NSS)を使って(<a class="link" href="pam.html" title="Chapter 28. PAM ベースの分散型認証">PAMに付いての節</a>を参照)、認証のソースは別のサーバ上にあってもよい。これを認証サーバと呼ぶ傾向がある。これは、SambaサーバはローカルのUNIX/Linuxシステムパスワードデータベース(<code class="filename">/etc/passwd</code>か<code class="filename">/etc/shadow</code>)か、ローカルのsmbpasswdファイルか、LDAPバックエンドか、認証のために、PAMとWinbind経由で他のCIFS/SMBサーバを使っても良いことを意味する。</p></div><div class="sect1" title="設定例"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2583880"></a>設定例</h2></div></div></div><p><a class="indexterm" name="id2583888"></a><a class="indexterm" name="id2583895"></a><a class="link" href="StandAloneServer.html#simplynice" title="Example 7.1. 参照用文書サーバ用のsmb.conf">参照用文書サーバの例</a>と<a class="link" href="StandAloneServer.html#SimplePrintServer" title="集中印刷サーバ">センタ印刷サーバ</a>は単純さにヒントを得てデザインされた。それは高度な創造性を試みることと、サーバとネットワーク設計においてとても複雑であることを説明することはとても簡単である。</p><div class="sect2" title="参照用文書サーバ"><div class="titlepage"><div><div><h3 class="title"><a name="RefDocServer"></a>参照用文書サーバ</h3></div></div></div><p><a class="indexterm" name="id2583934"></a><a class="indexterm" name="id2583940"></a><a class="indexterm" name="id2583947"></a><a class="indexterm" name="id2583954"></a>誰でもアクセスできる読み込み専用データサーバの設定はとても単純である。既定値では、すべての共有は、<code class="filename">smb.conf</code>ファイルに何か書かれるまではリードオンリである。<a class="link" href="StandAloneServer.html#simplynice" title="Example 7.1. 参照用文書サーバ用のsmb.conf">参照用文書サーバの例</a>はこれを行うための<code class="filename">smb.conf</code>ファイルである。すべての参照用文書はディレクトリ<code class="filename">/export</code>に格納されていて、文書はnobody以外のユーザによって所有されていることを仮定する。ホームディレクトリは共有されず、UNIXシステムデータベース<code class="filename">/etc/passwd</code>中にはユーザはいない。これは管理者にとって単純なシステムである。</p><div class="example"><a name="simplynice"></a><p class="title"><b>Example 7.1. 参照用文書サーバ用のsmb.conf</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td>#  Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2584033"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2584045"></a><em class="parameter"><code>netbios name = GANDALF</code></em></td></tr><tr><td><a class="indexterm" name="id2584057"></a><em class="parameter"><code>security = SHARE</code></em></td></tr><tr><td><a class="indexterm" name="id2584068"></a><em class="parameter"><code>passdb backend = guest</code></em></td></tr><tr><td><a class="indexterm" name="id2584080"></a><em class="parameter"><code>wins server = 192.168.1.1</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[data]</code></em></td></tr><tr><td><a class="indexterm" name="id2584101"></a><em class="parameter"><code>comment = Data</code></em></td></tr><tr><td><a class="indexterm" name="id2584112"></a><em class="parameter"><code>path = /export</code></em></td></tr><tr><td><a class="indexterm" name="id2584124"></a><em class="parameter"><code>guest only = Yes</code></em></td></tr></table></div></div><br class="example-break"><div class="blockquote"><table border="0" width="100%" cellspacing="0" cellpadding="0" class="blockquote" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>もう少し準備に時間があれば、もう少し簡単にできた。</p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Mark Twain</span></td></tr></table></div><p><a class="indexterm" name="id2584151"></a><a class="indexterm" name="id2584158"></a><a class="indexterm" name="id2584165"></a><a class="indexterm" name="id2584172"></a><a class="link" href="StandAloneServer.html#simplynice" title="Example 7.1. 参照用文書サーバ用のsmb.conf">この例</a>中で、マシン名はGANDALFに設定され、ワークグループはローカルワークグループ(MIDEARTH)の名前に設定され、ユーザがなじみのあるシステムと一緒に表示される。必要とされる唯一のパスワードバックエンドは、既定値の非制限アカウント名として使われることを許可する<span class="quote">“<span class="quote">guest</span>”</span>バックエンドである。このネットワーク上でWINSサーバがあるならば、もちろんそれを使う。</p><p>米国空軍連隊長が言った有名なことは:A US Air Force Colonel was renowned for saying: <span class="quote">“<span class="quote">最善は善の的(Better is the enemy of good enough!)</span>”</span>。専門的に完全な解決を避けることと同様、複雑さを避けることに対して、しばしば健全な理由が存在する。不幸にも、トラブルがないことを保持するのにちょうど十分な術を、多くのネットワーク管理者は引き続き覚える必要がある。</p></div><div class="sect2" title="集中印刷サーバ"><div class="titlepage"><div><div><h3 class="title"><a name="SimplePrintServer"></a>集中印刷サーバ</h3></div></div></div><p><a class="indexterm" name="id2584242"></a><a class="indexterm" name="id2584249"></a>単純な印刷サーバの設定は、システム上のすべての正しいツールがあるならば簡単である。</p><div class="orderedlist" title="前提条件"><p class="title"><b>前提条件</b></p><ol class="orderedlist" type="1"><li class="listitem"><p>	印刷サーバは管理不要でなければならない。	</p></li><li class="listitem"><p>	印刷サーバ印刷の、スプールと処理をするシステムはCUPSである。	(詳細情報は<a class="link" href="CUPS-printing.html" title="Chapter 22. CUPS印刷環境のサポート">CUPS印刷システム</a>を参照のこと)。	</p></li><li class="listitem"><p>	印刷サーバはネットワークプリンタのみ処理を行う。ネットワーク管理者は	プリンタをサポートするためにCUPS環境を正しく設定している。	</p></li><li class="listitem"><p>	すべてのワークステーションはPostScriptドライバを使う。選択したプリンタ	ドライバはApple Color LaserWriterのためのWindows OS用のものを選択する。	</p></li></ol></div><p><a class="indexterm" name="id2584319"></a><a class="indexterm" name="id2584325"></a><a class="indexterm" name="id2584332"></a>この例では、印刷サーバは入力したすべての印刷ジョブを、Sambaによって、CUPS印刷プロセッサに向けて送られたジョブが実行可能になるまで<code class="filename">/var/spool/samba</code>にスプールする。すべての入力された接続は匿名(guest)ユーザなので、匿名印刷を有効にするために、2つ設定が必要である。</p><div class="itemizedlist" title="匿名印刷を有効にする"><p class="title"><b>匿名印刷を有効にする</b></p><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="indexterm" name="id2584365"></a><a class="indexterm" name="id2584372"></a><a class="indexterm" name="id2584379"></a>	UNIX/Linuxシステムは<code class="literal">guest</code>アカウントを持たねば	ならない。この既定値は、通常<code class="literal">nobody</code>である。	使用するバージョンで使っている正しい名前を探すためには、以下を実行する:</p><pre class="screen"><code class="prompt">$ </code><strong class="userinput"><code>testparm -s -v | grep "guest account"</code></strong></pre><p><a class="indexterm" name="id2584418"></a>	このアカウントはシステムのパスワードデータベース	(<code class="filename">/etc/passwd</code>)に存在するようにしておかねばならない。	</p><p><a class="indexterm" name="id2584438"></a><a class="indexterm" name="id2584445"></a><a class="indexterm" name="id2584452"></a>	このアカウントに対してパスワードを設定するか、UNIXでの使用からロックすることは	良い考えである。ゲストアカウントが<code class="literal">pcguest</code>であると仮定した時、	以下を実行することでロックが出来る:</p><pre class="screen"><code class="prompt">root# </code> passwd -l pcguest</pre><p>	正確なコマンドは使用するUNIX/Linuxディストリビューションによって異なる。	</p></li><li class="listitem"><p><a class="indexterm" name="id2584492"></a><a class="indexterm" name="id2584499"></a><a class="indexterm" name="id2584506"></a><a class="indexterm" name="id2584513"></a><a class="indexterm" name="id2584520"></a><a class="indexterm" name="id2584526"></a>	Sambaがファイルをスプールするディレクトリはゲストアカウントに対して	書き込み許可を持たねばならない。以下のコマンド操作で、このディレクトリ	が使えるようにする:</p><pre class="screen"><code class="prompt">root# </code><strong class="userinput"><code>mkdir /var/spool/samba</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chown nobody.nobody /var/spool/samba</code></strong><code class="prompt">root# </code><strong class="userinput"><code>chmod a+rwt /var/spool/samba</code></strong></pre><p>	</p></li></ul></div><p><code class="filename">smb.conf</code>ファイルの内容は<a class="link" href="StandAloneServer.html#AnonPtrSvr" title="Example 7.2. 匿名印刷のためのsmb.conf">匿名印刷の例</a>にある。</p><div class="example"><a name="AnonPtrSvr"></a><p class="title"><b>Example 7.2. 匿名印刷のための<code class="filename">smb.conf</code></b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td>#  Global parameters</td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2584631"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td><a class="indexterm" name="id2584643"></a><em class="parameter"><code>netbios name = GANDALF</code></em></td></tr><tr><td><a class="indexterm" name="id2584654"></a><em class="parameter"><code>security = SHARE</code></em></td></tr><tr><td><a class="indexterm" name="id2584666"></a><em class="parameter"><code>passdb backend = guest</code></em></td></tr><tr><td><a class="indexterm" name="id2584678"></a><em class="parameter"><code>printing = cups</code></em></td></tr><tr><td><a class="indexterm" name="id2584690"></a><em class="parameter"><code>printcap name = cups</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[printers]</code></em></td></tr><tr><td><a class="indexterm" name="id2584710"></a><em class="parameter"><code>comment = All Printers</code></em></td></tr><tr><td><a class="indexterm" name="id2584722"></a><em class="parameter"><code>path = /var/spool/samba</code></em></td></tr><tr><td><a class="indexterm" name="id2584734"></a><em class="parameter"><code>printer admin = root</code></em></td></tr><tr><td><a class="indexterm" name="id2584746"></a><em class="parameter"><code>guest ok = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2584757"></a><em class="parameter"><code>printable = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2584769"></a><em class="parameter"><code>use client driver = Yes</code></em></td></tr><tr><td><a class="indexterm" name="id2584781"></a><em class="parameter"><code>browseable = No</code></em></td></tr></table></div></div><br class="example-break"><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><a class="indexterm" name="id2584797"></a><a class="indexterm" name="id2584806"></a><a class="indexterm" name="id2584812"></a><a class="indexterm" name="id2584819"></a><a class="indexterm" name="id2584826"></a>CUPSが有効なシステム上で、CUPSプリントフィルタ経由の中間処理なしで生データを直接プリンタに送る機能がある。このモードの操作が要求される場合、raw印刷デバイスの設定が必要である。また、<code class="filename">/etc/mime.conv</code>と<code class="filename">/etc/mime.types</code>ファイル中にraw mime ハンドラを有効にする設定も必要である。<a class="link" href="CUPS-printing.html" title="Chapter 22. CUPS印刷環境のサポート">CUPS印刷サポート</a>、<a class="link" href="CUPS-printing.html#cups-raw" title="application/octet-streamのための“raw”印刷を明示的に有効にする">application/octet-streamで明示的にraw印刷を有効にする</a>を参照のこと。</p></div><p><a class="indexterm" name="id2584877"></a><a class="indexterm" name="id2584884"></a><a class="indexterm" name="id2584892"></a><a class="indexterm" name="id2584899"></a><a class="link" href="StandAloneServer.html#AnonPtrSvr" title="Example 7.2. 匿名印刷のためのsmb.conf">匿名印刷の例</a>中では、CUPSライブラリAPI経由で直接印刷のためにCUPSを使用する。これは、すべてのプリンタはprintcapファイルを設定する必要なしにWindowsユーザから見えるようになるという意味である。もしも、プリンタのサブセットのみか、特別な種類のプリンタ(たとえばPDFフィルタ)を見せる必要があるならば、<em class="parameter"><code>printcap name = cups</code></em>を<em class="parameter"><code>printcap name = /etc/samba/myprintcap</code></em>に置き換えても良い。この場合、指定されたファイルはWindowsネットワークユーザに見せるべきプリンタ名の一覧を含む必要がある。</p></div></div><div class="sect1" title="よくあるエラー"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2584946"></a>よくあるエラー</h2></div></div></div><p><a class="indexterm" name="id2584954"></a><a class="indexterm" name="id2584961"></a>よく発生するとても大きな間違いは、ネットワークの設定を複雑すぎるようにしてしまうことである。その時に必要な最も簡単な解を使うこと。</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="domain-member.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="type.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ClientConfig.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 6. ドメインメンバシップ </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 8. Microsoft Windows ネットワーク設定ガイド</td></tr></table></div></body></html>