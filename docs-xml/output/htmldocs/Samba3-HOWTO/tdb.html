<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 41. TDB ファイルの管理</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="公式のSamba 3.2.x HOWTOとリファレンスガイド"><link rel="up" href="troubleshooting.html" title="Part V. トラブルシューティング"><link rel="prev" href="bugreport.html" title="Chapter 40. バグの報告"><link rel="next" href="Appendix.html" title="Part VI. Reference Section"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 41. TDB ファイルの管理</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="bugreport.html">Prev</a> </td><th width="60%" align="center">Part V. トラブルシューティング</th><td width="20%" align="right"> <a accesskey="n" href="Appendix.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 41. TDB ファイルの管理"><div class="titlepage"><div><div><h2 class="title"><a name="tdb"></a>Chapter 41. TDB ファイルの管理</h2></div><div><div class="author"><h3 class="author"><span class="firstname">John</span> <span class="othername">H.</span> <span class="surname">Terpstra</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jht@samba.org">jht@samba.org</a>></code></p></div></div></div></div><div><p class="pubdate">2008年5月28日</p></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="tdb.html#id2711718">特徴と利点</a></span></dt><dt><span class="sect1"><a href="tdb.html#id2712241">TDB ファイルの管理</a></span></dt></dl></div><div class="sect1" title="特徴と利点"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2711718"></a>特徴と利点</h2></div></div></div><p><a class="indexterm" name="id2711726"></a><a class="indexterm" name="id2711733"></a>Samba は軽量なデータベース Trivial Database (tdb) を利用する。一時的や永続的なデータをそこに格納する。一部の tdb ファイルは Samba を再起動する前に破棄できるが、その他はSamba の設定や振る舞いにとって重要な情報を格納するために利用される。Samba のインストールについてよりよい管理を摸索している管理者の助けとなるように下記の情報は提供される。</p><p><a class="indexterm" name="id2711753"></a><a class="indexterm" name="id2711760"></a><a class="indexterm" name="id2711767"></a><a class="indexterm" name="id2711774"></a>OSとともに商用ディストリビューションにSambaをパッケージする場合とアプライアンスの場合、十分に注意するとよいだろう。 tdb ファイルは破損することがあるため定期的にバックアップするべきである。適切なタイミングはシステムシャットダウン(バックアップ)とスタートアップ(バックアップからのレストア)である。</p><div class="table"><a name="TOSH-TDB"></a><p class="title"><b>Table 41.1. Samba の Trivial Database ファイル</b></p><div class="table-contents"><table summary="Samba の Trivial Database ファイル" border="1"><colgroup><col><col></colgroup><thead><tr><th>ファイル名</th><th>要保存</th><th>説明</th></tr></thead><tbody><tr><td>account_policy.tdb</td><td>要</td><td><p>たとえばパスワード有効期限などのようなNT アカウントポリシー	設定など。</p></td></tr><tr><td>brlock.tdb</td><td>不要</td><td><p>バイトレンジロック。</p></td></tr><tr><td>browse.dat</td><td>不要</td><td><p>ブラウズリスト - 自動的に再構築される。</p></td></tr><tr><td>connections.tdb</td><td>不要</td><td><p>各共有への接続。最大接続数までに制限するためなどに利用される。</p></td></tr><tr><td>gencache.tdb</td><td>不要</td><td><p>汎用のキャッシュ用データベース。</p></td></tr><tr><td>group_mapping.tdb</td><td>要</td><td><p>	    グループマッピング情報を格納する。LDAP バックエンドを利用する際には使わない。      </p></td></tr><tr><td>lang_en.tdb</td><td>要</td><td><p>使用する言語のエンコーディング情報を格納する。</p></td></tr><tr><td>locking.tdb</td><td>不要</td><td><p>共有モードと oplock 情報を格納する。</p></td></tr><tr><td>login_cache.tdb</td><td>不要</td><td><p>パスワードの失敗のログを保管する。</p></td></tr><tr><td>messages.tdb</td><td>不要</td><td><p>Samba 内部メッセージングの追跡に使用する。</p></td></tr><tr><td>netsamlogon_cache.tdb</td><td>要</td><td><p>	    ドメインメンバからのリクエスト<span class="emphasis"><em>net_samlogon()</em></span>	    からのユーザ net_info_3 構造体のキャッシュ。      </p></td></tr><tr><td>ntdrivers.tdb</td><td>要</td><td><p>インストールされたプリンタドライバ情報を格納する。</p></td></tr><tr><td>ntforms.tdb</td><td>要</td><td><p>インストールされたプリンタのフォーム情報を格納する。</p></td></tr><tr><td>ntprinters.tdb</td><td>要</td><td><p>インストールされたプリンタ情報を格納する。</p></td></tr><tr><td>printing ディレクトリ</td><td>要</td><td><p>	    キャッシュされた lpq 出力のプリントキュー毎の tdb ファイルを含むディレクトリ。      </p></td></tr><tr><td>registry.tdb</td><td>要</td><td><p>	    Windows レジストリスケルトン(regedit.exeを経由して接続)。      </p></td></tr><tr><td>sessionid.tdb</td><td>不要</td><td><p>	    <code class="literal">utmp = yes</code>機能をサポートするためのセッション情	    報。      </p></td></tr><tr><td>share_info.tdb</td><td>要</td><td><p>	    共有レベルの ACL 構成設定を格納する。ACLの既定値は	    <span class="emphasis"><em>全員 - フルコントロール</em></span>である。      </p></td></tr><tr><td>unexpected.tdb</td><td>不要</td><td><p>	    発信リクエストとは異なるポートへ返信する Windows クライアントを	    サポートするため予期せぬパケットのキュー。      </p></td></tr><tr><td>winbindd_cache.tdb</td><td>不要</td><td><p>Winbind のユーザリストのキャッシュ。</p></td></tr><tr><td>winbindd_idmap.tdb</td><td>要</td><td><p>Winbind の ローカル IDMAP データベース。</p></td></tr><tr><td>wins.dat</td><td>不要</td><td><p>	    <em class="parameter"><code>wins support = yes</code></em>がセットされている間だけ	    利用される WINS データベース。再起動するたびに再構築または更新	    される。      </p></td></tr><tr><td>wins.tdb</td><td>要</td><td><p>	    全ての WINS データのための作業用の永続的なストレージ。<code class="filename">smb.conf</code> 	    ファイルの中で <em class="parameter"><code>wins support = yes</code></em> がセット	    されている時だけ利用される。	    注意: 手動で構成されたすべての WINS エントリを保有する。手動設定は 	    net ユーティリティを使用して行うことができる。      </p></td></tr><tr><td>secrets.tdb</td><td>要</td><td><p>	    この tdb ファイルは内部設定を格納する、例えば machine/domain SID、	    LDAPと共に使われる秘密パスワード、machine 秘密トークンなど。	    これは安全な場所に格納される必須ファイルである。ベンダーはこの	    ファイルを様々なフォルダに配置する。<code class="literal">smbd -b</code>で、	    使用するシステムでの配置を確認すること。      </p></td></tr><tr><td>schannel_store.tdb</td><td>要</td><td><p>	    SMB 署名と共に利用されるセキュア channel アクセストークン情報を格	    納する。      </p></td></tr><tr><td>passdb.tdb</td><td>要</td><td><p>	    tdbsamパスワードバックエンドを利用する場合、Samba の SAM アカウン	    ト情報を格納する。      </p></td></tr></tbody></table></div></div><br class="table-break"></div><div class="sect1" title="TDB ファイルの管理"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2712241"></a>TDB ファイルの管理</h2></div></div></div><p>  <code class="literal">tdbbackup</code> ユーティリティは samba の tdb ファイルをバック  アップすることに使うツールである。  Samba の起動の前または正常稼働中に tdb ファイルの完全性を診断することにも  利用することができる。  ファイルにダメージを見つけると以前のバックアップを探す。ダメージを受けた  tdb ファイルのバックアップファイルがリストアされる。  <code class="literal">tdbbackup</code>ユーティリティは、いつでも安全に実行できる。  Samba が実行中であっても、どんな時でも tdb ファイルの完全性が確認できるよう  に設計された。</p><p>  Samba サーバ上では Samba のスタートアップスクリプトの一部分としてすべての tdb ファ  イルをバックアップすることが推奨される。  以下のコマンドシンタックスが利用できる:</p><pre class="screen">myserver# > cd /var/lib/sambamyserver@ > tdbbackup *.tdb</pre><p>  既定の拡張子は<code class="filename">.bak</code>である。  <code class="literal">tdbbackup -s 'new_extension' *.tdb</code>とスタートアップスクリ  プトで実行することで他の拡張子を指定することができる。</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="bugreport.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="troubleshooting.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="Appendix.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 40. バグの報告 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Part VI. Reference Section</td></tr></table></div></body></html>