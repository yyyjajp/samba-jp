<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 1. SAMBAのインストールとテスト方法</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="公式のSamba 3.2.x HOWTOとリファレンスガイド"><link rel="up" href="introduction.html" title="Part I. 概要"><link rel="prev" href="introduction.html" title="Part I. 概要"><link rel="next" href="FastStart.html" title="Chapter 2. 手軽な始め方: 短気な方への手引き"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 1. SAMBAのインストールとテスト方法</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="introduction.html">Prev</a> </td><th width="60%" align="center">Part I. 概要</th><td width="20%" align="right"> <a accesskey="n" href="FastStart.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 1. SAMBAのインストールとテスト方法"><div class="titlepage"><div><div><h2 class="title"><a name="install"></a>Chapter 1. SAMBAのインストールとテスト方法</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Andrew</span> <span class="surname">Tridgell</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:tridge@samba.org">tridge@samba.org</a>></code></p></div></div></div></div><div><div class="author"><h3 class="author"><span class="firstname">Jelmer</span> <span class="othername">R.</span> <span class="surname">Vernooij</span></h3><div class="affiliation"><span class="orgname">The Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jelmer@samba.org">jelmer@samba.org</a>></code></p></div></div></div></div><div><div class="author"><h3 class="author"><span class="firstname">John</span> <span class="othername">H.</span> <span class="surname">Terpstra</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jht@samba.org">jht@samba.org</a>></code></p></div></div></div></div><div><div class="author"><h3 class="author"><span class="firstname">Karl</span> <span class="surname">Auer</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:kauer@biplane.com.au">kauer@biplane.com.au</a>></code></p></div></div></div></div><div><div class="author"><h3 class="author"><span class="firstname">Dan</span> <span class="surname">Shearer</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:dan@samba.org">dan@samba.org</a>></code></p></div></div></div></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="install.html#id2558074">Sambaの入手とインストール</a></span></dt><dt><span class="sect1"><a href="install.html#id2558125">Sambaの設定 (smb.conf)</a></span></dt><dd><dl><dt><span class="sect2"><a href="install.html#id2558170">設定ファイルの文法</a></span></dt><dt><span class="sect2"><a href="install.html#tdbdocs">TDBデータベースファイルの情報</a></span></dt><dt><span class="sect2"><a href="install.html#id2559190">Sambaを起動する</a></span></dt><dt><span class="sect2"><a href="install.html#id2559421">設定の例</a></span></dt><dt><span class="sect2"><a href="install.html#id2559871">SWAT</a></span></dt></dl></dd><dt><span class="sect1"><a href="install.html#id2559944">サーバ上で有効な共有の一覧表示</a></span></dt><dt><span class="sect1"><a href="install.html#id2560015">UNIXクライアントによる接続</a></span></dt><dt><span class="sect1"><a href="install.html#id2560111">リモートのSMBクライアントからの接続</a></span></dt><dd><dl><dt><span class="sect2"><a href="install.html#id2560208">うまく動かない時には</a></span></dt><dt><span class="sect2"><a href="install.html#id2560276">まだ解決しない?</a></span></dt></dl></dd><dt><span class="sect1"><a href="install.html#id2560316">共通のエラー</a></span></dt><dd><dl><dt><span class="sect2"><a href="install.html#id2560328">大量のsmbdプロセス</a></span></dt><dt><span class="sect2"><a href="install.html#id2560428">エラーメッセージ: open_oplock_ipc</a></span></dt><dt><span class="sect2"><a href="install.html#id2560467"><span class="quote">“<span class="quote"><span class="errorname">ネットワーク名が見つからない</span></span>”</span></a></span></dt></dl></dd></dl></div><div class="sect1" title="Sambaの入手とインストール"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2558074"></a>Sambaの入手とインストール</h2></div></div></div><p>	<a class="indexterm" name="id2558083"></a>        SambaのバイナリパッケージはほとんどのLinuxかUNIXディストリビューション        に含まれている。また、        <a class="ulink" href="http://samba.org/" target="_top">the Samba home page(本家)</a>にも        いくつかのパッケージが置いてある。使用するOSに合わせたパッケージのイン        ストールの詳細については、OSのマニュアルを参照してほしい。	</p><p>	<a class="indexterm" name="id2558107"></a>        もしもソースからSambaをコンパイルすることが必要ならば、	<a class="link" href="compiling.html" title="Chapter 42. Sambaのコンパイル方法">Sambaのコンパイル方法</a>をチェックしてほしい。	</p></div><div class="sect1" title="Sambaの設定 (smb.conf)"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2558125"></a>Sambaの設定 (smb.conf)</h2></div></div></div><p>	<a class="indexterm" name="id2558133"></a>	<a class="indexterm" name="id2558139"></a>        Sambaの設定は<code class="filename">smb.conf</code>ファイルに格納され、それは、通常	<code class="filename">/etc/samba/smb.conf</code> か         <code class="filename">/usr/local/samba/lib/smb.conf</code>にある。このファイル        を自分自身で編集するか、あるいは、たとえば、Sambaに含まれているWebベー        スのインタフェースSWATのような、種々のGUIツールのどれかを使って編集する        ことができる。	</p><div class="sect2" title="設定ファイルの文法"><div class="titlepage"><div><div><h3 class="title"><a name="id2558170"></a>設定ファイルの文法</h3></div></div></div><p>	<a class="indexterm" name="id2558177"></a>	<code class="filename">smb.conf</code> ファイルは、昔のWindows 3.1で使われていたいろいろな        <code class="filename">.ini</code>ファイルと同じ文法を使う。おのおののファイル        はいくつかのセクションからなり、それらは行の先頭が大括弧        (<code class="literal">[]</code>)で囲まれた、セクション名から開始される。それぞれ        は0またはそれ以上の、等号(<code class="literal">=</code>)で分離されたキー/値ペア        を含む。ファイルは単なるテキストファイルなので、好みの編集ツールで開い        て編集できる。	</p><p>	<a class="indexterm" name="id2558224"></a>	<a class="indexterm" name="id2558230"></a>	<a class="indexterm" name="id2558238"></a>	<a class="indexterm" name="id2558244"></a>	<a class="indexterm" name="id2558251"></a>	<a class="indexterm" name="id2558259"></a>        <code class="filename">smb.conf</code>ファイル中にあるおのおののセクションは、共有か、Sambaサーバ上        のメタサービスを記述している。<code class="literal">[global]</code>セクションは特        別であり、Sambaサーバ全体にたいして適用する設定を含む。Sambaは複数の        メタサービスをサポートし、おのおのは固有の機能を提供する。例えば、        <code class="literal">[homes]</code>共有は、メタサービスであり、おのおののユーザ        のための、個別のホーム共有を提供させる。<code class="literal">[printers]</code>は        メタサービスであり、プリントキューサポートを確立し、それは、Windows        クライアントから、UNIX/Linuxプリントスプーラに対してプリントジョブが        送られることに先立ち、中間スプールディレクトリの位置を指定する。	</p><p><a class="indexterm" name="id2558312"></a><a class="indexterm" name="id2558318"></a><a class="indexterm" name="id2558324"></a><a class="indexterm" name="id2558330"></a><a class="indexterm" name="id2558337"></a><a class="indexterm" name="id2558343"></a>	<code class="literal">printers</code> メタサービスは、<code class="literal">printcap</code>        ファイル中で指定されたものか、<code class="literal">lpstat</code>コマンドか        CUPS API経由かでのすべてのプリンタを共有プリントキューとして公開する        ようにする。<code class="filename">smb.conf</code>ファイル中の<code class="literal">printers</code>節は        browseable でないように設定できる。もしもbrowseableに設定すると、        共有として見えるようになる。これは、WindowsプリントキューとしてUNIX        システムプリンタを有効にするのみ反応するこのメタサービスをTmakes no        sense。もしも、<code class="literal">comment</code>パラメータが指定されるならば、        その値がWindowsエクスプローラのブラウズリスト中にプリンタ名の一部と        して表示される。	</p><p>	<a class="indexterm" name="id2558404"></a>        共有またはメタサービスを指定する<code class="filename">smb.conf</code>ファイル中のおのおののセクション        は節(stanza)と呼ばれる(訳注:日本ではセクションという呼び名が通用している        ため、以下はすべてセクションとする)。<code class="literal">global</code>セクション        は<code class="filename">smb.conf</code>ファイル中のすべての他のセクションに影響する設定を指定する。        設定パラメータは<code class="filename">smb.conf</code>マニュアルページに説明がある。いくつかのパラメータ        は<code class="literal">global</code>セクションのみで使われ、その他いくつかは通常の        共有またはメタサービスセクションでのみ使われ、いくつかは、グローバルまたは        共有、メタサービスセクションで使える。	</p><p>	<a class="indexterm" name="id2558453"></a>	<a class="link" href="install.html#smbconfminimal" title="Example 1.1. 最小のsmb.conf">最小のsmb.conf</a> はとても小さい<code class="filename">smb.conf</code>を含む。	<a class="indexterm" name="id2558473"></a>	</p><div class="example"><a name="smbconfminimal"></a><p class="title"><b>Example 1.1. 最小のsmb.conf</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2558501"></a><em class="parameter"><code>workgroup = WKG</code></em></td></tr><tr><td><a class="indexterm" name="id2558512"></a><em class="parameter"><code>netbios name = MYNAME</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[share1]</code></em></td></tr><tr><td><a class="indexterm" name="id2558531"></a><em class="parameter"><code>path = /tmp</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[share2]</code></em></td></tr><tr><td><a class="indexterm" name="id2558549"></a><em class="parameter"><code>path = /my_shared_folder</code></em></td></tr><tr><td><a class="indexterm" name="id2558560"></a><em class="parameter"><code>comment = Some random files</code></em></td></tr></table></div></div><br class="example-break"></div><div class="sect2" title="TDBデータベースファイルの情報"><div class="titlepage"><div><div><h3 class="title"><a name="tdbdocs"></a>TDBデータベースファイルの情報</h3></div></div></div><p>        このセクションインはSamba-3で使われるデータベースの簡単な説明を含む。	</p><p><a class="indexterm" name="id2558590"></a>        Sambaが格納するtdbファイルのディレクトリの位置は、コンパイル時オプ        ションによって変わる。Samba-3は2つの場所にtdbファイルを格納する。        その位置を決める最も良い方法は、以下のコマンドを実行する:</p><pre class="screen"><code class="prompt">root# </code> smbd -b | grep PRIVATE_DIR   PRIVATE_DIR: /etc/samba/private</pre><p>        これは、秘密のtdbファイルが<code class="filename">/etc/samba/private</code>        ディレクトリに格納されることを意味している。Samba-3はまた、より        ありふれたデータを含むいくつかのtdbファイルを使う。それらのファイルの        位置は以下を実行することで見つけられる:</p><pre class="screen"><code class="prompt">root# </code> smbd -b | grep LOCKDIR   LOCKDIR: /var/lib/samba</pre><p>        それゆえ、令の中で表示されている残りの制御ファイルは	<code class="filename">/var/lib/samba</code> ディレクトリに格納される。	</p><p><a class="indexterm" name="id2558660"></a>        継続的に使われるtdbファイルは        <a class="link" href="install.html#tdbpermfiledesc" title="Table 1.1. 継続的なTDBファイルの説明">継続的なTDBファイルの説明一覧</a>        にある。すべての継続的なtdbファイルは通常バックアップすべきである。        tdbファイルバックアップのために<code class="literal">tdbbackup</code>ユー        ティリティを使うこと。すべての継続的なtdbファイルはマシンの        マイグレーション、アップデートとアップグレードの間保存すべきである。	</p><p>        一時的なtdbファイルはバックアップの必要性はなく、マイグレーション、        アップデートとアップグレードの間保存する必要もない。一時的なtdb        ファイルは        <a class="link" href="install.html#tdbtempfiledesc" title="Table 1.2. 一時的なTDBファイルの説明">一時的なTDBファイルの説明</a>        に説明がある。	</p><div class="table"><a name="tdbpermfiledesc"></a><p class="title"><b>Table 1.1. 継続的なTDBファイルの説明</b></p><div class="table-contents"><table summary="継続的なTDBファイルの説明" border="1"><colgroup><col align="left"><col align="justify"></colgroup><thead><tr><th align="left">名前</th><th align="justify">説明</th></tr></thead><tbody><tr><td align="left">account_policy</td><td align="justify"><p>Samba/NTアカウントポリシーの設定、パスワード満了の設定を含む。</p></td></tr><tr><td align="left">group_mapping</td><td align="justify"><p>Windows グループ/SID から UNIXグループへのマッピングテーブル。</p></td></tr><tr><td align="left">ntdrivers</td><td align="justify"><p>プリンタ単位の、インストール済みドライバ情報を格納。</p></td></tr><tr><td align="left">ntforms</td><td align="justify"><p>プリンタ単位の、インストール済みフォーム情報を格納。</p></td></tr><tr><td align="left">ntprinters</td><td align="justify"><p>プリンタ単位の、devmode構成設定情報を格納。</p></td></tr><tr><td align="left">passdb</td><td align="justify"><p>                                tdbsamパスワードバックエンドが使われる時のみ存                                在。このファイルはSambaSAMAccount情報を格納する。                                注意:このファイルは/etc/passwdファイルからか他                                の代替システムソースからのユーザのPOSIXアカウント                                を必要とする。			</p></td></tr><tr><td align="left">registry</td><td align="justify"><p>                                winreg RPC経由で種々のデータベーステーブルをエ                                クスポートすることをサポートするための、読み出                                し専用Windowsレジストリスケルトンデータベース。			</p></td></tr><tr><td align="left">secrets</td><td align="justify"><p>                                このファイルはWorkgroup/Domain/Machine SID、                                LDAPディレクトリ更新パスワードとSambaが正常に                                動作するために必要な重要な環境データのさらなる                                集合。このファイルには、秘匿しなければならない                                とても機密性のある情報が含まれている。このファ                                イルはPRIVATE_DIRディレクトリに格納される。			</p></td></tr><tr><td align="left">share_info</td><td align="justify"><p>共有単位のACL情報を格納。</p></td></tr><tr><td align="left">winbindd_idmap</td><td align="justify"><p>Winbinddのローカル IDMAPデータベース。</p></td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="tdbtempfiledesc"></a><p class="title"><b>Table 1.2. 一時的なTDBファイルの説明</b></p><div class="table-contents"><table summary="一時的なTDBファイルの説明" border="1"><colgroup><col align="left"><col align="justify"><col align="left"></colgroup><thead><tr><th align="left">名前</th><th align="justify">説明</th><th align="center">バックアップ</th></tr></thead><tbody><tr><td align="left">brlock</td><td align="justify"><p>バイトレンジロック情報。</p></td><td align="left">No</td></tr><tr><td align="left">connections</td><td align="justify"><p>最大接続数を拡張するために使われる一時的な接続上のキャッシュ。</p></td><td align="left">no</td></tr><tr><td align="left">eventlog/*tdb</td><td align="justify"><p>イベントログエントリのレコードほとんどの環境ではこれはシステムログのキャッシュである。</p></td><td align="left">no</td></tr><tr><td align="left">gencache</td><td align="justify"><p>WINSサーバと信頼されるドメインデータのための汎用キャッシュデータベース。</p></td><td align="left">no</td></tr><tr><td align="left">login_cache</td><td align="justify"><p>ログイン情報のための一時的なキャッシュで、特に不正なパスワード試行用。</p></td><td align="left">no</td></tr><tr><td align="left">messages</td><td align="justify"><p>smbdによって処理されるメッセージの一時的な格納用。</p></td><td align="left">no</td></tr><tr><td align="left">netsamlogon_cache</td><td align="justify"><p>net_samloginリクエストからのユーザnet_info_3 構造データのキャッシュ(ドメインメンバとして)。</p></td><td align="left">no</td></tr><tr><td align="left">perfmon/*.tdb</td><td align="justify"><p>パフォーマンスカウンタ情報。</p></td><td align="left">no</td></tr><tr><td align="left">printing/*.tdb</td><td align="justify"><p>プリントサービス単位で作成されるlpqコマンドのキャッシュされた出力。</p></td><td align="left">no</td></tr><tr><td align="left">schannel_store</td><td align="justify"><p>                                機密ファイルで、PRIVATE_DIRに格納され、接続セッ                                トアッププロセスの再ネゴシエーションの必要なし                                で再接続可能な一時的な切断が可能になるための暗                                号化した接続情報を含む。			</p></td><td align="left">no</td></tr><tr><td align="left">sessionid</td><td align="justify"><p>種々のセッション情報とutmp処理のための一時的なキャッシュ。</p></td><td align="left">no</td></tr><tr><td align="left">unexpected</td><td align="justify"><p>どのプロセスもリッスンしていない時に受け取ったパケットを格納する。</p></td><td align="left">no</td></tr><tr><td align="left">winbindd_cache</td><td align="justify"><p>NT4ドメインかADSから受け取ったアイデンテティ                        情報のキャッシュ。ユーザリストなどを含む。</p></td><td align="left">yes</td></tr></tbody></table></div></div><br class="table-break"></div><div class="sect2" title="Sambaを起動する"><div class="titlepage"><div><div><h3 class="title"><a name="id2559190"></a>Sambaを起動する</h3></div></div></div><p>	<a class="indexterm" name="id2559198"></a>        Sambaは2つまたは3つのdaemonから構成される。daemonはバックグラウンドで動        作し、サービスを提供するUNIXのアプリケーションである。サービスの例としては、        <code class="literal">httpd</code> と呼ばれるdaemonが Apache Webサーバである。        Sambaの場合は、3つのdaemonがあり、そのうち2つが最低必要である。	</p><p>        Sambaサーバは以下のdaemonから成り立っている:	</p><div class="variablelist"><dl><dt><span class="term">nmbd</span></dt><dd><p>			<a class="indexterm" name="id2559239"></a>			<a class="indexterm" name="id2559245"></a>                        このdaemonはすべての名前登録と名前解決要求を処理する。                        これはネットワークブラウジング中で必要とされる主要な                        伝達手段である。これは、すべてのUDPベースのプロトコル                        を処理する。<code class="literal">nmbd</code>daemonはSamba開始                        プロセスの一部分として最初にコマンドを起動すべきである。			</p></dd><dt><span class="term">smbd</span></dt><dd><p>			<a class="indexterm" name="id2559284"></a>			<a class="indexterm" name="id2559290"></a>                        このdaemonはファイルと印刷関係の操作のための、TCP/IP                        ベースのすべてのコネクションサービスを処理する。また、                        ローカルでの認証も管理する。これは                        <code class="literal">nmbd</code>の開始に引き続いて起動すべきで                        ある。			</p></dd><dt><span class="term">winbindd</span></dt><dd><p>			<a class="indexterm" name="id2559325"></a>			<a class="indexterm" name="id2559332"></a>                        このdaemonはWindows NT4またはADSドメインのメンバの時に                        起動すべきである。また、他のドメインとの信頼関係を結ぶ                        時にも必要である。<code class="literal">winbindd</code>daemonは                        <em class="parameter"><code>idmap uid</code></em>と                        <em class="parameter"><code>idmap gid</code></em>パラメータが<code class="filename">smb.conf</code>                        ファイル中に存在するかどうかをチェックする。もしもそれ                        らが見つかった場合、<code class="literal">winbindd</code>はUIDと                        GIDの割り当てのために指定された値を使う。もしも、パラメー                        タが指定されていなければ、<code class="literal">winbindd</code>                        は起動するが、UIDとGIDの割り当てが出来ない。			</p></dd></dl></div><p>	<a class="indexterm" name="id2559400"></a>        SambaがOSベンダによってパッケージ化されている時、開始プロセスは通常プラッ        トフォーム全体に渡って統合された固有の機能となっている。Sambaの起動の正        しい管理に関する特定の情報のためにOSプラットフォームの管理マニュアルを        参照してほしい。	</p></div><div class="sect2" title="設定の例"><div class="titlepage"><div><div><h3 class="title"><a name="id2559421"></a>設定の例</h3></div></div></div><p>	<a class="indexterm" name="id2559428"></a>	<a class="indexterm" name="id2559435"></a>	<a class="indexterm" name="id2559441"></a>	<a class="indexterm" name="id2559447"></a>	<a class="indexterm" name="id2559453"></a>        ディストリビューションtarファイル中にのソースコードのexamplesサブディレ        クトリ中にサンプルの設定ファイルがある。実際問題としてオプションがどの        ように組み合わさるかを見る事が出来るので、注意深く読むことを推奨する。        すべてのオプションはマニュアルページを見よ。必要があることに適用するた        めと、<code class="filename">smb.conf.default</code>ファイルを設定し始めること        は価値があるかもしれない。そこには多くのコメントが書いてある。	</p><p>	<a class="indexterm" name="id2559481"></a>        最も簡単に使える設定ファイルは	<a class="link" href="install.html#simple-example" title="Example 1.2. もう一つ別の簡単なsmb.confファイル">もう1つ別の簡単なsmb.confファイル</a>        中で見る事ができるようなものを含んでいる。	<a class="indexterm" name="id2559500"></a>	</p><div class="example"><a name="simple-example"></a><p class="title"><b>Example 1.2. もう一つ別の簡単なsmb.confファイル</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td><a class="indexterm" name="id2559530"></a><em class="parameter"><code>workgroup = MIDEARTH</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[homes]</code></em></td></tr><tr><td><a class="indexterm" name="id2559548"></a><em class="parameter"><code>guest ok = no</code></em></td></tr><tr><td><a class="indexterm" name="id2559559"></a><em class="parameter"><code>read only = no</code></em></td></tr></table></div></div><br class="example-break"><p>	<a class="indexterm" name="id2559572"></a>	<a class="indexterm" name="id2559579"></a>	<a class="indexterm" name="id2559585"></a>	<a class="indexterm" name="id2559591"></a>        これは、サーバ上にアカウントを持つ誰でも、ログイン名かサービス名        として、<em class="parameter"><code>homes</code></em>への接続を許す。        (注意:Sambaが使うワークグループ名も設定する必要がある。既定値の        ワークグループ名はWORKGROUPである。)	</p><p>	<a class="indexterm" name="id2559613"></a>        正しい場所に<code class="filename">smb.conf</code>ファイルをきちんと置くこと。正しい場所は、        バイナリファイルの構築方法に依存することに注意。正しい場所を知る        ためには、以下の<code class="literal">smbd</code>コマンド行を実行することで        わかる:</p><pre class="screen"><code class="prompt">root# </code> smbd -b | grep smb.conf</pre><p>	</p><p>	<a class="indexterm" name="id2559649"></a>	<em class="parameter"><code>[homes]</code></em>共有に対するセキュリティ設定の詳しい情報は 	<a class="link" href="securing-samba.html" title="Chapter 18. Securing Samba">Sambaのセキュア化</a>を参照してほしい。	</p><div class="sect3" title="testparmによる設定ファイルの検査"><div class="titlepage"><div><div><h4 class="title"><a name="id2559672"></a><code class="literal">testparm</code>による設定ファイルの検査</h4></div></div></div><p>	<a class="indexterm" name="id2559684"></a>	<a class="indexterm" name="id2559691"></a>	<a class="indexterm" name="id2559697"></a>        <span class="application">testparm</span>プログラムを使って<code class="filename">smb.conf</code>ファイルの内容を検査することは        重要である。もしもtestparmが正しく動けば、設定されたサービスの一覧を        表示する。もしもそうでなければ、エラーメッセージを表示する。それが        正しく動くようにして、動かす前にサービスが合理的であるようにすること。        以下のコマンドを入力する:	</p><pre class="screen">	<code class="prompt">root# </code> testparm /etc/samba/smb.conf	</pre><p>        Testparmは設定ファイルを解析し、不正な文法や不明なパラメータを報告する。        また、共通の設定ミスをチェックし、それが見つかれば警告を発する。	</p><p>        <code class="filename">smb.conf</code>ファイルを変更した後には必ずtestparmを実行すること!	</p><p>	<a class="indexterm" name="id2559759"></a>	<a class="indexterm" name="id2559766"></a>	<a class="indexterm" name="id2559772"></a>	<a class="indexterm" name="id2559778"></a>        <code class="filename">smb.conf</code>ファイルは<code class="literal">smbd</code>daemonによって定期的にチェッ        クされ、        <code class="literal">nmbd</code>と<code class="literal">winbindd</code>によりそれがspawnさ        れる毎インスタンスごとにチェックされる。可能な限りこのファイルを小さく        しておくことはよいことである。多くの管理者はSamba設定を文書化すること        を好み、そのため、このファイルを小さくしておくことは、賢明な文書化手法        である。これを適用する1つの解決方法は、        <code class="filename">smb.conf.master</code>というような名前で別のファイルに、        すべての文書と設定を1つにまとめておくことである。        <code class="literal">testparm</code>ユーティリティは、以下のように、マスタの        設定および文書ファイルから完全に最適化された<code class="filename">smb.conf</code>ファイルを作成        するのに使える:</p><pre class="screen"><code class="prompt">root# </code> testparm -s smb.conf.master > smb.conf</pre><p>        この管理手法は最小限の必要性のために<code class="filename">smb.conf</code>ファイルサイズを同じ時に        保つ間詳細な設定変更レコードをメンテナンスすることを可能にする。	</p></div></div><div class="sect2" title="SWAT"><div class="titlepage"><div><div><h3 class="title"><a name="id2559871"></a>SWAT</h3></div></div></div><p>	<a class="indexterm" name="id2559878"></a>        SWATはWebベースの、Sambaの設定を行うために使うことが出来るインタフェー        スである。SWATはあなたのプラットフォームでSambaパッケージで有効になって        いないかもしれないが、分離したパッケージになっているかもしれない。もし        もSWATを構築することが必要ならば、編集に注意してSWATのマニュアルページ        を読んでソースコードからSWATを構成してインストールしてほしい。	</p><p>        SWATを起動するために、好みのブラウザを起動し、	<a class="ulink" href="http://localhost:901/" target="_top">http://localhost:901/</a>        を指定する。        Sambaを動かしているコンピュータがブラウザが動いているコンピュータと異な        るならば、<em class="replaceable"><code>localhost</code></em>の部分を置き換えること。	</p><p>        SWATは任意のIP接続されたマシンからブラウザ経由で使えるが、平文でパスワー        ドがネットワーク上を流れ、盗聴の危険性があることに注意してほしい。	</p><p>        SWATについての詳細な情報は、        <a class="link" href="SWAT.html" title="Chapter 37. SWAT: Samba Web 管理ツール">The Samba Web Administration Tool</a>        にある。	</p></div></div><div class="sect1" title="サーバ上で有効な共有の一覧表示"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2559944"></a>サーバ上で有効な共有の一覧表示</h2></div></div></div><p>        設定済みのSambaサーバから有効な共有の一覧を表示するには、以下の        コマンドを実行する:	</p><pre class="screen"><code class="prompt">$ </code><strong class="userinput"><code>smbclient -L <em class="replaceable"><code>yourhostname</code></em></code></strong></pre><p>        サーバ上で有効の共有の一覧が表示される。もしもそうでなければ、設定が        どこか間違っている。この方法はたとえばWindows 2000のような、他のSMB        サーバの共有が有効かと言うことにも使える。	</p><p>        もしも、ユーザレベルのセキュリティを選択しているならば、共有の一覧を表        示する前にパスワードを要求してくる。詳細は<code class="literal">smbclient</code>        のマニュアルページを参照のこと。コマンドラインに<code class="option">-N</code>        オプションを追加することで、パスワード要求なしに共有の一覧を表示出来る。	</p></div><div class="sect1" title="UNIXクライアントによる接続"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2560015"></a>UNIXクライアントによる接続</h2></div></div></div><p>        以下のコマンドを入力する:</p><pre class="screen"><code class="prompt">$ </code><strong class="userinput"><code>smbclient <em class="replaceable"><code> //yourhostname/aservice</code></em></code></strong></pre><p>通常<em class="replaceable"><code>yourhostname</code></em>は<span class="application">smbd</span>が        インストールされたホストの名前である。        <em class="replaceable"><code>aservice</code></em>は<code class="filename">smb.conf</code>ファイル中にある任意の        サービスである。<code class="filename">smb.conf</code>ファイル中の        <em class="parameter"><code>[homes]</code></em>セクションがあるならばusernameを試みる        こと。</p><p>例:もしもUNIXホストが<em class="replaceable"><code>bambi</code></em>で有効な        ログイン名が<em class="replaceable"><code>fred</code></em>ならば、以下のように入力:</p><pre class="screen"><code class="prompt">$ </code><strong class="userinput"><code>smbclient //<em class="replaceable"><code>bambi</code></em>/<em class="replaceable"><code>fred</code></em></code></strong></pre></div><div class="sect1" title="リモートのSMBクライアントからの接続"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2560111"></a>リモートのSMBクライアントからの接続</h2></div></div></div><p>        Sambaがローカルで正しく動いている時には、他のクライアントからアクセスを        試みることが出来る。数分以内に、Sambaホストは同一のサブネット上のすべて        のWindowsクライアント上のマイネットワーク上(Network Neighborhood)に表示        される。他のクライアントからサーバをブラウズするかそれをマウントするこ        とを試みる。	</p><p>        DOS、Windows、あるいはOS/2クライアントからのマウントは以下のコマンドを        動かすことで行える:</p><pre class="screen"><code class="prompt">C:\> </code><strong class="userinput"><code>net use m: \\servername\service</code></strong></pre><p>	Where the drive letter m: is any available drive letter. It is important to double-check that the	service (share) name that you used does actually exist.	</p><p>	Try printing, for example,</p><pre class="screen"><code class="prompt">C:\> </code><strong class="userinput"><code>net use lpt1:	\\servername\spoolservice</code></strong></pre><p>	<code class="literal">spoolservice</code>は対象のサーバ上のプリンタの名前(実際        にはプリントキュー)である。これは、指定されたspoolserviceが所有する        プリンタに送られるWinbowsクライアント上のlpt1:ポートでキャプチャされ        たすべてのプリントジョブを許可する。	</p><p></p><pre class="screen"><code class="prompt">C:\> </code><strong class="userinput"><code>print filename</code></strong></pre><div class="sect2" title="うまく動かない時には"><div class="titlepage"><div><div><h3 class="title"><a name="id2560208"></a>うまく動かない時には</h3></div></div></div><p>	<a class="link" href="diagnosis.html" title="Chapter 38. Sambaチェックリスト">Sambaチェックリスト</a>を読んでみてもよい。        もしもまだ行き詰まっているならば、        <a class="link" href="problems.html" title="Chapter 39. Sambaの問題の調査と解決方法">Sambaの問題の解析と解決</a>を参照しよう。        Sambaは世界中でとてもたくさん正常にインストールされている。あなたの        特定の問題が固有であれば、あなたの問題に誰かが遭遇し、それを克服する        方法を見つけていることを発見するために、インターネット上での検索を実        行することは生産的かもしれない。	</p><p>        もしも、Sambaを使うのが初めてで、特にWindowsかUNIX/Linuxののネット        ワーキング初心者ならば、<span class="quote">“<span class="quote">Samba-3 by Example</span>”</span>という本        (訳注:Sambaのドキュメントの一部にもなっている)は評価済みのネットワーク        環境を作るのに手助けとなるだろう。最もサイトのニーズに適合するネット        ワークデザインがある最初の五章から単に選び、それを展開するための        単純な段階的手順を取りなさい。その後、ネットワークが動き、更に改良の        ための機会のための知識の取得のためには、この本を再度参照しよう。	</p></div><div class="sect2" title="まだ解決しない?"><div class="titlepage"><div><div><h3 class="title"><a name="id2560276"></a>まだ解決しない?</h3></div></div></div><p>        惨めなフラストレーションのストレスに対する最高のアドバイスは、クールダウ        ンすることである!それはそれ自身挑戦かもしれないが、怒っているか、        悩んでいる間、解決策を探すことは難しくなる。頭を冷やせば、探している        答えを見つかることにつながる。繰り返すが、すべての問題は解決策がある        今そうすることが出来なくとも、誰かがそれを見つけるよい機会が        ある。それは時間、忍耐と学習で変わる。	</p><p>        少しクールダウンしたなら、        <a class="link" href="diagnosis.html" title="Chapter 38. Sambaチェックリスト">the Samba Checklist</a>を、問題の原因を        確認するために行う事が出来る手順を確認するために参照してほしい。	</p></div></div><div class="sect1" title="共通のエラー"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2560316"></a>共通のエラー</h2></div></div></div><p>以下の質問と問題はSambaメーリングリスト上で繰り返し発生するものである。</p><div class="sect2" title="大量のsmbdプロセス"><div class="titlepage"><div><div><h3 class="title"><a name="id2560328"></a>大量のsmbdプロセス</h3></div></div></div><p>        Sambaの3つの中心的なプログラムは:<span class="application">nmbd</span>, <span class="application">smbd</span>, と <span class="application">winbindd</span>である。        <span class="application">nmbd</span>はネームサーバメッセージdaemonで、<span class="application">smbd</span>はサーバメッセージ        daemonで、<span class="application">winbindd</span>はドメインコントローラとの間での通信を処理する        daemonである。	</p><p>        もしもSambaがWINSサーバとして動作して<span class="emphasis"><em>いない</em></span>ならば、        システム上には1つの<span class="application">nmbd</span>インスタンスが動作する。もしもWINSサーバとして        動作するならば、2つのインスタンスがある。1つはWINS要求を処理        する。	</p><p>	<span class="application">smbd</span> はすべての接続要求を処理する。おのおののクライアントに対する        接続が終わると新しいプロセスがspawnする。それゆえ、クライアント接続毎        にたくさんのdaemonが存在する。	</p><p>	<span class="application">winbindd</span>は1つまたは2つのdaemonで動作し、        <span class="emphasis"><em>split mode</em></span>(2つのインスタンスの場合)かどうかによる。	</p></div><div class="sect2" title="エラーメッセージ: open_oplock_ipc"><div class="titlepage"><div><div><h3 class="title"><a name="id2560428"></a>エラーメッセージ: open_oplock_ipc</h3></div></div></div><p>        <span class="application">smbd</span>が起動した時にログファイル中に以下のエラーメッセージが出ることがある:	<span class="quote">“<span class="quote">open_oplock_ipc: Failed to	get local UDP socket for address 100007f. Error was Cannot assign requested.</span>”</span>	</p><p>        これは、loopbackデバイスが正しく動作していない。正しく設定し直すこと。        ループバックデバイスは内部(仮想の)ネットワークデバイスで、IPアドレスが        <span class="emphasis"><em>127.0.0.1</em></span>である。システム上でどのようにloopback        デバイスを設定するかはOSのドキュメントを読むこと。	</p></div><div class="sect2" title="“ネットワーク名が見つからない”"><div class="titlepage"><div><div><h3 class="title"><a name="id2560467"></a><span class="quote">“<span class="quote"><span class="errorname">ネットワーク名が見つからない</span></span>”</span></h3></div></div></div><p>                このエラーは以下の設定ミスのどれかによって起きる:		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="filename">smb.conf</code>内で共有に対する存在しない                        パスを指定した。</p></li><li class="listitem"><p>共有にアクセスしようとするユーザが                        共有のパスに対する適切なアクセス権を持っていない。                        読み出し(r)とアクセス(x)を有効にすべき。</p></li><li class="listitem"><p>アクセスしようとする共有が存在しない。</p></li></ul></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="introduction.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="introduction.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="FastStart.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part I. 概要 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 2. 手軽な始め方: 短気な方への手引き</td></tr></table></div></body></html>