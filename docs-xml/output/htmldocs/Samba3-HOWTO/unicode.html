<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 30. ユニコード/文字セット</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="公式のSamba 3.2.x HOWTOとリファレンスガイド"><link rel="up" href="optional.html" title="Part III. 詳細な設定方法"><link rel="prev" href="integrate-ms-networks.html" title="Chapter 29. Microsoft Windows ネットワークへのSambaの統合"><link rel="next" href="Backup.html" title="Chapter 31. バックアップテクニック"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 30. ユニコード/文字セット</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="integrate-ms-networks.html">Prev</a> </td><th width="60%" align="center">Part III. 詳細な設定方法</th><td width="20%" align="right"> <a accesskey="n" href="Backup.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter 30. ユニコード/文字セット"><div class="titlepage"><div><div><h2 class="title"><a name="unicode"></a>Chapter 30. ユニコード/文字セット</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Jelmer</span> <span class="othername">R.</span> <span class="surname">Vernooij</span></h3><div class="affiliation"><span class="orgname">The Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jelmer@samba.org">jelmer@samba.org</a>></code></p></div></div></div></div><div><div class="author"><h3 class="author"><span class="firstname">John</span> <span class="othername">H.</span> <span class="surname">Terpstra</span></h3><div class="affiliation"><span class="orgname">Samba Team<br></span><div class="address"><p><code class="email"><<a class="email" href="mailto:jht@samba.org">jht@samba.org</a>></code></p></div></div></div></div><div><div class="author"><h3 class="author"><span class="firstname">たかはし</span> <span class="surname">もとのぶ</span></h3><span class="contrib">日本語サポート</span> <div class="affiliation"><div class="address"><p><code class="email"><<a class="email" href="mailto:monyo@home.monyo.com">monyo@home.monyo.com</a>></code></p></div></div></div></div><div><p class="pubdate">25 March 2003</p></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="unicode.html#id2692674">機能と利便性</a></span></dt><dt><span class="sect1"><a href="unicode.html#id2692743">文字セットとユニコードとは何か</a></span></dt><dt><span class="sect1"><a href="unicode.html#id2692916">Sambaと文字セット</a></span></dt><dt><span class="sect1"><a href="unicode.html#id2693068">古い名前からの変換</a></span></dt><dt><span class="sect1"><a href="unicode.html#id2693107">日本語の文字セット</a></span></dt><dd><dl><dt><span class="sect2"><a href="unicode.html#id2693284">基本的なパラメータの設定</a></span></dt><dt><span class="sect2"><a href="unicode.html#id2694068">個別の実装</a></span></dt><dt><span class="sect2"><a href="unicode.html#id2694213">Samba-2.2系列からの移行</a></span></dt></dl></dd><dt><span class="sect1"><a href="unicode.html#id2694368">よくあるエラー</a></span></dt><dd><dl><dt><span class="sect2"><a href="unicode.html#id2694374">CP850.so が見つからない</a></span></dt></dl></dd></dl></div><div class="sect1" title="機能と利便性"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2692674"></a>機能と利便性</h2></div></div></div><p><a class="indexterm" name="id2692682"></a>どんな技術もいつかは成熟する。ここ10年間に焦点を当てたときに、成熟度が大きく前進した領域のひとつが、どこでもだれでもコンピュータを利用できるようにするための技術である。もっとも、常にそうだったわけではない。実際、ソフトウェアを開発する際には、作成した国でのみ使うことを想定して開発されるのが当たり前だったのはさほど昔のことではない。</p><p>すべてのコンピュータユーザに自国の言語サポートを提供するために使われたすべての労力、<a class="ulink" href="http://www.openi18n.org/" target="_top">Openi18n organization</a>の労力は、特記に値する。Of all the effort that has been brought to bear on providing nativelanguage support for all computer users, the efforts of the<a class="ulink" href="http://www.openi18n.org/" target="_top">Openi18n organization</a>is deserving of special mention.</p><p><a class="indexterm" name="id2692726"></a>Samba-2.xは、<span class="emphasis"><em>codepages</em></span>と呼ばれる単一のロケール機構をサポートしていた。Samba-3では真に国際的な、ファイルと印刷共有プラットフォームとして予定されていた。</p></div><div class="sect1" title="文字セットとユニコードとは何か"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2692743"></a>文字セットとユニコードとは何か</h2></div></div></div><p><a class="indexterm" name="id2692751"></a>コンピュータは数字で通信する。テキストにおいては、各数字は対応する文字に変換される。特定の数に割り当てられた意味は、使用する<span class="emphasis"><em>文字セット(charset)</em></span>に依存する。</p><p><a class="indexterm" name="id2692772"></a><a class="indexterm" name="id2692779"></a>文字セットは数字から文字への変換のために使われる表として見る事ができる。すべてのコンピュータが同じ文字セット(ドイツのウムラウト、日本の文字セットなど)を使うわけではない。American Standard Code for Information Interchange (ASCII)エンコーディングシステムは、現在まで、コンピュータによって使われる基本の文字エンコーディング体系となっていた。これは、256文字を含む文字セットを使用する。このモードのエンコーディングを使うと、各文字は正確に1バイトとなる。</p><p><a class="indexterm" name="id2692810"></a><a class="indexterm" name="id2692818"></a>ASCIIエンコーディングが取るよりも、少なくとも2倍の、より多くの記憶容量を必要とする、拡張文字をサポートする文字セットもある。そのような文字セットは、考えられるすべての文字よりも多い<code class="literal">256 * 256 = 65536</code>文字を含むことが出来る。これらは、1つの文字を格納するために、1バイトより多く使うという理由で、マルチバイト文字セットと呼ばれる。</p><p><a class="indexterm" name="id2692846"></a>ある標準化されたマルチバイト文字セットエンコーディング機構は、<a class="ulink" href="http://www.unicode.org/" target="_top">ユニコード</a>である。マルチバイト文字セットを使う大きな利点は、それを使うだけで済むと言うことである。通信時に、2つのコンピュータが尾内文字セットを使うようにする必要はない。</p><p><a class="indexterm" name="id2692870"></a><a class="indexterm" name="id2692877"></a><a class="indexterm" name="id2692884"></a>古いWindowsクライアントはMicrosoftによる<em class="parameter"><code>コードページ</code></em>という単一バイト文字セットを使っている。しかし、SMB/CIFSプロトコル中で使われるために調停される文字セットではサポートされていない。そのため、より古いクライアントと通信する時、同じ文字セットを使うようにしなければならない。より新しいクライアント(Windows NT、200x、XP)では、ユニコードを使って通信する。</p></div><div class="sect1" title="Sambaと文字セット"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2692916"></a>Sambaと文字セット</h2></div></div></div><p><a class="indexterm" name="id2692924"></a><a class="indexterm" name="id2692931"></a>Samba-3では、Sambaはユニコードで通信できる。内部的には、Sambaは3つの文字セットを認識する。</p><div class="variablelist"><dl><dt><span class="term"><a class="link" href="smb.conf.5.html#UNIXCHARSET" target="_top">unix charset</a></span></dt><dd><p><a class="indexterm" name="id2692965"></a><a class="indexterm" name="id2692971"></a>		これは使用しているOSによって内部的に使われる文字セットである。		既定値は<code class="constant">UTF-8</code>で、ほとんどのシステムに適しており、		すべての言語中のすべての文字をカバーする。以前のSambaリリースにおける		既定値は、クライアントのエンコーディングでファイル名を保存するための		ものであった。たとえば、CP850は西ヨーロッパ各国用である。		</p></dd><dt><span class="term"><a class="link" href="smb.conf.5.html#DISPLAYCHARSET" target="_top">display charset</a></span></dt><dd><p>これは、画面上でメッセージを表示するためにSambaが使う		文字セットである。これは一般的に<em class="parameter"><code>unix charset</code></em>と		同じにすべきである。		</p></dd><dt><span class="term"><a class="link" href="smb.conf.5.html#DOSCHARSET" target="_top">dos charset</a></span></dt><dd><p>これは、DOSとWindows 9x/Meクライアントと通信する時に		Sambaが使う文字セットである。より新しいクライアントすべてとはユニコードで		通信する。既定値は、インストールした、使用するシステム上の文字セットに		依存する。使用するすシステム上での既定値が何かと言うことは、		<code class="literal">testparm -v | grep "dos charset"</code>を実行して		調べられる。		</p></dd></dl></div></div><div class="sect1" title="古い名前からの変換"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2693068"></a>古い名前からの変換</h2></div></div></div><p><a class="indexterm" name="id2693076"></a>以前のSambaバージョンは、何らの文字セット変換を行わないので、ファイル名中の文字セットは、通常UNIX文字セットでは正しくならない。DOS/Windowsクライアントによって使われるローカル文字セット専用である。</p><p>Bjoern Jackeは、<a class="ulink" href="http://j3e.de/linux/convmv/" target="_top">convmv</a>という、1つのコマンドですべてのディレクトリ構造を異なった文字セットに変換できるユーティリティを作成した。</p></div><div class="sect1" title="日本語の文字セット"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2693107"></a>日本語の文字セット</h2></div></div></div><p>日本語の文字セットを設定するのはかなり難しい。それは以下のような理由による:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="indexterm" name="id2693126"></a>		Windows文字セットはオリジナルの日本工業標準(JIS X 0208)から拡張された		ものであり、標準化されていない。これは、正確に標準にそった実装は、		Windows文字セット全部をサポート出来ないと言うことである。	</p></li><li class="listitem"><p><a class="indexterm" name="id2693147"></a><a class="indexterm" name="id2693153"></a><a class="indexterm" name="id2693160"></a><a class="indexterm" name="id2693167"></a><a class="indexterm" name="id2693174"></a>		主に歴史的な理由により、日本においては複数のエンコーディング方法があり、		おのおのは、互いに完全に互換ではない。主要なエンコーディング方法は2つ		ある。1つはWindowsといくつかのUNIXで使われるシフトJIS系列である。		もう1つはEUC-JP系列であり、ほとんどのUNIXとLinuxで使われている。さらに、		Sambaは以前に、CAPとHEXという、CAP/NetAtalkと日本語ファイル名を使えない		UNIXとの互換性を確保するための、固有なエンコーディング方法を提供して		いた。EUC-JP系列のいくつかの実装は、完全なWindows文字セットをサポート		できない。	</p></li><li class="listitem"><p>ユニコードと旧来の日本語文字セットとの間での変換テーブルは		いくつかある。ある1つはWindowsと互換であり、そのほかはユニコード		コンソーシアムのものをベースにしたものであり、ほかには複数のものを		まぜた実装がある。ユニコードコンソーシアムは、公式にはユニコードと		他の旧来の文字セットとの間での変換テーブルを定義していないので、		それは標準にはなり得ない。	</p></li><li class="listitem"><p>iconv()内で有効な文字セットと変換テーブルは、利用できるiconv		ライブラリに依存する。その次に、日本語のロケール名は異なったシステム上		では異なっているかもしれない。これは、文字セットパラメータの値は、		使用しているiconv()の実装に依存するというということである。		</p><p><a class="indexterm" name="id2693245"></a><a class="indexterm" name="id2693252"></a><a class="indexterm" name="id2693259"></a><a class="indexterm" name="id2693266"></a>		2バイトの固定的なUCS-2エンコーディングがWindows内部で使われているが、		シフトJIS系列のエンコーディングは、英語環境でASCIIエンコーディングが		使われているように日本語環境で通常使われている。	</p></li></ul></div><div class="sect2" title="基本的なパラメータの設定"><div class="titlepage"><div><div><h3 class="title"><a name="id2693284"></a>基本的なパラメータの設定</h3></div></div></div><p><a class="indexterm" name="id2693291"></a>	<a class="link" href="smb.conf.5.html#DOSCHARSET" target="_top">dos charset</a>と<a class="link" href="smb.conf.5.html#DISPLAYCHARSET" target="_top">display charset</a>は	ロケールと互換のある文字セットとWindows上で使われているエンコーディング方法に	設定すべきである。これは通常CP932であるが、時々違う名前を使う。	</p><p><a class="indexterm" name="id2693328"></a><a class="indexterm" name="id2693335"></a><a class="indexterm" name="id2693341"></a>	<a class="link" href="smb.conf.5.html#UNIXCHARSET" target="_top">unix charset</a>はシフトJIS系列、EUC-JP系列、あるいは	UTF-8系列に設定できる。UTF-8は常時利用可能であるが、他のロケールとそれ自身の	名前の有効性は使用するシステム依存である。	</p><p>	さらに追加すると、Samba 2.2系列において、<span class="quote">“<span class="quote">coding system = CAP</span>”</span>	と設定したのと同じ事を行うvfs capモジュールを使うことによって、	シフトJIS系列を<a class="link" href="smb.conf.5.html#UNIXCHARSET" target="_top">unix charset</a>パラメータの値として	使うことを考慮することが出来る。	</p><p>	<a class="link" href="smb.conf.5.html#UNIXCHARSET" target="_top">unix charset</a>をどこに設定するかは難しい質問である。	以下は特定の値を使う場合の詳細、利点、欠点の一覧である。	</p><div class="variablelist"><dl><dt><span class="term">シフトJIS系列</span></dt><dd><p>			シフトJIS系列は日本語のWindows上で標準として使われている			<code class="constant">Shift_JIS</code>と同等なロケールを意味する。			<code class="constant">Shift_JIS</code>の場合は、たとえば、もしも			日本語のファイル名に0x8ba4 と 0x974c(4バイトの日本語文字列で、			<span class="quote">“<span class="quote">share</span>”</span>(訳注:<span class="quote">“<span class="quote">共有</span>”</span>)と			<span class="quote">“<span class="quote">.txt</span>”</span>が含まれていてSamba上にWindowsから書き込み			された場合、UNIX上のファイル名は			0x8ba4, 0x974c, <span class="quote">“<span class="quote">.txt</span>”</span>(8バイトのバイナリ文字列)			となり、これはWindowsのものと同じである。			</p><p>シフトJIS系列が、いくつかの商用ベースのUNIX、たとえば			hp-uxとAIXで、日本語のロケールで使われている(しかし、			EUC-JPロケール系列を使うことも可能である)。それらのプラット			フォーム上でシフトJISを使うと、Windowsから作成された			日本語のファイル名はUNIX上でも参照できる。</p><p>			もしも、使用しているUNIXがすでにシフトJISで動いていて、Windowsから			書かれる日本語ファイル名を使う事が必要なユーザには、シフトJIS系列			は最適の選択である。しかし、不正なファイル名が表示されるか、			非ASCIIファイル名を扱えないコマンドがファイル名を処理するときに			アボートするかもしれない。そして、ファイル名中に、注意して			扱わなければならない<span class="quote">“<span class="quote">\ (0x5c)</span>”</span>があるときは特に			である。UNIX上でWindowsから書かれたファイル名をさわらないのが			最も安全である。			</p><p>			ほとんどの日本語化されたフリーソフトウェアは実際EUC-JPのみで			動作する。日本語化されたフリーソフトウエアがシフトJISで動くかを			検証するのはよい習慣である。			</p></dd><dt><span class="term">EUC-JP系列</span></dt><dd><p><a class="indexterm" name="id2693508"></a><a class="indexterm" name="id2693515"></a>			EUC-JP系列は、日本でのUNIX(EUCには日本語以外の言語、たとえば			EUC-KRの仕様も含む)で広く使われているEUC-JPという業界標準と同等の			ロケールを意味する。EUC-JP系列の場合、例えば、もしも、日本語の			ファイル名に0x8ba4と0x974cと<span class="quote">“<span class="quote">.txt</span>”</span>を含むものが、			Samba上でWindowsから書かれた場合、UNIX上のファイル名は、			0xb6a6, 0xcdad,<span class="quote">“<span class="quote">.txt</span>”</span>となる(8バイトのバイナリ文字列)。			</p><p><a class="indexterm" name="id2693546"></a><a class="indexterm" name="id2693552"></a><a class="indexterm" name="id2693559"></a><a class="indexterm" name="id2693566"></a><a class="indexterm" name="id2693573"></a><a class="indexterm" name="id2693580"></a><a class="indexterm" name="id2693586"></a><a class="indexterm" name="id2693593"></a><a class="indexterm" name="id2693600"></a><a class="indexterm" name="id2693607"></a>			EUC-JPは通常オープンソースのUNIX、Linuxと振りと商用ベースのUNIX、			Solaris、IRIXとTru64 UNIXで日本語ロケールとして使われている			(しかし、SolarisではシフトJISとUTF-8を使うことも出来、Tru64 UNIX			ではシフトJISも使うことが出来る)。EUC-JP系列を使うためには、			Windowsから作成された日本語ファイル名の大半は、UNIX上でも参照			できる。また、ほとんどの日本語化されたフリーソフトウェアも			ほとんどがEUC-JPのみで動作する。			</p><p>			UNIX上で日本語のファイル名を使うときにはEUC-JP系列を選択する			事を推奨する。			</p><p>			<span class="quote">“<span class="quote">\ (0x5c)</span>”</span>のように注意深く扱わなければならない文字が			無いにもかかわらず、不正なファイル名が表示されることもあり、			非ASCIIファイル名を扱えないいくつかのコマンドはファイル名の			処理中にアボートするかもしれない。			</p><p><a class="indexterm" name="id2693652"></a>			さらに、もしも、異なる、インストールされたlibiconvを使ってSambaを			構築した場合、eucJP-msロケールがlibiconv中に含まれ、OSに			含まれているEUC-JP系列とは非互換かもしれない。この場合、			ファイル名に非互換の文字を使うことを防止する必要があるかもしれない。			</p></dd><dt><span class="term">UTF-8</span></dt><dd><p>			UTF-8は、ユニコードコンソーシアムによって定義された国際標準である			UTF-8と同じロケールであることを意味する。UTF-8中では、			<em class="parameter"><code>文字</code></em>は1から3バイトで記述される。日本語			では、ほとんどの文字は3バイトとなる。WindowsのシフトJISでは、			日本語を表現する文字が、1か2バイトなので、UTF-8の文字列長は、			オリジナルのシフトJISの文字列の1.5倍である。UTF-8の場合、			たとえばSamba上に、Windowsから書かれるファイル名が、			0x8ba4と0x974cと<span class="quote">“<span class="quote">.txt</span>”</span>の場合、UNIX上のファイル名は、			0xe585, 0xb1e6, 0x9c89, <span class="quote">“<span class="quote">.txt</span>”</span>(10バイトのバイナリ			文字列)となる。			</p><p>			iconv()が有効でないシステムか、iconv()のロケールがWindowsと			非互換のものの場合、UTF-8は唯一の有効なロケールである。			</p><p> 			日本においてはUTF-8を既定値のロケールとしているシステムはない。			</p><p>			何らかの不正なファイル名が表示されるかもしれず、非ASCII			ファイル名を扱えないコマンドがあるかもしれない。特に、			ファイル名に注意深く扱わなければならない			<span class="quote">“<span class="quote">\ (0x5c)</span>”</span>をファイル名に持つ場合は、UNIX上で、			Windowsから書かれたファイル名に触れない方が無難である。			</p><p><a class="indexterm" name="id2693752"></a><a class="indexterm" name="id2693759"></a><a class="indexterm" name="id2693766"></a>			さらに追加すると、Sambaに直接関係してはいないが、			一般的にUNIX上で使われているiconv()機能と、WindowsやJavaの			ような他のプラットフォーム上で使われている機能との間では、			微妙な違いがあり、そのためシフトJISとユニコードのUTF-8との			間での変換は注意深くかつ、プロセスで関連する制限の認識を			して行わなければならないという点で関連性がある。			</p><p><a class="indexterm" name="id2693786"></a>			Mac OS Xはそのファイル名のエンコード方式としてUTF-8を使用しているが、			それはSambaが扱えない拡張されたUTF-8仕様を使っているので、Mac OS X			では、UTF-8ロケールは無効である。			</p></dd><dt><span class="term">Shift_JIS系列 + vfs_cap (CAPエンコーディング)</span></dt><dd><p><a class="indexterm" name="id2693814"></a><a class="indexterm" name="id2693821"></a><a class="indexterm" name="id2693828"></a>			CAPエンコーディングは、Macintosh用のファイルサーバソフトウェア			であるCAPとNetAtalkで使われる仕様である。CAPエンコーディングの			場合、たとえば、もしもSamba上に、Windowsから書かれる日本語の			ファイル名に、0x8ba4と0x974cと<span class="quote">“<span class="quote">.txt</span>”</span>が含まれている			場合、UNIX上のファイル名は<span class="quote">“<span class="quote">:8b:a4:97L.txt</span>”</span>			(14バイトのASCII文字列)となる。			</p><p>			CAPエンコーディングでは、ASCII文字として表現できないもの			(0x80以上)は、<span class="quote">“<span class="quote">:xx</span>”</span>形式でエンコードされる。			ファイル名中に<span class="quote">“<span class="quote">\(0x5c)</span>”</span>を含むものは注意深く扱う			必要があるが、非ASCIIファイル名を扱えないシステム中でも、			ファイル名が不正になることはない。			</p><p>			CAPエンコーディングのとても大きな利点は、CAPあるいはNetAtalkでの			エンコーディングと互換があるということである。これらは、それぞれ			Columbia Appletalk ProtocolとNetAtalkオープンソースソフトウェア			プロジェクトである。これらのソフトウェアアプリケーションが、			CAPエンコーディングでUNIX上にファイル名を書き込むので、もしも、			SambaとNetAtalkの両方でディレクトリが共有される場合、非ASCII			ファイル名を使わないようにCAPを使って、ファイル名が不正になる			ことを防ぐ必要がある。			</p><p>			しかし、最近、NetAtalkはファイル名をEUC-JP(すなわち、日本の			オリジナルなVine Linux)でファイル名を書き込むように、いくつかの			システムではパッチが当てられた。この場合、CAPエンコーディングの			代わりに、EUC-JP系列を選ばなければならない。			</p><p>			vfs_cap それ自身は、非ASCII文字を扱えないシステムか、NetAtalkと			ファイルを共有するシステムのための、非シフトJIS系列のロケールの			ために有効である。			</p><p>			Samba-3でCAPエンコーディングを使うためには、unix charset			パラメータと、			<a class="link" href="unicode.html#vfscap-intl" title="Example 30.1. VFS CAP">the VFS CAP smb.conf file</a>			のようなVFSを使うべきである。			To use CAP encoding on Samba-3, you should use the unix charset parameter and VFS 			as in <a class="link" href="unicode.html#vfscap-intl" title="Example 30.1. VFS CAP">VFS CAPを使うsmb.confファイル</a>。			</p><div class="example"><a name="vfscap-intl"></a><p class="title"><b>Example 30.1. VFS CAP</b></p><div class="example-contents"><table border="0" summary="Simple list" class="simplelist"><tr><td> </td></tr><tr><td><em class="parameter"><code>[global]</code></em></td></tr><tr><td># the locale name "CP932" may be different</td></tr><tr><td><a class="indexterm" name="id2693979"></a><em class="parameter"><code>dos charset = CP932</code></em></td></tr><tr><td><a class="indexterm" name="id2693991"></a><em class="parameter"><code>unix charset = CP932</code></em></td></tr><tr><td> </td></tr><tr><td><em class="parameter"><code>[cap-share]</code></em></td></tr><tr><td><a class="indexterm" name="id2694012"></a><em class="parameter"><code>vfs option = cap</code></em></td></tr></table></div></div><br class="example-break"><p><a class="indexterm" name="id2694026"></a><a class="indexterm" name="id2694033"></a><a class="indexterm" name="id2694040"></a><a class="indexterm" name="id2694047"></a>			もしも、GNU libiconvをunix charsetに使うならば、CP932を設定			である。この設定を使う場合、<span class="quote">“<span class="quote">cap-share</span>”</span>共有中の			ファイル名はCAPエンコーディングで書かれる。			</p></dd></dl></div></div><div class="sect2" title="個別の実装"><div class="titlepage"><div><div><h3 class="title"><a name="id2694068"></a>個別の実装</h3></div></div></div><p>個別の実装に関する追加情報は以下の通り:</p><div class="variablelist"><dl><dt><span class="term">GNU libiconv</span></dt><dd><p>			日本語を正しく取り扱うために、libiconv-1.8に			<a class="ulink" href="http://www2d.biglobe.ne.jp/~msyk/software/libiconv-patch.html" target="_top">libiconv-1.8-cp932-patch.diff.gz</a>			というパッチを適用すべきである。			</p><p>			パッチを当てたlibiconv-1.8を使うことで、以下の設定が有効になる:			</p><pre class="programlisting">dos charset = CP932unix charset = CP932 / eucJP-ms / UTF-8		|       |		|       +-- EUC-JP系列		+-- Shift_JIS系列display charset = CP932</pre><p>			他の日本語ロケール(たとえば、Shift_JISとEUC-JP)は、Windowsとの			互換性が欠如しているため、使うべきではない。			</p></dd><dt><span class="term">GNU glibc</span></dt><dd><p>			日本語を正しく取り扱うために、glibc-2.2.5/2.3.1/2.3.2に			<a class="ulink" href="http://www2d.biglobe.ne.jp/~msyk/software/glibc/" target="_top">patch</a>			のパッチを適用すべきであり、そうでない場合は、パッチがマージ			された、glibc-2.3.3以降を使うべきである。			</p><p>			上記のglibcを使うことで、以下の設定が有効になる:			</p><table border="0" summary="Simple list" class="simplelist"><tr><td><a class="indexterm" name="id2694162"></a><em class="parameter"><code>dos charset = CP932</code></em></td></tr><tr><td><a class="indexterm" name="id2694174"></a><em class="parameter"><code>unix charset = CP932 / eucJP-ms / UTF-8</code></em></td></tr><tr><td><a class="indexterm" name="id2694186"></a><em class="parameter"><code>display charset = CP932</code></em></td></tr></table><p>			</p><p>			他の日本語ロケール(たとえば、Shift_JISとEUC-JP)は、Windowsとの                        互換性が欠如しているため、使うべきではない。			</p></dd></dl></div></div><div class="sect2" title="Samba-2.2系列からの移行"><div class="titlepage"><div><div><h3 class="title"><a name="id2694213"></a>Samba-2.2系列からの移行</h3></div></div></div><p> Samba 2.2系列以前では、<span class="quote">“<span class="quote">coding system</span>”</span>パラメータが使われていた。Samba 2.xの既定値のcodepageは code page 850であった。Samba-3系列では、これは<a class="link" href="smb.conf.5.html#UNIXCHARSET" target="_top">unix charset</a>に置き換えられた。<a class="link" href="unicode.html#japancharsets" title="Table 30.1. Samba-2.2とSamba-3中の日本語文字セット">Samba-2.2とSamba-3中の日本語文字セット</a>には、Samba-2.2系列からSamba-3系列へ移行するときのマッピングテーブルを示している。</p><div class="table"><a name="japancharsets"></a><p class="title"><b>Table 30.1. Samba-2.2とSamba-3中の日本語文字セット</b></p><div class="table-contents"><table summary="Samba-2.2とSamba-3中の日本語文字セット" border="1"><colgroup><col align="center"><col align="center"></colgroup><thead><tr><th align="center">Samba-2.2 Coding System</th><th align="center">Samba-3 unix charset</th></tr></thead><tbody><tr><td align="center">SJIS</td><td align="center">Shift_JIS系列</td></tr><tr><td align="center">EUC</td><td align="center">EUC-JP系列</td></tr><tr><td align="center">EUC3<sup>[<a name="id2694315" href="#ftn.id2694315" class="footnote">a</a>]</sup></td><td align="center">EUC-JP系列</td></tr><tr><td align="center">CAP</td><td align="center">Shift_JIS系列 + VFS</td></tr><tr><td align="center">HEX</td><td align="center">現状では存在しない</td></tr><tr><td align="center">UTF8</td><td align="center">UTF-8</td></tr><tr><td align="center">UTF8-Mac<sup>[<a name="id2694348" href="#ftn.id2694348" class="footnote">b</a>]</sup></td><td align="center">現状では存在しない</td></tr><tr><td align="center">その他</td><td align="center">なし</td></tr></tbody><tbody class="footnotes"><tr><td colspan="2"><div class="footnote"><p><sup>[<a name="ftn.id2694315" href="#id2694315" class="para">a</a>] </sup>Samba日本語版のみに存在</p></div><div class="footnote"><p><sup>[<a name="ftn.id2694348" href="#id2694348" class="para">b</a>] </sup>Samba日本語版のみに存在</p></div></td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="sect1" title="よくあるエラー"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2694368"></a>よくあるエラー</h2></div></div></div><div class="sect2" title="CP850.so が見つからない"><div class="titlepage"><div><div><h3 class="title"><a name="id2694374"></a>CP850.so が見つからない</h3></div></div></div><p><span class="quote">“<span class="quote">Sambaが<code class="filename">CP850.so</code>ファイルがないというエラーを出す。</span>”</span></p><p>		CP850は<a class="link" href="smb.conf.5.html#DOSCHARSET" target="_top">dos charset</a>の既定値である。		<a class="link" href="smb.conf.5.html#DOSCHARSET" target="_top">dos charset</a>は使用しているDOSクライアントにょって		使われるコードページに変換するのに使われる。もしも、DOSクライアントが		ないのであれば、このメッセージを無視しても安全である。</p><p>		CP850は使用しているローカルなiconvの実装によってサポートされている。		必要とするすべてのパッケージがインストールされているかを確認すること。		もしもソースからSambaをコンパイルした場合、configureにおいてiconvを		見つけたかを確認すること。これは、<code class="literal">configure</code>が		実行された的に生成される<code class="filename">config.log</code>ファイルを		チェックすることで行える。</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="integrate-ms-networks.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="optional.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="Backup.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 29. Microsoft Windows ネットワークへのSambaの統合 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 31. バックアップテクニック</td></tr></table></div></body></html>