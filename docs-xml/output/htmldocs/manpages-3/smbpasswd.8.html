<?xml version="1.0" encoding="UTF-8"?>
<html><head><title>smbpasswd</title><link rel="stylesheet" href="../samba.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry" title="smbpasswd"><a name="smbpasswd.8"/><div class="titlepage"/><div class="refnamediv"><h2>Name</h2><p>smbpasswd — ユーザーの SMB パスワードを変更する</p></div><div class="refsynopsisdiv" title="Synopsis"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="literal">smbpasswd</code> [-a] [-c &lt;config file&gt;] [-x] [-d] [-e] [-D debuglevel] [-n] [-r &lt;remote machine&gt;] [-R &lt;name resolve order&gt;] [-m] [-U username[%password]] [-h] [-s] [-w pass] [-W] [-i] [-L] [username]</p></div></div><div class="refsect1" title="説明"><a name="id2490613"/><h2>説明</h2><p>このツールは、<a class="citerefentry" href="Samba.7.html"><span class="citerefentry"><span class="refentrytitle">Samba</span>(7)</span></a>システムの一部である。</p><p>smbpasswd プログラムは、
	<span class="emphasis"><em>root</em></span>
	ユーザーによって実行される場合とそうでない場合とで、いくつかの機能が異なる。
	一般ユーザーによって実行される場合、ユーザーは
	SMB パスワードを格納するあらゆるマシン上で、SMB セッションのために利用する自分のパスワードを変更することができる。
	</p><p>デフォルト (引数なしで実行した場合) では、
	ローカルマシン上の実行したユーザーの SMB パスワードの変更を試みる。
	これは <code class="literal">passwd(1)</code> プログラムと似た動作となる。
	<code class="literal">smbpasswd</code> は、
	<span class="emphasis"><em>setuid root</em></span> されていない点と、
	クライアント/サーバーモードで動作し、同一ホストで動作している
	<a class="citerefentry" href="smbd.8.html"><span class="citerefentry"><span class="refentrytitle">smbd</span>(8)</span></a>
	と通信する点が <code class="literal">passwd(1)</code> と異なる。
	このため、パスワードを変更するには、
	smbd デーモンがローカルマシン上で動作していなければならない。
	UNIX マシン上では、通常、
	暗号化された SMB パスワードは
	<a class="citerefentry" href="smbpasswd.5.html"><span class="citerefentry"><span class="refentrytitle">smbpasswd</span>(5)</span></a>
	ファイルに保持される。</p><p>一般ユーザーが引数なしで実行すると、
	smbpasswd は古い (現在の) SMB パスワードの入力を求めた後、
	新しいパスワードが正しく入力されることを確実にするため、
	新しいパスワードの入力を 2 回求める。
	入力したパスワードは画面上には表示されない。
	ユーザーにパスワードが割り当てられていない場合
	(smbpasswd ファイルで「NO PASSWORD」という文字列が指定されている場合) は、
	古いパスワードの入力を求められたときに
	&lt;Enter&gt; キーだけを押すこと。</p><p>smbpasswd は、一般ユーザーが
	Windows NT プライマリドメインコントローラーなどのリモートマシン上の
	SMB パスワードを変更する際に使用することもできる。
	詳細は下記の <em class="parameter"><code>-r</code></em> オプションと
	<em class="parameter"><code>-U</code></em> オプションを参照のこと。</p><p>root が実行する場合、smbpasswd は smbpasswd ファイルへの
	ユーザーの追加・削除、既存ユーザーの属性を変更することが可能である。
	このとき、
	<code class="literal">smbpasswd</code> はローカルの smbpasswd ファイルに
	直接アクセスする。よって、 smbd が実行されていなくても変更を行うことが可能である。
	</p></div><div class="refsect1" title="オプション"><a name="id2490777"/><h2>オプション</h2><div class="variablelist"><dl><dt><span class="term">-a</span></dt><dd><p>このオプションは、
		指定したユーザー username を新しいパスワードとともにローカルの
		smbpasswd ファイルに追加することを指示する。
		
		すでに指定されたユーザーが存在する場合はオプションは無視され、
		通常どおりパスワード変更コマンドとして動作する。
		注意: デフォルトのパスワードデータベースバックエンドは、
		システムのパスワードファイル
		(通常は <code class="filename">/etc/passwd</code>)
		に同名のユーザーが存在いることを要求するため、
		システムにユーザーが存在しないとユーザーの追加は失敗する。</p><p>このオプションは、
		root が smbpasswd を実行するときだけ利用できる。</p></dd><dt><span class="term">-c</span></dt><dd><p>
		このオプションは、既定値のファイルと位置ものを使うことが重要な時、
		<code class="filename">smb.conf</code>設定ファイルのパスとファイル名を指定することに使うことが出来る。
		</p></dd><dt><span class="term">-x</span></dt><dd><p>このオプションは、
		指定したユーザー username をローカルの
		smbpasswd ファイルから削除することを指示する。</p><p>このオプションは、
		root が smbpasswd を実行するときだけ利用できる。</p></dd><dt><span class="term">-d</span></dt><dd><p>このオプションは、
		ローカルの smbpasswd ファイル内の指定したユーザー username
		を<code class="constant">無効にすること</code>を指示する。
		これは、
		smbpasswd ファイルのアカウント制御領域に
		「<code class="constant">D</code>」
		フラグを書き込むことで行なわれる。
		こうすることで、
		このユーザー名を利用した SMB の認証はすべて失敗するようになる。</p><p>smbpasswd ファイルが Samba 2.0 以前の古い形式の場合、
		ユーザーのパスワードエントリに情報を書き込むための領域がないため、
		このオプション指定は失敗する。
		新旧のパスワードファイル形式についての詳細は、
		<a class="citerefentry" href="smbpasswd.5.html"><span class="citerefentry"><span class="refentrytitle">smbpasswd</span>(5)</span></a> を参照のこと。
		</p><p>このオプションは、
		root が smbpasswd を実行するときだけ利用できる。</p></dd><dt><span class="term">-e</span></dt><dd><p>このオプションは、
		ローカルの smbpasswd ファイル内の指定したユーザー username
		を<code class="constant">有効にすること</code>を指示する。
		アカウントが無効になっていなければ、このオプションはなんの効果もない。
		アカウントを有効にすることで、
		このユーザーは再び SMB の認証が受けられるようになる。
		</p><p>smbpasswd ファイルが古い形式の場合、
		<code class="literal">smbpasswd</code> はアカウントの有効化に失敗する。
		新旧のパスワードファイル形式についての詳細は、
		<a class="citerefentry" href="smbpasswd.5.html"><span class="citerefentry"><span class="refentrytitle">smbpasswd</span>(5)</span></a> を参照のこと。</p><p>このオプションは、
		root が smbpasswd を実行するときだけ利用できる。</p></dd><dt><span class="term">-D debuglevel</span></dt><dd><p>デバッグレベルを
		<em class="replaceable"><code>debuglevel</code></em> に設定する。
		<em class="replaceable"><code>debuglevel</code></em>
		は、0 から 10 までの整数である。
		このパラメータを指定しないときのデフォルト値は 0 である。</p><p>この値を大きくするほど、
		smbpasswd の動作に関するより詳細な情報がログファイルに記録される。
		レベル 0 では、致命的なエラーと重大な警告のみが記録される。</p><p>1 より上のレベルは大量のログが生成されるので、
                問題解決の時にのみ使用すべきである。
		3 より上のレベルは開発者だけが利用するように設計されており、
		莫大な量のログデータが生成される。
		そのほとんどは非常に謎めいた内容となっている。</p></dd><dt><span class="term">-n</span></dt><dd><p>このオプションは、
		ローカルの smbpasswd ファイル内の指定したユーザー username
		のパスワードをなくすよう指示する (すなわち、パスワードなしとなる)。
		これは、
		smbpasswd ファイルのパスワード保持領域の先頭部分に
		「NO PASSWORD」という文字列を書き込むことで行なわれる。</p><p>
		注意: smbpasswd ファイル内でパスワードが「NO PASSWORD」に設定されると、
		そのユーザーが Samba サーバーにログオンするためには、
		<code class="filename">smb.conf</code> ファイルの
		[global] セクションに下記のパラメータを設定しなければならない:</p><p><code class="literal">null passwords = yes</code></p><p>このオプションは、
		root が smbpasswd を実行するときだけ利用できる。</p></dd><dt><span class="term">-r remote machine name</span></dt><dd><p>このオプションは、
		変更したいパスワードがどのマシン上にあるかを指定することができる。
		このパラメータが指定されていないと、デフォルトはローカルホストになる。
		<em class="replaceable"><code>remote machine name</code></em>
		には、パスワード変更を試みるために接続する
		SMB/CIFS サーバーの NetBIOS 名を指定する。
		この名前は、
		Samba のすべてのプログラムで利用される標準的な名前解決方式によって、
		IP アドレスへと変換される。
		名前解決方式の設定については、
		<em class="parameter"><code>-R name resolve order</code></em>
		パラメータを参照のこと。</p><p>パスワードの変更対象となるユーザーの名前は、
		smbpasswd 実行時の UNIX のログイン名となる。
		異なるユーザー名のパスワードの変更方法については、
		<em class="parameter"><code>-U username</code></em> パラメータを参照のこと。</p><p>注意:
		Windows NT ドメインのパスワードを変更するには、
		プライマリドメインコントローラーを指定しなければならない。
		(バックアップドメインコントローラーは、
		読み込み専用のユーザアカウントデータベースの複製を持っているだけで、
                パスワードを変更することはできない)</p><p><span class="emphasis"><em>注意:</em></span>
		Windows 95/98 は実際のパスワードデータベースを持っていないため、
                Windows 95/98 マシンを指定してもパスワードの変更はできない。</p></dd><dt><span class="term">-R name resolve order</span></dt><dd><p>このオプションにより、smbpasswd のユーザーは、接続先のホストのNetBIOS 名の検索にどの名前解決サービスを使用するかを決めることができる。</p><p>オプションには、"lmhosts"、"host"、"wins"、"bcast"のいずれかを指定する。それぞれの名前解決は以下のように行われる。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="constant">lmhosts</code>: Samba lmhosts ファイルで IP アドレスが検索される。lmhosts の行に NetBIOS 名にアタッチされるネームタイプがない場合(詳細については <a class="citerefentry" href="lmhosts.5.html"><span class="citerefentry"><span class="refentrytitle">lmhosts</span>(5)</span></a> を参照)、ネームタイプがどれであるかは検索結果に影響しなくなる。</p></li><li class="listitem"><p><code class="constant">host</code>: システムの <code class="filename">/etc/hosts
            </code>、NIS、DNS ルックアップを使用した、ホスト名 - IP アドレス間の標準の名前解決が行われる。名前解決の方法の詳細な部分は、IRIX、Solaris といった OS によって変わる。<code class="filename">/etc/nsswitch.conf</code> で制御できる場合もある。この方法は、検索される NetBIOS 名のタイプが 0x20 (サーバー) である時にのみ使用できる点に注意。さもなければ指定しても無視される。</p></li><li class="listitem"><p><code class="constant">wins</code>: <em class="parameter"><code>wins server</code></em> パラメータに指定された IP アドレスを持つ名前が検索される。WINS サーバーが指定されていなければ、無視される。</p></li><li class="listitem"><p><code class="constant">bcast</code>: 
            <em class="parameter"><code>interfaces</code></em> パラメータに指定された既知のローカル･インターフェースそれぞれについてブロードキャストを行う。ターゲット・ホストがローカル接続サブネット上にある場合にしか使えないので、最も信頼性の低い名前解決法。</p></li></ul></div><p>デフォルトの優先順位は、<code class="literal">lmhosts、host、wins、bcast</code> となる。このパラメータがない場合、あるいは<a class="citerefentry" href="smb.conf.5.html"><span class="citerefentry"><span class="refentrytitle">smb.conf</span>(5)</span></a> ファイルにエントリがない場合、この順序で名前解決方法が試行される。</p></dd><dt><span class="term">-m</span></dt><dd><p>このオプションは、
		パスワードの変更対象のアカントがマシンアカウントであることを
		smbpasswd に指示する。
		現在のところ、このオプションは、Samba が
		NT プライマリドメインコントローラーとして動作しているときに利用される。
		</p><p>このオプションは、
		root が smbpasswd を実行するときだけ利用できる。</p></dd><dt><span class="term">-U username</span></dt><dd><p>このオプションは、
		<em class="parameter"><code>-r</code></em> オプションと共に利用する。
		リモートマシン上のパスワードを変更する場合に、
		
		パスワード変更対象とする(リモート)マシン上のユーザー名を指定することができる。
		これにより、
		ユーザーがリモートマシン上で異なるユーザー名を持っている場合でも、
		ユーザーはパスワードを変更することができる。</p></dd><dt><span class="term">-h</span></dt><dd><p>このオプションは、
		<code class="literal">smbpasswd</code> のヘルプを表示する。
		
		</p></dd><dt><span class="term">-s</span></dt><dd><p>
		このオプションを指定すると、
		smbpasswd は寡黙 (すなわちプロンプトを出さない) になり、
		新旧のパスワードを (<code class="literal">passwd(1)</code> プログラムのように)
		<code class="filename">/dev/tty</code> からは読み込まず、
		標準入力から読み込むようになる。
		このオプションは smbpasswd を扱うスクリプトを書くときに有用となる。</p></dd><dt><span class="term">-w password</span></dt><dd><p>
		このオプションは、Samba がLDAPサポートを指定してコンパイルされているときのみ利用できる。
		<em class="parameter"><code>-w</code></em> オプションは、
		<a class="link" href="smb.conf.5.html#LDAPADMINDN" target="_top">ldap admin dn</a>
		に使用するパスワードを設定するために利用する。
		注意:
		パスワードは LDAP 管理者の DN をキーにして
		<code class="filename">secrets.tdb</code> ファイルに格納される。
		このため、
		<a class="link" href="smb.conf.5.html#" target="_top"/>
		パラメータの値を変更した場合は、
		パスワードの更新も必要になる。
		</p></dd><dt><span class="term">-W</span></dt><dd><p><code class="literal">注意:</code>このオプションは標準入力からパスワードを受け取ることを除いて、"-w"と同じである。
		</p><p>このパラメータはSambaがLDAPサポート付きでコンパイルされている場合に
のみ有効である。<em class="parameter"><code>-W</code></em>スイッチは<a class="link" href="smb.conf.5.html#LDAPADMINDN" target="_top">ldap admin dn</a>と
		ともに使われるパスワードを指定するのに使われる。
		注意:
		パスワードは LDAP 管理者の DN をキーにして
		<code class="filename">secrets.tdb</code> ファイルに格納される。
		このため、
		<a class="link" href="smb.conf.5.html#" target="_top"/>
		パラメータの値を変更した場合は、
		パスワードの更新も必要になる。
		</p></dd><dt><span class="term">-i</span></dt><dd><p>このオプションは、
		パスワードの変更対象のアカントがドメイン間信頼アカウントであることを
		smbpasswd に指示する。
		現在のところ、このオプションは、Samba が
		NT プライマリドメインコントローラーとして動作しているときに利用される。
		このアカウントには、
		信頼する側のドメインに関する情報が含まれる。</p><p>このオプションは、
		root が smbpasswd を実行するときだけ利用できる。
		</p></dd><dt><span class="term">-L</span></dt><dd><p>ローカルモードで起動する。</p></dd><dt><span class="term">username</span></dt><dd><p>すべての <span class="emphasis"><em>root 専用</em></span>
		オプション用に、操作対象とするユーザーの名前を指定する。
		ローカルの smbpasswd ファイルを直接修正する権限を持つ
		root だけがこのパラメータを指定することができる。
		</p></dd></dl></div></div><div class="refsect1" title="注意"><a name="id2487264"/><h2>注意</h2><p>一般ユーザーが実行する場合、
	<code class="literal">smbpasswd</code> はローカルの
	smbd とクライアント/サーバーモードで通信するため、
	機能するには smbd デーモンが動作していなければならない。
	よくある問題として、
	ローカルマシンで動作している <code class="literal">smbd</code>
	にアクセス可能なホストを制限するため
	<a class="citerefentry" href="smb.conf.5.html"><span class="citerefentry"><span class="refentrytitle">smb.conf</span>(5)</span></a>
	ファイルに
	<em class="parameter"><code>allow hosts</code></em>
	または
	<em class="parameter"><code>deny hosts</code></em>
	パラメータを設定したときに、
	「localhost」にアクセス許可を与えるのを忘れてしまうことがある。</p><p>なお、smbpasswd コマンドは、
	Samba が暗号化パスワードを使うように設定してあるときのみ利用できる。</p></div><div class="refsect1" title="バージョン"><a name="id2487328"/><h2>バージョン</h2><p>このマニュアルページは、Samba バージョン 3用に記述されている。</p></div><div class="refsect1" title="関連項目"><a name="id2487339"/><h2>関連項目</h2><p><a class="citerefentry" href="smbpasswd.5.html"><span class="citerefentry"><span class="refentrytitle">smbpasswd</span>(5)</span></a>, <a class="citerefentry" href="Samba.7.html"><span class="citerefentry"><span class="refentrytitle">Samba</span>(7)</span></a>.</p></div><div class="refsect1" title="著者"><a name="id2487364"/><h2>著者</h2><p>オリジナルの Samba ソフトウェアと関連するユーティリティは、
	Andrew Tridgell によって作られた。 Samba は現在、Linux
	カーネルが開発されているような方法でのオープンソースプロジェクトである
	Samba Team によって開発されている。</p><p>オリジナルの Samba のマニュアルページは Karl Auer によって書かれた。マニュアルページのソースは YODL 形式(別の、優秀なオープンソースソフトウェアで、<a class="ulink" href="ftp://ftp.icce.rug.nl/pub/unix/" target="_top">ftp://ftp.icce.rug.nl/pub/unix/</a>にある)で変換され、Jeremy Allison によって Samba 2.0 リリースのために更新された。
	Samba 2.2 のための DocBook 形式への変換は Gerald Carter が行った。 
	Samba 3.0 のための DocBook XML 4.2 形式の変換は Alexander Bokovoy によって行われた。
	</p></div><div class="refsect1" title="日本語訳"><a name="id2487402"/><h2>日本語訳</h2><p>このマニュアルページは Samba 3.2.4 - 3.5.3 対応のものである。</p><p>このドキュメントの Samba 3.0.0 対応の翻訳は、さとうふみやす によって行なわれた。</p><p>このドキュメントの Samba 3.2.4 - 3.5.3 対応の翻訳は、太田俊哉(ribbon@samba.gr.jp)によって行なわれた。</p></div></div></body></html>
