<?xml version="1.0" encoding="UTF-8"?>
<html><head><title>vfs_scannedonly</title><link rel="stylesheet" href="../samba.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry" title="vfs_scannedonly"><a name="vfs_scannedonly.8"/><div class="titlepage"/><div class="refnamediv"><h2>Name</h2><p>vfs_scannedonly — エンドユーザに対して、ウィルスをスキャンするファイルをのみを
	  見えるように、かつアクセスできるようにさせる。</p></div><div class="refsynopsisdiv" title="Synopsis"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="literal">vfs objects = scannedonly</code></p></div></div><div class="refsect1" title="説明"><a name="id2529790"/><h2>説明</h2><p>このVFSモジュールは
	<a class="citerefentry" href="samba.8.html"><span class="citerefentry"><span class="refentrytitle">samba</span>(8)</span></a>システムの一部である。</p><p><code class="literal">vfs_scannedonly</code> VFS モジュールはエンドユーザに対して
	  ウィルスチェックを行うファイルのみを、表示、アクセス可能にさせる。もしも
	  ウィルスチェックをしないファイルが見つかった場合、ウィルススキャンデーモンは
	  その旨通知する。ウィルススキャンデーモンはSambaの一部ではない。
	</p><p>Scanreadonlyは2つの部分からなっている。それはSamba vfsモジュールと
	  (1つまたはそれ以上の)デーモンである。デーモンはファイルをスキャンする。もしも
	  特定のファイルが正常であれば、プレフィックス<code class="filename">.scanned:</code>
	  というプレフィックスを持つファイルが生成される。Sambaモジュールは、単に
	  <code class="filename">.scanned:</code>というファイルが存在するかと、関連する
	  ファイルよりも新しいかを調べる。もしもその場合は、ファイルはユーザに見える
	  ようになる。もしもそうでない場合、ファイルはディレクトリ一覧表示(設定可能)
	  では見えない。Samba vfsモジュールはそのファイルをスキャンするようにデーモンに
	  通知する。
	</p><p>これが、既定値の設定でユーザに対して行われることである。最初にディレクトリ
	  一覧が表示された時、ファイルはウィルススキャン中のように表示されるが、
	  そのあとは、すべてのファイルが表示される。すべてのディレクトリをあらかじめ
	  スキャンするために役立つscannedonly_prescanユーティリティが用意されている。
	  新しいファイルが作成された時、デーモンへは、ファイルへの書き込みが完了後に
	  引き続いて通知される。
	</p><p>もしもデーモンによって、ウィルスが発見された場合、警告メッセージを含む
	  ファイルがユーザのディレクトリ中に作成され、警告がログに書き込まれ、ファイルは
	  <code class="filename">.virus:</code>というプレフィックスを持つ名前に改名される。
	  <code class="filename">.virus:</code>プレフィックスを持つファイルはユーザには決して
	  見えず、アクセスは拒否される。
	</p><p>このモジュールはスタック可能である。</p></div><div class="refsect1" title="設定"><a name="id2490616"/><h2>設定</h2><p><code class="literal">vfs_scannedonly</code>はscannedonlyソケット(UNIXドメイン
	  ソケットかUDPソケット)上でリッスンするウィルススキャンデーモンに依存する。
	</p></div><div class="refsect1" title="オプション"><a name="id2490634"/><h2>オプション</h2><div class="variablelist"><dl><dt><span class="term">scannedonly:domain_socket = True </span></dt><dd><p>UNIXドメインソケットを使うか否かの指定(Falseはudpを使う)
		</p></dd><dt><span class="term">scannedonly:socketname = /var/lib/scannedonly/scan</span></dt><dd><p>接続するUNIXドメインソケットの位置</p></dd><dt><span class="term">scannedonly:portnum = 2020</span></dt><dd><p>接続するUDPポート番号
		</p></dd><dt><span class="term">scannedonly:scanhost = localhost</span></dt><dd><p>
		  UDP使用時、スキャンデーモンが動作するホスト
		  (このホストはファイルへのアクセスを必要とする!)
		</p></dd><dt><span class="term">scannedonly:show_special_files = True</span></dt><dd><p>
		  ユーザに対して見えるべきソケット、デバイスとfifo
		  (すべてウィルスチェックを行わない)かどうかの指定
		</p></dd><dt><span class="term">scannedonly:rm_hidden_files_on_rmdir = True</span></dt><dd><p>
		  見せないファイル(<code class="filename">.scanned:</code>ファイル、
                <code class="filename">.failed:</code>ファイルと<code class="filename">.virus:
                </code> ファイル)は、もしもユーザがディスクから削除しようと
		した時に、見えないファイルを削除すべきかどうかの指定。もしも
		偽ならば、ユーザは"ディレクトリが空ではありません"というエラーが
		生じる。
		</p></dd><dt><span class="term">scannedonly:hide_nonscanned_files = True</span></dt><dd><p>
		  もしも偽ならば、すべてのスキャンされないファイルはディレクトリ
		  一覧表示で見えるようになる。もしも、そのようなファイルが
		  ディレクトリ一覧中に見つかった場合、スキャンデーモンに
		  スキャンが要求されたと通知する。スキャンされないファイルへの
		  アクセスは引き続き拒否される(scannedonly:allow_nonscanned_files
		  を参照のこと)。
		</p></dd><dt><span class="term">scannedonly:scanning_message = is being scanned for
	viruses</span></dt><dd><p>
		  もしも、スキャンされないファイルが隠し状態
		  (scannedonly:hide_nonscanned_files = Trueの場合)、見かけ上
		  0バイトのファイルが表示される。ファイル名はサフィックスとして
		  メッセージとオリジナルのファイル名を結合したものである。
		</p></dd><dt><span class="term">scannedonly:recheck_time_open = 50</span></dt><dd><p>
		  スキャンされないファイルがオープンしていた場合、vfs
		  モジュールは、<code class="filename">.scanned:</code>ファイルを作成するために、
		  スキャンデーモンに対して、recheck_tries_open回、recheck_time_open
		  ミリ秒待つ。時間内(*回再試行)にデーモンによってスキャンされる
		  小さなファイルは、その動作がアクセス後とのスキャニングのように
		  振る舞う。
		</p></dd><dt><span class="term">scannedonly:recheck_tries_open = 100</span></dt><dd><p>
		recheck_time_openを参照。
		</p></dd><dt><span class="term">scannedonly:recheck_time_readdir = 50</span></dt><dd><p>
		  もしも、スキャンされないファイルがディレクトリ一覧表示中にあるならば、
		  vfsモジュールはデーモンに通知し(そのディレクトリ中のものは、
		  すべてスキャンが必要と一回は通知する)、recheck_tries_readdir回
		  recheck_time_readdirミリ秒待つ。hide_nonscanned_filesが偽の
		  時にのみ使われる。
		</p></dd><dt><span class="term">scannedonly:recheck_tries_readdir = 20</span></dt><dd><p>
		recheck_time_readdirを参照。
		</p></dd><dt><span class="term">scannedonly:allow_nonscanned_files = False</span></dt><dd><p>
		  スキャンされないファイルへのアクセスを認める。しかし、デーモンには
		  通知されるが、それは<code class="filename">.scanned:</code>のような特別な
		  ファイルである。<code class="filename">.virus:</code>ファイルと
		  <code class="filename">.failed:</code>ファイルは一覧表示されない。
		</p></dd></dl></div></div><div class="refsect1" title="例"><a name="id2490927"/><h2>例</h2><p>ウィルススキャンを有効にする:</p><pre class="programlisting">
        <em class="parameter"><code>[homes]</code></em>
	<a class="link" href="smb.conf.5.html#VFSOBJECTS" target="_top">vfs objects = scannedonly</a>
	<a class="link" href="smb.conf.5.html#SCANNEDONLY:HIDE_NONSCANNED_FILES" target="_top">scannedonly:hide_nonscanned_files = False</a>
</pre></div><div class="refsect1" title="警告"><a name="id2491073"/><h2>警告</h2><p>これは、オンアクセススキャンと同値でないことに注意。しかしながら、
	  すでにスキャンされたファイルに対してはとても高速である。
	</p></div><div class="refsect1" title="バージョン"><a name="id2491086"/><h2>バージョン</h2><p>このマニュアルページは、バージョン 3.5.0 のSamba用である。
	</p></div><div class="refsect1" title="著者"><a name="id2491097"/><h2>著者</h2><p>オリジナルの Samba ソフトウェアと関連するユーティリティは、Andrew
        Tridgell によって作成された。現在 Samba は Samba Team に
        よって、Linuxカーネルの開発と同様のオープンソースプロジェクト
        として開発が行なわれている。</p></div><div class="refsect1" title="日本語訳"><a name="id2491118"/><h2>日本語訳</h2><p>このドキュメントは、Samba 3.5.0 - 3.5.4 対応のものである。</p><p>このドキュメントの翻訳は
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>太田俊哉 (ribbon@samba.grjp)</p></li></ul></div><p>
        によって行なわれた。</p></div></div></body></html>
