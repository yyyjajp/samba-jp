<?xml version="1.0" encoding="UTF-8"?>
<html><head><title>vfs_full_audit</title><link rel="stylesheet" href="../samba.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry" title="vfs_full_audit"><a name="vfs_full_audit.8"/><div class="titlepage"/><div class="refnamediv"><h2>Name</h2><p>vfs_full_audit — Samba VFS　の動作をsystem logに記録する</p></div><div class="refsynopsisdiv" title="Synopsis"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="literal">vfs objects = full_audit</code></p></div></div><div class="refsect1" title="説明"><a name="id2529796"/><h2>説明</h2><p>このVFSモジュールは
	<a class="citerefentry" href="samba.7.html"><span class="citerefentry"><span class="refentrytitle">samba</span>(7)</span></a>システムの一部である.</p><p><code class="literal">vfs_full_audit</code>VFSモジュールは指定したクライアントの
	動きを<a class="citerefentry" href="syslog.3.html"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>でシステムログに記録する。
	</p><p><code class="literal">vfs_full_audit</code>
	はSamba VFSの動作すべてを記録することが可能である。
	</p><table border="0" summary="Simple list" class="simplelist"><tr><td>aio_cancel</td></tr><tr><td>aio_error</td></tr><tr><td>aio_fsync</td></tr><tr><td>aio_read</td></tr><tr><td>aio_return</td></tr><tr><td>aio_suspend</td></tr><tr><td>aio_write</td></tr><tr><td>chdir</td></tr><tr><td>chflags</td></tr><tr><td>chmod</td></tr><tr><td>chmod_acl</td></tr><tr><td>chown</td></tr><tr><td>close</td></tr><tr><td>closedir</td></tr><tr><td>connect</td></tr><tr><td>disconnect</td></tr><tr><td>disk_free</td></tr><tr><td>fchmod</td></tr><tr><td>fchmod_acl</td></tr><tr><td>fchown</td></tr><tr><td>fget_nt_acl</td></tr><tr><td>fgetxattr</td></tr><tr><td>flistxattr</td></tr><tr><td>fremovexattr</td></tr><tr><td>fset_nt_acl</td></tr><tr><td>fsetxattr</td></tr><tr><td>fstat</td></tr><tr><td>fsync</td></tr><tr><td>ftruncate</td></tr><tr><td>get_nt_acl</td></tr><tr><td>get_quota</td></tr><tr><td>get_shadow_copy_data</td></tr><tr><td>getlock</td></tr><tr><td>getwd</td></tr><tr><td>getxattr</td></tr><tr><td>kernel_flock</td></tr><tr><td>lgetxattr</td></tr><tr><td>link</td></tr><tr><td>linux_setlease</td></tr><tr><td>listxattr</td></tr><tr><td>llistxattr</td></tr><tr><td>lock</td></tr><tr><td>lremovexattr</td></tr><tr><td>lseek</td></tr><tr><td>lsetxattr</td></tr><tr><td>lstat</td></tr><tr><td>mkdir</td></tr><tr><td>mknod</td></tr><tr><td>open</td></tr><tr><td>opendir</td></tr><tr><td>pread</td></tr><tr><td>pwrite</td></tr><tr><td>read</td></tr><tr><td>readdir</td></tr><tr><td>readlink</td></tr><tr><td>realpath</td></tr><tr><td>removexattr</td></tr><tr><td>rename</td></tr><tr><td>rewinddir</td></tr><tr><td>rmdir</td></tr><tr><td>seekdir</td></tr><tr><td>sendfile</td></tr><tr><td>set_nt_acl</td></tr><tr><td>set_quota</td></tr><tr><td>setxattr</td></tr><tr><td>stat</td></tr><tr><td>statvfs</td></tr><tr><td>symlink</td></tr><tr><td>sys_acl_add_perm</td></tr><tr><td>sys_acl_clear_perms</td></tr><tr><td>sys_acl_create_entry</td></tr><tr><td>sys_acl_delete_def_file</td></tr><tr><td>sys_acl_free_acl</td></tr><tr><td>sys_acl_free_qualifier</td></tr><tr><td>sys_acl_free_text</td></tr><tr><td>sys_acl_get_entry</td></tr><tr><td>sys_acl_get_fd</td></tr><tr><td>sys_acl_get_file</td></tr><tr><td>sys_acl_get_perm</td></tr><tr><td>sys_acl_get_permset</td></tr><tr><td>sys_acl_get_qualifier</td></tr><tr><td>sys_acl_get_tag_type</td></tr><tr><td>sys_acl_init</td></tr><tr><td>sys_acl_set_fd</td></tr><tr><td>sys_acl_set_file</td></tr><tr><td>sys_acl_set_permset</td></tr><tr><td>sys_acl_set_qualifier</td></tr><tr><td>sys_acl_set_tag_type</td></tr><tr><td>sys_acl_to_text</td></tr><tr><td>sys_acl_valid</td></tr><tr><td>telldir</td></tr><tr><td>unlink</td></tr><tr><td>utime</td></tr><tr><td>write</td></tr></table><p>これらの動作に加え、
	<code class="literal">vfs_full_audit</code>は"all" and "none "という
	オプションを使用することができる。これらはすべてのVFS動作に対し有効になり、
	ここのVFS動作に対して指定することはできない。
	</p><p><code class="literal">vfs_full_audit</code>は動作を'|'をセパレーターとして
	固定フォーマットで記録する。
	記録フォーマットは
	</p><pre class="programlisting">
		smbd_audit: PREFIX|OPERATION|RESULT|FILE
	</pre><p>各フィールドは:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="literal">PREFIX</code> - full_audit:prefix文字と、可変長の解説</p></li><li class="listitem"><p><code class="literal">OPERATION</code> - VFSの名称</p></li><li class="listitem"><p><code class="literal">RESULT</code> - 動作が成功したか、失敗したか</p></li><li class="listitem"><p><code class="literal">FILE</code> - 動作が行われたファイルやディレクトリの名称</p></li></ul></div><p>このモジュールはスタッカブルである。</p></div><div class="refsect1" title="オプション"><a name="id2490948"/><h2>オプション</h2><div class="variablelist"><dl><dt><span class="term">vfs_full_audit:prefix = STRING</span></dt><dd><p>STRINGで監査メッセージを結合する。STRINGは
		<a class="citerefentry" href="smb.conf.5.html"><span class="citerefentry"><span class="refentrytitle">smb.conf</span>(5)</span></a>に記載された指定を置き換える
		初期値は"%u|%I". </p></dd><dt><span class="term">vfs_full_audit:success = LIST</span></dt><dd><p>LISTはVFSオペレーションのリストで、動作が成功したときに記録を残すものを表す。
		オペレーションは上に示したリストにある名前で指定する。
		</p></dd><dt><span class="term">vfs_full_audit:failure = LIST</span></dt><dd><p>LISTはVFSオペレーションのリストで、動作が失敗したときに記録を残すものを表す。
		オペレーションは上に示したリストにある名前で指定する。
		</p></dd><dt><span class="term">full_audit:facility = FACILITY</span></dt><dd><p>
                <a class="citerefentry" href="syslog.3.html"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>のfacilityを指定する

                </p></dd><dt><span class="term">full_audit:priority = PRIORITY</span></dt><dd><p>
                <a class="citerefentry" href="syslog.3.html"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>のpriorityを指定する
                </p></dd></dl></div></div><div class="refsect1" title="設定例"><a name="id2491064"/><h2>設定例</h2><p>[records]共有の中のファイルやディレクトリをオープンしたときにログを残す。
	その際、LOCAL7ファシリティーと、ALERTプライオリティーを使用し、
	ユーザー名とIPアドレスも記録する:</p><pre class="programlisting">
        <em class="parameter"><code>[records]</code></em>
	<a class="link" href="smb.conf.5.html#PATH" target="_top">path = /data/records</a>
	<a class="link" href="smb.conf.5.html#VFSOBJECTS" target="_top">vfs objects = full_audit</a>
	<a class="link" href="smb.conf.5.html#FULL_AUDIT:PREFIX" target="_top">full_audit:prefix = %u|%I</a>
	<a class="link" href="smb.conf.5.html#FULL_AUDIT:SUCCESS" target="_top">full_audit:success = open opendir</a>
	<a class="link" href="smb.conf.5.html#FULL_AUDIT:FAILURE" target="_top">full_audit:failure = all</a>
	<a class="link" href="smb.conf.5.html#FULL_AUDIT:FACILITY" target="_top">full_audit:facility = LOCAL7</a>
	<a class="link" href="smb.conf.5.html#FULL_AUDIT:PRIORITY" target="_top">full_audit:priority = ALERT</a>
</pre></div><div class="refsect1" title="バージョン"><a name="id2491274"/><h2>バージョン</h2><p>このヘルプはSambaシステム　3.0.25(訳注:3.3?)に対応している
	</p></div><div class="refsect1" title="著者"><a name="id2491285"/><h2>著者</h2><p>オリジナルの Samba ソフトウェアと関連するユーティリティは、Andrew
	Tridgell によって作成された。現在 Samba は Samba Team に
	よって、Linuxカーネルの開発と同様のオープンソースプロジェクト
	として開発が行なわれている。</p></div><div class="refsect1" title="日本語訳"><a name="id2491300"/><h2>日本語訳</h2><p>このドキュメントは、Samba 3.0.25-3.3.12対応のものである。</p><p>このドキュメントの翻訳は
	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>平田祥司 (shouji@microft.co.jp)</p></li></ul></div><p>	
        によって行なわれた。</p></div></div></body></html>
