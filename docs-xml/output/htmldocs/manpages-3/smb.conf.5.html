<?xml version="1.0" encoding="UTF-8"?>
<html><head><title>smb.conf</title><link rel="stylesheet" href="../samba.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry" title="smb.conf"><a name="smb.conf.5"/><div class="titlepage"/><div class="refnamediv"><h2>Name</h2><p>smb.conf — Samba の設定ファイル</p></div><div class="refsect1" title="概要"><a name="id2529776"/><h2>概要</h2><p><code class="filename">smb.conf</code> ファイルは Samba
	システムの設定ファイルである。<code class="filename">smb.conf
	</code> には、Samba システムの各プログラムが実行時に参照する設定情報が記述される。
	<code class="filename">smb.conf</code> 
	ファイルは、<a class="citerefentry" href="swat.8.html"><span class="citerefentry"><span class="refentrytitle">swat</span>(8)</span></a> プログラムによって設定、
	管理されるように設計されている。
	以下参照目的で、ファイルの形式と設定可能なパラメータに関して網羅的に記述する。
	</p></div><div class="refsect1" title="ファイルの形式"><a name="FILEFORMATSECT"/><h2> ファイルの形式 </h2><p> ファイルはセクションとパラメータから構成される。セクションは、 大括弧(<span class="quote">“<span class="quote">[</span>”</span>
	と <span class="quote">“<span class="quote">]</span>”</span>) で囲まれたセクション名で始まり、次のセクションが始まるまで
	続く。セクション内には以下の形式でパラメータが記述される:
</p><pre class="programlisting">
<em class="replaceable"><code>パラメータ名（パラメータ）</code></em> = <em class="replaceable"><code>パラメータ値（値）</code></em>
</pre><p>
        </p><p>ファイルは行を基本単位とし、改行で終了する各行は、コメント、
	セクション名、パラメータのいずれかを表す。</p><p>セクション名およびパラメータ名は大文字と小文字を区別しない。</p><p>パラメータを示す行では、最初の 「=」 文字に重要な意味がある。
	最初の 「=」 文字の前後の空白文字は破棄される。
	セクション名およびパラメータ名の先頭、 途中、末尾にある空白文字は
	無視される。パラメータ値の先頭と末尾にある空白文字も無視される。
	ただし、パラメータ値の途中にある空白文字はそのまま意味を持つ。
	</p><p>セミコロン (<span class="quote">“<span class="quote">:</span>”</span>)、シャープ (<span class="quote">“<span class="quote">#</span>”</span>) で始まる行や、空白のみの行は
	無視される。</p><p><span class="quote">“<span class="quote">\</span>”</span> 文字で終わる行は、UNIX の慣習通り次の行へ継続する。
	</p><p> 「=」文字に続くパラメータ値には、文字列
	(引用符で囲む必要はない)、または真偽値を表す、yes/no、0/1、true/false
	のいずれかを記述する。真偽値の場合、大文字と小文字は同じ意味だが、
	記述されたとおりの文字列が保存される。
	create mask など、幾つかのパラメータ値は数値となる。
	</p></div><div class="refsect1" title="セクションの説明"><a name="id2490624"/><h2>セクションの説明</h2><p>設定ファイル中の ([global] セクションを除く) 各セクションでは、
	共有リソース (単に<span class="quote">“<span class="quote">共有</span>”</span>とも呼ぶ 
	(訳注: 「サービス」とも呼ばれる)) の設定が行なわれる。
	セクション名は共有リソース名となり、
	セクション内のパラメータは共有の設定に利用される。</p><p>[global]、[homes]、[printers] という 3 つの特殊なセクションに
	ついては、<span class="emphasis"><em>特殊なセクション</em></span> で説明する。
	以下の説明は、通常のセクションについてのものである。</p><p>共有の設定としては、大きくアクセスを許可するディレクトリの設定と
	それを利用するユーザに対するアクセス許可の設定とがある。
	その他いくつかの補助的なオプションの指定も可能である。</p><p>セクションは、ファイル共有サービス 
	(クライアントからファイルシステムの延長として利用される)
	とプリントサービス (クライアントからサーバ上で動作している
	印刷サービスにアクセスするために利用される) のいずれかに分類される。
	</p><p>セクションは、パスワードなしでアクセスできる
	<span class="emphasis"><em>ゲスト</em></span> サービスとして構成することもできる。
	この場合、UNIX 側で指定された<span class="emphasis"><em>ゲストアカウント</em></span>の権限でアクセスが
	行なわれる。</p><p>ゲストサービス以外のセクションにアクセスするにはパスワードが
	必要である。通常クライアントからはユーザ名も提供されるが、
	年代物のクライアントはパスワードのみでユーザ名を提供しないため、
	<span class="quote">“<span class="quote">user =</span>”</span> パラメータで指定したユーザのリストを用いてパスワードの検証を
	行なうことも可能である。Windows 95/98/Me/NT/2000 のような最近の
	クライアントでは、このパラメータは不要である。</p><p>Samba より与えられたアクセス権は、システムより UNIX ユーザ
	(またはゲストユーザ) に与えられたアクセス権によって制限されることに注意して欲しい。
	Samba はシステムが許可する以上のアクセス権を許可することはできない。</p><p> 以下の簡単なセクションは、ファイル共有を定義するものである。
	ユーザは <code class="filename">/home/bar</code>
	に対して書き込みができる。 共有は、<code class="literal">foo</code>
	という共有名でアクセス可能である:
</p><pre class="programlisting">
	<em class="parameter"><code>[foo]</code></em>
	<a class="link" href="smb.conf.5.html#PATH" target="_top">path = /home/bar</a>
	<a class="link" href="smb.conf.5.html#READONLY" target="_top">read only = no</a>
</pre><p>
	</p><p> 以下の簡単なセクションは印刷サービスを定義するものである。
	共有は読み取りのみであるが、印刷可能である。これは、
	スプールファイルのオープン、書き込み、クローズという作業についてのみ書き込みが許可されるということである。<span class="emphasis"><em>guest ok</em></span>
	パラメータは、(別途定義された) デフォルトのゲストユーザとしてアクセスが許可されていることを意味する:
</p><pre class="programlisting">
	<em class="parameter"><code>[aprinter]</code></em>
	<a class="link" href="smb.conf.5.html#PATH" target="_top">path = /usr/spool/public</a>
	<a class="link" href="smb.conf.5.html#READONLY" target="_top">read only = yes</a>
	<a class="link" href="smb.conf.5.html#PRINTABLE" target="_top">printable = yes</a>
	<a class="link" href="smb.conf.5.html#GUESTOK" target="_top">guest ok = yes</a>
</pre><p>
	</p></div><div class="refsect1" title="特殊なセクション"><a name="id2490954"/><h2>特殊なセクション</h2><div class="refsect2" title="[global] セクション"><a name="id2490959"/><h3>[global] セクション</h3><p>このセクション中のパラメータは、サーバ全体に対して、
		もしくは各セクションで項目が定義していないときの既定値として
		適用される。詳細な情報はパラメータ(PARAMETERS)の節を参照のこと。</p></div><div class="refsect2" title="[homes] セクション"><a name="HOMESECT"/><h3>[homes] セクション</h3><p> homes セクションが設定ファイル中にあると、
		接続してきたユーザのホームディレクトリを共有するサービスが
		必要時にサーバによって作成されるようになる。</p><p>接続の要求が行なわれると、存在するセクションが検索される。
		要求に合致するセクションが見つかった場合はそのセクションが
		利用される。見つからなかった場合は、
		要求されたセクション名をユーザ名とみなしてローカルのパスワードファイルが検索される。
		ファイル中に名前が存在して、パスワードが適切だった場合、
		[homes] セクションの設定を引き継ぐ形で共有が作成される。
		</p><p>新しく作成される共有に対しては、
		幾つかの変更が行なわれる:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>共有名は、homes からユーザ名に変更される。
		</p></li><li class="listitem"><p>path パラメータが設定されていなかった場合、
		ディレクトリのパスはユーザのホームディレクトリに設定される。
		</p></li></ul></div><p><span class="emphasis"><em>path = </em></span> 行を [homes]
		セクションに記述した場合、"%S" マクロを用いると便利になる
		場合があるかも知れない。以下に一例を示す:</p><p><strong class="userinput"><code>path = /data/pchome/%S</code></strong></p><p>これは、UNIX からのアクセスと PC
		からのアクセスとでホームディレクトリが異なる場合に便利である。
		</p><p> これは多数のクライアントに対するホームディレクトリの
		提供を最小の手間で素早く簡単に実現する方法である。</p><p>要求されたセクション名が <span class="quote">“<span class="quote">homes</span>”</span>
		の場合にも同様の処理が行われるが、共有名が要求したユーザの
		名前に変更されることはない。 [homes] セクションを使用する
		方法は、複数のユーザがクライアント PC を共有する場合に
		便利である。</p><p>[homes] セクションでは、通常のサービスで指定可能な
		すべてのパラメータを指定できるが、幾つかのものは他の
		セクションと少し違った意味になる。以下は典型的な [homes]
		セクションの例である:
</p><pre class="programlisting">
<em class="parameter"><code>[homes]</code></em>
<a class="link" href="smb.conf.5.html#READONLY" target="_top">read only = no</a>
</pre><p>
		</p><p>重要な点として、[homes] セクションでゲストアクセスを許可した場合、
		全てのホームディレクトリが全てのクライアントから
		<span class="emphasis"><em>パスワードなしで</em></span> アクセス可能になるという点が挙げられる。
		ほとんどあり得ないと思うが、もしこの設定を実際に行なうのであれば、<span class="emphasis"><em>読み取り専用</em></span>
		アクセスの設定にしておくことが好ましいであろう。</p><p>自動的に作成されるホームディレクトリの 
		<span class="emphasis"><em>browseable</em></span> パラメータの値は、[homes]
		セクションの browseable パラメータからではなく、[global]
		セクションの browseable パラメータより継承される。これは、
		[homes] セクションで <span class="emphasis"><em>browseable = no</em></span>
		を指定して [homes] 共有を不可視にしても、自動的に作成されるホームディレクトリを表示させるようにするための仕様である。
		</p></div><div class="refsect2" title="[printers] セクション"><a name="PRINTERSSECT"/><h3>[printers] セクション</h3><p>このセクションは、プリンタ用の [homes] セクションに
		相当する。</p><p>[printers] セクションが設定されていると、ユーザは、
		ローカルホストの printcap ファイルで設定されている各プリンタに接続することが可能となる。</p><p>接続の要求が行なわれると、存在するセクションが検索される。
		要求に合致するセクションが見つかった場合はそのセクションが利用される。
		見つからなかった場合、[homes] セクションがあれば前述した処理が行なわれる。
		それでも要求が解決できない場合は、
		要求されたセクション名をプリンタ名とみなし、
		適切な pritcap ファイルが検索され、
		要求されたセクション名をプリンタ共有名とみなすかどうかの
		確認が行なわれる。ファイル中に名前が存在した場合は、
		[printers] セクションの設定を引き継ぐ形でプリンタ共有が
		作成される。</p><p>新しく作成される共有に対しては、
		幾つかの変更が行なわれる:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>共有名には、実際のプリンタ名が設定される。
		</p></li><li class="listitem"><p>プリンタ名が設定されていない場合、
		プリンタ名として実際のプリンタ名が設定される。
		</p></li><li class="listitem"><p> 共有がゲストアクセスを許可しておらず、
		username パラメータも指定されていない場合、username
		に実際のプリンタ名が設定される。</p></li></ul></div><p>[printers] サービスは、必ず printable にすること。
		それ以外の設定を行なうと、サーバが設定ファイルの読み取りを
		拒否してしまう。</p><p>通常指定されるパスは、sticky ビットが設定され、
		誰でも書き込み可能になっているスプールディレクトリである。
		典型的な [printers] のエントリは次のようになる:
</p><pre class="programlisting">
<em class="parameter"><code>[printers]</code></em>
<a class="link" href="smb.conf.5.html#PATH" target="_top">path = /usr/spool/public</a>
<a class="link" href="smb.conf.5.html#GUESTOK" target="_top">guest ok = yes</a>
<a class="link" href="smb.conf.5.html#PRINTABLE" target="_top">printable = yes</a>
</pre><p>
		</p><p> printcap ファイル中で定義されているすべてのプリンタの
		エイリアス(別名)は、プリンタ名として認識される。
		印刷システムが printcap ファイルのような機構を使用して
		いないのであれば、仮の printcap ファイルを設定する必要がある。
		このファイルは以下のような形式の行で構成される:
</p><pre class="programlisting">
alias|alias|alias|alias...    
</pre><p>
		</p><p>各エイリアスは、印刷システムが処理可能なプリンタ名で
		ある必要がある。[global] セクションで、別のファイルを printcap
		ファイルとして指定することで、仮想的な printcap
		ファイル中にある名前のみがサーバに認識される。
		もちろんこのファイル中には任意のエイリアスを記述することが
		可能である。このテクニックは、ローカルプリンタの一部のみに
		アクセスを制限する機能を簡単に実現するためにも利用できる。
		</p><p>なお、エイリアスとは printcap ファイル中の各レコードの
		最初のエントリに続く各要素をさす。
		各レコードは改行コードで区切られ、各要素は (複数個存在する場合)
		縦棒 (<code class="literal">|</code>) で区切られる。</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>lpstat コマンドによりシステムで定義されている
		プリンタの一覧を取得可能な SYSV 系のシステムでは、
		<code class="literal">printcap name = lpstat</code> とすることで、
		プリンタの一覧を取得することが可能である。
		詳細は、<code class="literal">printcap name</code> オプションを参照のこと。
		</p></div></div></div><div class="refsect1" title="ユーザ定義共有"><a name="id2491386"/><h2>ユーザ定義共有</h2><p>Samba 3.0.23 より、root 以外のユーザが共有の追加、修正、削除を行なうことを可能とする機能が追加された。
	この機能を <span class="emphasis"><em>ユーザ定義共有(usershares)</em></span> と呼び、
	smb.conf の <em class="parameter"><code/></em> セクションで定義される一連のパラメータによって制御される。
	関連するパラメータを以下に示す :
	</p><div class="variablelist"><dl><dt><span class="term">usershare allow guests</span></dt><dd><p>ユーザ定義共有でゲストアクセスを許可するかどうかを制御する。</p></dd><dt><span class="term">usershare max shares</span></dt><dd><p>作成を許可するユーザ定義共有の最大数を制御する。</p></dd><dt><span class="term">usershare owner only</span></dt><dd><p>有効にすると、ユーザが所有しているディレクトリのみが共有可能となる。</p></dd><dt><span class="term">usershare path</span></dt><dd><p>ユーザ定義共有を作成可能なディレクトリを指定する。
		実際にユーザ定義共有を作成可能かどうかは、ファイルシステム上のディレクトリのパーミッションに依存する。</p></dd><dt><span class="term">usershare prefix allow list</span></dt><dd><p>共有を許可するディレクトリの絶対パス名をコンマで区切って列挙する。
		ここで指定されたパス名から始まるディレクトリのみが共有を許可される。</p></dd><dt><span class="term">usershare prefix deny list</span></dt><dd><p>共有を拒否するディレクトリの絶対パス名をコンマで区切って列挙する。
		ここで指定されたパス名から始まるディレクトリは共有を拒否される。</p></dd><dt><span class="term">usershare template share</span></dt><dd><p>新しいユーザ定義共有を作成する際のテンプレートとなる既存の共有を指定する。
		ユーザ定義共有の定義時に指定されなかったすべての共有に関するパラメータは、この共有のものが用いられる。</p></dd></dl></div><p>UNIX グループ <code class="literal">foo</code> のメンバにユーザ定義共有の作成を許可したい場合は、
	共有の定義ファイルを格納するディレクトリを以下のように作成する:
	</p><p>root 権限で以下を実施:
</p><pre class="programlisting">
mkdir /usr/local/samba/lib/usershares
chgrp foo /usr/local/samba/lib/usershares
chmod 1770 /usr/local/samba/lib/usershares
</pre><p>
</p><p>ついで、以下のパラメータ
</p><pre class="programlisting">
	<a class="link" href="smb.conf.5.html#USERSHAREPATH" target="_top">usershare path = /usr/local/samba/lib/usershares</a>
	<a class="link" href="smb.conf.5.html#USERSHAREMAXSHARES" target="_top">usershare max shares = 10</a> # (もしくは必要な共有数)
</pre><p> 
	</p><p>
	を <code class="filename">smb.conf</code>の global セクションに追加。
	これにより foo グループのメンバは、以下のコマンドでユーザ定義共有を作成することが可能となる。</p><div class="variablelist"><dl><dt><span class="term">net usershare add sharename path [comment] [acl] [guest_ok=[y|n]]</span></dt><dd><p>これにより、ユーザ定義共有を作成もしくは修正(上書き)する。</p></dd><dt><span class="term">net usershare delete sharename</span></dt><dd><p>ユーザ定義共有を削除する。</p></dd><dt><span class="term">net usershare list wildcard-sharename</span></dt><dd><p>ユーザ定義共有を一覧する。</p></dd><dt><span class="term">net usershare info wildcard-sharename</span></dt><dd><p>ユーザ定義共有の情報を表示する。</p></dd></dl></div></div><div class="refsect1" title="パラメータ"><a name="id2487207"/><h2>パラメータ</h2><p>パラメータはセクションの属性を定義するものである。</p><p>幾つかのパラメータ (<span class="emphasis"><em>security</em></span> など) は、
	[global] セクションで指定する。また幾つかのパラメータ
	(<span class="emphasis"><em>create mask</em></span> など) は、すべてのセクションで
	利用可能である。それ以外のパラメータは、通常のセクションでのみ
	利用できる。以下の説明では、[homes] と [printers] セクションを "通常の"
	セクションとして扱う。(<span class="emphasis"><em>G</em></span>) がついたパラメータは、
	[global] セクションでのみ指定できる。(<span class="emphasis"><em>S</em></span>)
	がついたパラメータは、個々のサービスを表すセクションで指定できる。
	ただし、(<span class="emphasis"><em>S</em></span>) がついたパラメータは、[global]
	セクション中で指定することも可能である。この場合、それらはすべての
	サービスに対するデフォルト値として機能する。</p><p> パラメータはアルファベット順に説明されている。
	最良の順序とはいえないが、少なくとも目的のパラメータを見つけることは
	できるだろう。同義語がある場合は、主として用いるべき表記の部分で
	説明が行なわれ、他はその表記への参照になっている。</p></div><div class="refsect1" title="変数による置換"><a name="id2487279"/><h2>変数による置換</h2><p>設定ファイルに記述可能な文字列の多くには、変数による置換を利用できる。
	たとえば、<span class="quote">“<span class="quote">path = /tmp/%u</span>”</span> は、john というユーザ名でユーザが
	接続すると、<span class="quote">“<span class="quote">path = /tmp/john</span>”</span> として解釈される。</p><p>これら置換の詳細については、各々のパラメータの説明にて
	解説するが、どのパラメータに対しても適用される共通の変数置換もいくつか
	存在する。それらを以下に記載する: </p><div class="variablelist"><dl><dt><span class="term">%U</span></dt><dd><p>セッションのユーザ名 (クライアントが接続時に
		送信したものであるが、実際に接続したユーザ名と同じであるとは
		限らない)。</p></dd><dt><span class="term">%G</span></dt><dd><p>%U のプライマリグループ。</p></dd><dt><span class="term">%h</span></dt><dd><p>Samba が動作しているマシンの
		インターネットホスト名。</p></dd><dt><span class="term">%m</span></dt><dd><p>クライアントマシンの NetBIOS 名 (とても便利)。</p><p>Samba がポート 445 で待機している場合、クライアントがこの情報を送信しないため、この変数は利用できない。
			Samba がドメインコントローラであるドメインで include パラメータにおいてこの変数を用いている場合などは、
			[global] セクションで <em class="parameter"><code>smb ports = 139</code></em> の設定を行なうこと。
			これにより Samba はポート 445 で待機しなくなり、Samba 2.X で実現していた include 機能が利用できる。
			</p></dd><dt><span class="term">%L</span></dt><dd><p>サーバの NetBIOS 名。これを用いることで、
		クライアントから呼ばれた名前に応じて設定を変更することが
		可能となる。これによりサーバは <span class="quote">“<span class="quote">二つの顔</span>”</span>
		を持つことができる。
		</p></dd><dt><span class="term">%M</span></dt><dd><p>クライアントマシンのインターネットホスト名。
		</p></dd><dt><span class="term">%R</span></dt><dd><p>プロトコルのネゴシエーションを経て選択された
		プロトコルレベル。これは CORE、COREPLUS、LANMAN1、LANMAN2、NT1
		のいずれかの値をとる。</p></dd><dt><span class="term">%d</span></dt><dd><p>サーバプロセスのプロセス ID。
		</p></dd><dt><span class="term">%a</span></dt><dd><p>リモートマシンのアーキテクチャ。
		現在認識できるのは
		Samba (<code class="constant">Samba</code>)、 
		Linux の CIFS ファイルシステム (<code class="constant">CIFSFS</code>)、
		OS/2 (<code class="constant">OS2</code>)、
		Windows for Workgroups (<code class="constant">WfWg</code>)、
		Windows 9x/Me (<code class="constant">Win95</code>)、
		Windows NT (<code class="constant">WinNT</code>)、
		Windows 2000 (<code class="constant">Win2K</code>)、
		Windows XP (<code class="constant">WinXP</code>)、
		Windows XP 64-bit(<code class="constant">WinXP64</code>),
		2003R2 (<code class="constant">Win2K3</code>)を含むWindows Server 2003 (<code class="constant">Win2K3</code>)と,
		Windows Vista (<code class="constant">Vista</code>) である。
		それ以外のものは <span class="quote">“<span class="quote">UNKNOWN</span>”</span> となる。</p></dd><dt><span class="term">%I</span></dt><dd><p>クライアントマシンの IP アドレス。</p></dd><dt><span class="term">%i</span></dt><dd><p>クライアントが接続してきたサーバの IP アドレス。</p></dd><dt><span class="term">%T</span></dt><dd><p>現在の日付と時間。</p></dd><dt><span class="term">%D</span></dt><dd><p>現ユーザが所属するドメインかワークグループ名。
		</p></dd><dt><span class="term">%w</span></dt><dd><p>Winbind のセパレータ</p></dd><dt><span class="term">%$(<em class="replaceable"><code>envvar</code></em>)</span></dt><dd><p>環境変数<em class="replaceable"><code>envvar</code></em>の値。
		</p></dd></dl></div><p>以下の置換マクロは (すでに接続が確立されている場合に) いくつかの
	設定オプションに対して有効なものである:</p><div class="variablelist"><dl><dt><span class="term">%S</span></dt><dd><p>現在のサービス名 (存在する場合)。</p></dd><dt><span class="term">%P</span></dt><dd><p>現在のサービスのトップディレクトリ
		(存在する場合)。</p></dd><dt><span class="term">%u</span></dt><dd><p>現在のサービスのユーザ名 (存在する場合)。
		</p></dd><dt><span class="term">%g</span></dt><dd><p>%u のプライマリグループ。</p></dd><dt><span class="term">%H</span></dt><dd><p>%u で指定されたユーザのホームディレクトリ。
		</p></dd><dt><span class="term">%N</span></dt><dd><p>NIS のホームディレクトリサーバの名前。
		これは NIS の auto.map エントリから取得される。Samba が
		<span class="emphasis"><em>--with-automount</em></span> オプションをつけて
		コンパイルされていない場合、このオプションは %L と同じになる。
		</p></dd><dt><span class="term">%p</span></dt><dd><p>NIS auto.map エントリから取得された サーバの
		ホームディレクトリのパス。NIS auto.map エントリは
		<code class="literal">%N:%p</code> のように分割されている。</p></dd></dl></div><p> これらの置換操作とその他の <code class="filename">smb.conf</code> 
	のパラメータを組み合わせると、非常に凝った動作を設定できる。</p></div><div class="refsect1" title="名前の短縮(NAME MANGLING)"><a name="NAMEMANGLINGSECT"/><h2>名前の短縮(NAME MANGLING)</h2><p>Samba は、DOS や Windows クライアントが 8.3 形式に準拠しない
	名前のファイルを扱うことができるように <span class="quote">“<span class="quote">名前の短縮</span>”</span>
	機能を提供している。この機能により、8.3 形式のファイル名についても
	文字の case (大文字、小文字) を調整可能である。</p><p>短縮時の動作を制御するパラメータが幾つか存在しており、
	それらは個々に解説を行なわず、ここでまとめて説明を行なう。
	デフォルト値は testparm コマンドの出力を参照のこと。</p><p>以下のオプションは、すべて共有毎に設定できる
	(もちろん全体に対しても設定できる)。</p><p>オプションは以下の通りである:</p><div class="variablelist"><dl><dt><span class="term">case sensitive = yes/no/auto</span></dt><dd><p>ファイル名の case を識別するかどうかを制御する。
		識別を行なわない場合、Samba は指定された名前に合致する
		ファイル名の有無を検索することが必要になる。デフォルトは
		<span class="emphasis"><em>auto</em></span> であり、ファイル名の case を識別するクライアント(現在のところ Linux CIFSVFS
		や Samba 3.0.5 以降の smbclient) に対しては、case を識別する(UNIX の case を識別する挙動に準拠する) ファイルシステム上の Samba サーバにアクセスしているものとして通知する。
		Windows および DOS システムでは case を識別するファイル名はサポートされておらず、このパラメータを auto に設定した場合、no の設定で動作する。
		デフォルトは <span class="emphasis"><em>auto</em></span> である。
		</p></dd><dt><span class="term">default case = upper/lower</span></dt><dd><p>新しく作成されるファイル(現在ファイルシステム上に存在していないファイル)のファイル名のデフォルトの case を制御する。
		デフォルトは <span class="emphasis"><em>lower</em></span> である。
		重要: 
		<a class="link" href="smb.conf.5.html#CASESENSITIVE" target="_top">case sensitive = yes</a>、 <a class="link" href="smb.conf.5.html#PRESERVECASE" target="_top">preserve case = No</a>、
		<a class="link" href="smb.conf.5.html#SHORTPRESERVECASE" target="_top">short preserve case = No</a>
		の場合、このオプションにより、新しく作られるファイル名だけではなく、クライアントから渡される <span class="emphasis"><em>すべての</em></span> ファイル名の case が変更されることに注意。
		非常に多くのファイルを格納するディレクトリの最適化作業の一貫として、この設定変更が必要となる。
		</p></dd><dt><span class="term">preserve case = yes/no</span></dt><dd><p>新しく作成されるファイル(現在ファイルシステム上に存在していないファイル)のファイル名について、クライアントから
		渡された case で作成するか、<code class="literal">デフォルト</code>の case
		で作成するかを制御する。
		デフォルトは <span class="emphasis"><em>yes</em></span>である。
		</p></dd><dt><span class="term">short preserve case = yes/no</span></dt><dd><p> すべて大文字で適切な長さの 8.3 形式に
		準拠した新しく作成されるファイル(現在ファイルシステム上に存在していないファイル)のファイル名について、大文字で作成するか、
		<code class="literal">デフォルト</code> の case で作成するかを制御する。
		このオプションにより、<code class="literal">preserve case = yes</code>
		で長いファイル名が case を保持する設定の時であっても、
		短いファイル名は小文字で作成するといったことが可能になる。
		デフォルトは <span class="emphasis"><em>yes</em></span> である。
		</p></dd></dl></div><p> Samba 3.0 のデフォルトは、Windows NT のサーバと同様に動作する。
	すなわち、case を識別しないが case は保持する。
	ただし、大量のファイルが存在するディレクトリにおいては、case 関連のパラメータを	
	"case sensitive = yes"、"case preserve = no"、"short preserve case = no" に設定するとよいであろう。
	これにより、"default case" パラメータが有効になり、クライアントから送信されるすべてのファイル名が変更される。
	(訳注: 上記設定は、case sensitive = yes によりファイル名の検索を抑止することで、パフォーマンスを向上させようとする意図だと思われる)
	</p></div><div class="refsect1" title="ユーザ名とパスワード認証についての注意"><a name="VALIDATIONSECT"/><h2>ユーザ名とパスワード認証についての注意</h2><p>ユーザがサービスに接続するための方法は幾つかある。サーバは、
	以下のステップを踏みサービスに対して接続を許可するかどうかを確認する。
	すべてのステップが失敗した場合、接続要求は拒否される。
	いずれかのステップで成功した場合、それ以降のステップは行なわれない。
	</p><p>サービスが <span class="quote">“<span class="quote">guest only = yes</span>”</span> となっており、
	サーバが共有レベルのセキュリティ (<span class="quote">“<span class="quote">security = share</span>”</span>)
	で構成されている場合、ステップ 1 から 5 は省かれる。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>クライアントからユーザ名とパスワードが
		提供されており、それが UNIX システムのパスワード機構によって
		認証された場合、そのユーザ名を使った接続が行なわれる。この
		ステップは <code class="literal">\\server\service%<em class="replaceable"><code>username</code></em></code>
		形式でユーザ名が提供された場合にも行なわれることに注意。
		</p></li><li class="listitem"><p>クライアントからシステムに登録されている
		ユーザ名が提供された場合、そのユーザ名に対する適切な
		パスワードが提供されれば、接続が許可される。</p></li><li class="listitem"><p> クライアントの NetBIOS 名および以前に使われた
		ユーザ名について提供されたパスワードとの確認が行なわれ、
		合致すれば、対応するユーザ名を使った接続が許可される。
		</p></li><li class="listitem"><p>クライアントが既にユーザ名とパスワードを
		提供してサーバに認証されており、その際の認証トークンが
		提示された場合、そのユーザ名が使われる。</p></li><li class="listitem"><p><code class="literal">user = </code> フィールドが
		<code class="filename">smb.conf</code> ファイルで
		該当サービスに対して設定されており、クライアントから提供された
		パスワードが (UNIX システムのパスワード認証により) 
		<code class="literal">user =</code> 行に記述されたユーザ名のいずれかのものと
		合致した場合、接続は、<code class="literal">user = </code> 行で設定された
		ユーザ名で行なわれる。<code class="literal">user = </code> リスト中のユーザ名の
		中に <code class="literal">@</code> ではじまるものがあった場合、それはその名前の
		グループに所属するユーザ名のリストに展開される。
		</p></li><li class="listitem"><p>サービスがゲストサービスの場合、
		提供されたパスワードがなんであっても、そのサービスの
		<code class="literal">guest account =</code> で指定されたユーザ名で接続が
		行なわれる。</p></li></ol></div></div><div class="refsect1" title="レジストリベースの設定方法"><a name="id2488286"/><h2>レジストリベースの設定方法</h2><p>
		Sambaのバージョン 3.2.0 から、レジストリ中にSambaの設定を
		格納する機能が有効になった。Sambaの設定は、レジストリキー
		 <span class="emphasis"><em><code class="literal">HKLM\Software\Samba\smbconf</code></em></span>中に格納される。
		レジストリベースの設定は2つのレベルがある。
	</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>レジストリに共有の定義を格納する。
		これは、<span class="emphasis"><em>smb.conf</em></span>中のグローバル
		パラメータ<em class="parameter"><code>registry shares</code></em>
		を<span class="quote">“<span class="quote">yes</span>”</span>に設定することで利用可能になる。
		</p><p>レジストリ定義の共有はスタートアップ時にはロードされ
		ないが、<span class="emphasis"><em>smbd</em></span>によって、実行時に動的に
		ロードされる。<span class="emphasis"><em>smb.conf</em></span>中の共有定義
		はレジストリ中での同じ名前の共有定義に優先する。</p></li><li class="listitem"><p>グローバルな<span class="emphasis"><em>smb.conf</em></span>
		オプションをレジストリに格納する。これは,以下の2つの異なった
		方法で有効にできる:</p><p>1番めは、<span class="emphasis"><em>smb.conf</em></span>中の
		[global]セクション中の<a class="link" href="smb.conf.5.html#CONFIGBACKEND" target="_top">config backend = registry</a>を設定することで、レジストリのみの
		設定を有効にできる。これは,この時点まで読み込んだ設定ファイ
		ルの内容をすべてリセットし、レジストリからグローバルセク
		ションの内容を読む。これは、レジストリベースの設定方法を使う
		時の推奨方法である。</p><p>2番目は<span class="emphasis"><em>smb.conf</em></span>の[global]
		セクション中の、特別に新しい意味を持つ、<a class="link" href="smb.conf.5.html#INCLUDE" target="_top">include = registry</a>パラメータによって有効にできる
		混成設定方法である。これは,テキストファイルをインクルード
		するのと同じような優先度で、レジストリからグローバルオプ
		ションを読む。これは,初期設定がレジストリにアクセスするのに
		必要な場合に特に有益である。</p><p>グローバルレジストリオプションの有効化は、レジストリ
		ベースの共有が有効になることで自動的に行われる。そのため、
		レジストリのみの場合、共有は要求時にのみロードされる。</p></li></ol></div><p>
		レジストリベースの設定に伴うシステムの破壊を限定的にするために、
		レジストリでの設定中では、<em class="parameter"><code>lock directory</code></em>と
		<em class="parameter"><code>config backend</code></em>の使用は無効化
		されることに注意。
		特に、レジストリでの設定中に、<em class="parameter"><code>lock directory</code></em>を
		変更してしまい、それがいったん有効化されてしまうと、
		デーモンからはそれの設定自体が見えなくなる、壊れた設定を作成することになる。</p><p>
		レジストリベースの設定は、キー<span class="emphasis"><em><code class="literal">HKLM\Software\Samba\smbconf</code></em></span>を
		 <span class="emphasis"><em>regedit</em></span>や<span class="emphasis"><em>net (rpc)
		registry</em></span>を使ってアクセスすることもできる。
		利便性のため、<a class="citerefentry" href="net.8.html"><span class="citerefentry"><span class="refentrytitle">net</span>(8)</span></a>ユーティリティ
		の<span class="emphasis"><em>conf</em></span>サブコマンドが、レジストリ
		ベースの設定をローカルに読み書きするための特別なインタフェース
		として提供されている。すなわち、データベースファイルに直接
		アクセスし、サーバを迂回できる。
	</p></div><div class="refsect1" title="各パラメータの説明"><a name="id2539600"/><h2>各パラメータの説明</h2><span style="color: red">&lt;xi:include&gt;&lt;/xi:include&gt;</span></div><div class="refsect1" title="注意"><a name="id2539614"/><h2>注意</h2><p>設定ファイルでは、スペースを含むサービス名も利用できるが、
	クライアント側のソフトウェアで禁止されているかもしれない。
	文字列比較を行なう際にスペースは常に無視されるため、
	問題は発生しないはずであるが、可能性は考慮しておく必要がある。
	</p><p>同様の注意事項として、多くのクライアント、特に DOS
	クライアントでは、サービス名が最長8文字に制限されている。
	<a class="citerefentry" href="smbd.8.html"><span class="citerefentry"><span class="refentrytitle">smbd</span>(8)</span></a> にはそのような制限はなく、
	こうしたクライアントからの接続要求は、サービス名が切り捨てられてしまう
	ために失敗することになる。このため、サービス名の長さは、最大 8
	文字に制限すべきである。</p><p> <code class="literal">[homes]</code> および <code class="literal">[printers]</code> という特殊セクションにより、
	管理者の負担を軽減することができるが、デフォルトの設定の組合せ方に
	よっては、予期しない設定が行なわれる可能性もある。これらのセクションの
	設定を行なう際には、特に注意深く行なうこと。特にスプールディレクトリの
	パーミッションが適切であることを確認しておくこと。</p></div><div class="refsect1" title="バージョン"><a name="id2539682"/><h2>バージョン</h2><p>このマニュアルページは Samba 3.0 対応のものである。</p></div><div class="refsect1" title="関連項目"><a name="id2539693"/><h2>関連項目</h2><p>
	<a class="citerefentry" href="samba.7.html"><span class="citerefentry"><span class="refentrytitle">samba</span>(7)</span></a>, <a class="citerefentry" href="smbpasswd.8.html"><span class="citerefentry"><span class="refentrytitle">smbpasswd</span>(8)</span></a>, <a class="citerefentry" href="swat.8.html"><span class="citerefentry"><span class="refentrytitle">swat</span>(8)</span></a>, <a class="citerefentry" href="smbd.8.html"><span class="citerefentry"><span class="refentrytitle">smbd</span>(8)</span></a>, <a class="citerefentry" href="nmbd.8.html"><span class="citerefentry"><span class="refentrytitle">nmbd</span>(8)</span></a>, <a class="citerefentry" href="smbclient.1.html"><span class="citerefentry"><span class="refentrytitle">smbclient</span>(1)</span></a>, <a class="citerefentry" href="nmblookup.1.html"><span class="citerefentry"><span class="refentrytitle">nmblookup</span>(1)</span></a>, <a class="citerefentry" href="testparm.1.html"><span class="citerefentry"><span class="refentrytitle">testparm</span>(1)</span></a>, <a class="citerefentry" href="testprns.1.html"><span class="citerefentry"><span class="refentrytitle">testprns</span>(1)</span></a></p></div><div class="refsect1" title="著者"><a name="id2539768"/><h2>著者</h2><p>オリジナルの Samba ソフトウェアと関連するユーティリティは、
	Andrew Tridgell によって作成された。現在 Samba は Samba Team によって、
	Linux カーネルの開発と同様のオープンソースプロジェクトとして開発が
	行なわれている。</p><p>オリジナルの Samba マニュアルページは Karl Auer によって
	作成された。マニュアルページは YODL 形式 
	(<a class="ulink" href="ftp://ftp.icce.rug.nl/pub/unix/" target="_top">
	ftp://ftp.icce.rug.nl/pub/unix/</a>	で入手可能な優れた
	オープンソースソフトウェア) に変換され、Samba 2.0 リリースに伴い、
	Jeremy Allison によって更新された。Samba 2.2 における DocBook
	形式への変換は、Gerald Carter によって行なわれた。Samba 3.0 における
	DocBook XML 4.2 形式への変換は Alexander Bokovoy によって行われた。
	</p></div><div class="refsect1" title="日本語訳"><a name="id2539807"/><h2>日本語訳</h2><p>このマニュアルページは Samba 3.5.4 対応のものである。</p><p>Samba 3.0.23d 対応の翻訳は、たかはしもとのぶ (monyo@samba.gr.jp) によって行なわれた。</p><p>Samba 3.2.4-3.5.4 対応の翻訳は、
	  </p><div class="itemizedlist"><p>たかはしもとのぶ</p><p>堀田 倫英 </p><p>太田俊哉 (ribbon@samba.gr.jp)</p><p>山田 史朗</p><p>武田保真</p><p>海老澤</p><ul class="itemizedlist" type="disc"/></div><p>
	によって行なわれた。</p></div></div></body></html>
