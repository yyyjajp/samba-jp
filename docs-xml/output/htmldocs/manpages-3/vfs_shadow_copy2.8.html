<?xml version="1.0" encoding="UTF-8"?>
<html><head><title>vfs_shadow_copy2</title><link rel="stylesheet" href="../samba.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry" title="vfs_shadow_copy2"><a name="vfs_shadow_copy2.8"/><div class="titlepage"/><div class="refnamediv"><h2>Name</h2><p>vfs_shadow_copy2 — Windows クライアントに対して、スナップショットを
    シャドウコピーとして見せる。 </p></div><div class="refsynopsisdiv" title="Synopsis"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="literal">vfs objects = shadow_copy2</code></p></div></div><div class="refsect1" title="説明"><a name="id2529796"/><h2>説明</h2><p>この VFS モジュールは
	<a class="citerefentry" href="samba.7.html"><span class="citerefentry"><span class="refentrytitle">samba</span>(7)</span></a> システムの一部である。</p><p><code class="literal">vfs_shadow_copy2</code> VFS モジュールは
    Microsoft のシャドウコピーサービスと似た機能を提供する。
    適切に設定されると、このモジュールにより Microsoft
    シャドウコピークライアントから Samba の共有上にある "シャドウコピー"
    を参照できるようになる。
    </p><p>これはシャドウコピーの第２版となるモジュールである。
    このバージョンでは以下の機能を持つ：</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>あなたの共有をシンボリックリンクを使って
        スナップショットに向ける必要がない。これは数千個の共有があったり 
        [homes] を使ったりする場合にとても重要なことである。
	    </p></li><li class="listitem"><p>それぞれのファイルの inode 番号は変更され、
        オリジナルのものとは異なる。これにより「リストア」ボタンを
        押した際に共有が壊れたりすることがなくなる。
	   </p></li></ol></div><p>このモジュールはスタック可能である。</p></div><div class="refsect1" title="設定"><a name="id2490558"/><h2>設定</h2><p><code class="literal">vfs_shadow_copy2</code>は、ファイルシステムが
    スナップショットを実装していることを前提にしている。
    一般的なファイルシステムの多くが標準でこれをサポートしている。
	</p><p><code class="literal">vfs_shadow_copy2</code>が認識できるように、
    ファイルシステムのスナップショットが特定の名称のディレクトリにマウント
    されている必要がある。スナップショットのマウントポイントは
    共有ディレクトリの直下でなければならない。</p><p>スナップショットの名前形式は @GMT-YYYY.MM.DD-hh.mm.ss となる。
    それぞれ
	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="literal">YYYY</code>は4桁の年</p></li><li class="listitem"><p><code class="literal">MM</code>は2桁の月</p></li><li class="listitem"><p><code class="literal">DD</code>は2桁の日</p></li><li class="listitem"><p><code class="literal">hh</code>は2桁の時</p></li><li class="listitem"><p><code class="literal">mm</code>&gt;は2桁の分</p></li><li class="listitem"><p><code class="literal">ss</code>&gt;は2桁の秒</p></li></ul></div><p>
    で指定する。
	</p><p><code class="literal">vfs_shadow_copy2</code>のスナップショットの名前形式は、
    以下の<a class="citerefentry" href="date.1.html"><span class="citerefentry"><span class="refentrytitle">date</span>(1)</span></a>コマンドで生成できる：
	</p><pre class="programlisting">
	TZ=GMT date +@GMT-%Y.%m.%d-%H.%M.%S
	</pre></div><div class="refsect1" title="オプション"><a name="id2490674"/><h2>オプション</h2><div class="variablelist"><dl><dt><span class="term">shadow:snapdir = SNAPDIR
        </span></dt><dd><p>スナップショットがあるディレクトリへのパス。
        </p></dd><dt><span class="term">shadow:basedir = BASEDIR
		</span></dt><dd><p>スナップショットが参照するベースディレクトリへのパス。
        </p></dd><dt><span class="term">shadow:fixinodes = yes/no
        </span></dt><dd><p><code class="literal">shadow:fixinodes</code>
        が有効の場合、このモジュールはスナップショット中のそれぞれの
        ファイルの見かけの inode 番号を、そのファイルのパスのハッシュ値で
        修正する。これは（たとえば GPFS のスナップショットのように）
        スナップショットがオリジナルのファイルと同じデバイス名＋ inode
        番号を持つ場合に必要となる。（訳注：そのようなシステムにおいて）
        このオプションを設定しないでシャドウコピー UI の「リストア」
        ボタンを押すと、共有違反で失敗してしまう。
        </p></dd></dl></div></div><div class="refsect1" title="設定例"><a name="id2490754"/><h2>設定例</h2><p>ユーザーのホームディレクトリでシャドウコピーをサポートするには
    以下の設定を行なう：</p><pre class="programlisting">
    <em class="parameter"><code>[homes]</code></em>
	<a class="link" href="smb.conf.5.html#VFSOBJECTS" target="_top">vfs objects = shadow_copy2</a>
	<a class="link" href="smb.conf.5.html#SHADOW:SNAPDIR" target="_top">shadow:snapdir = /data/snaphots</a>
	<a class="link" href="smb.conf.5.html#SHADOW:BASEDIR" target="_top">shadow:basedir = /data/home</a>
</pre></div><div class="refsect1" title="警告"><a name="id2490910"/><h2>警告</h2><p>これはバックアップでも、アーカイブでも、バージョン管理のための
    機能でもないことに注意。</p><p>Samba と Windows の双方において、<code class="literal">vfs_shadow_copy2</code>
    はエンドユーザのための機能として設計されている。これはバックアップや
    アーカイ機能を代替、もしくは拡張するものではないので、そのような認識
    は禁物である。バージョン管理機能が必要であれば、バージョン管理機能を
    実装する必要がある。</p></div><div class="refsect1" title="バージョン"><a name="id2490943"/><h2>バージョン</h2><p>このマニュアルページは Samba システムのバージョン3.2.7(訳注:3.x?) に適合する。
	</p></div><div class="refsect1" title="著者"><a name="id2490955"/><h2>著者</h2><p>オリジナルの Samba ソフトウェアと関連するユーティリティは、Andrew
    Tridgell によって作成された。現在 Samba は Samba Team に
    よって、Linuxカーネルの開発と同様にオープンソースプロジェクト
    として開発が行なわれている。</p></div><div class="refsect1" title="日本語訳"><a name="id2490975"/><h2>日本語訳</h2><p>このマニュアルページは Samba 3.2.7 - 3.4.7 対応のものである。</p><p>このドキュメントの Samba 3.2.4 - 3.4.7 対応の翻訳は
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>堀田 倫英(hotta@net-newbie.com)</p></li></ul></div><p>
        によって行なわれた。</p></div></div></body></html>
