<?xml version="1.0" encoding="UTF-8"?>
<html><head><title>smbpasswd</title><link rel="stylesheet" href="../samba.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry" title="smbpasswd"><a name="smbpasswd.5"/><div class="titlepage"/><div class="refnamediv"><h2>Name</h2><p>smbpasswd — Samba の暗号化パスワードファイル</p></div><div class="refsynopsisdiv" title="Synopsis"><h2>Synopsis</h2><p><code class="filename">smbpasswd</code></p></div><div class="refsect1" title="説明"><a name="id2528772"/><h2>説明</h2><p>このファイルは<a class="citerefentry" href="Samba.7.html"><span class="citerefentry"><span class="refentrytitle">Samba</span>(7)</span></a>システムの一部である。</p><p>smbpasswd は Samba の暗号化パスワードファイルである。
	このファイルには、ユーザ名、UNIX のユーザ ID、ユーザの SMB
	ハッシュ化パスワード、さらにアカウントのフラグ情報とパスワードの
	最終変更時間が含まれている。このファイルの形式は Samba とともに
	拡張されており、以前のバージョンとは幾分異なった形式になっている。
	</p></div><div class="refsect1" title="ファイル形式"><a name="id2528804"/><h2>ファイル形式</h2><p>Samba 2.2 における smbpasswd ファイルの形式は、一般的な UNIX の
	<code class="filename">passwd(5)</code> ファイルに類似している。
	これは、各ユーザの情報が行ごとに格納された ASCII ファイルである。
	各行のそれぞれのフィールドは、コロン (:) で区切られている。
	'#' で始まる行は無視される。
	smbpasswd ファイルには、各ユーザごとに以下の情報が含まれている: </p><div class="variablelist"><dl><dt><span class="term">name</span></dt><dd><p>ユーザの名前である。この名前は、標準の UNIX
		passwd ファイルに存在している必要がある。</p></dd><dt><span class="term">uid</span></dt><dd><p>UNIX の uid である。この値は、標準の UNIX
		passwd ファイル内の同名ユーザが持つ uid フィールドの値と
		一致しなければならない。 一致していないと、Samba は smbpasswd
		ファイルのエントリを有効なユーザのエントリとして認識しない。
		</p></dd><dt><span class="term">Lanman パスワードハッシュ</span></dt><dd><p> これは、ユーザのパスワードから生成された
		LANMANハッシュであり、32 桁の 16 進数でエンコードされている。
		LANMANハッシュは、ユーザのパスワードをキーとして用いて、
		ある一定の文字列を DES で暗号化することで生成される。これは、
		Windows 95/98 マシンで利用されるパスワードと同じである。
		このパスワードハッシュは辞書攻撃に弱いとみなされていて、
		もし二人のユーザが同じパスワードを持つ場合、このエントリも
		同一のものになってしまう (UNIX パスワードのようにパスワードが
		"加工 (salted)" されていない)。
		ユーザが null パスワードを持つ場合、このフィールドの先頭の 16
		進数文字列の部分に "NO PASSWORD" という文字が入る。
		16 進数文字列が 32 個の 'X' 文字からなる場合、
		このユーザアカウントは<code class="constant">無効</code>であると見なされ、ユーザは Samba
		サーバにログオンすることができない。</p><p><span class="emphasis"><em>警告!!</em></span>
		SMB/CIFS の認証プロトコルはチャレンジ/レスポンス方式で
		あるため、パスワードハッシュさえ知っていれば、 
		誰でもネットワーク上でそのユーザになりすますことができる。
		このため、これらのハッシュは
		<span class="emphasis"><em>暗号化されていないテキスト</em></span>
		と同等のものであり、root 以外には <span class="emphasis"><em>絶対に</em></span>
		漏らしてはならない。これらのパスワードを保護するため、
		smbpasswd ファイルは、root だけが読みとりや実行アクセス可能な
		ディレクトリに置き、ファイル自身は root だけに読み書き
		アクセス権を与えるべきである。</p></dd><dt><span class="term">NT パスワードハッシュ</span></dt><dd><p> これは、ユーザのパスワードから生成された
		Windows NT ハッシュであり、 32 桁の 16 進数でエンコードされて
		いる。Windows NT ハッシュは、ユーザのパスワードを 16
		ビット/リトルエディアンの UNICODE で表現したものに対し、MD4
		ハッシュアルゴリズム (RFC1321を参照) を適用することで
		生成される。</p><p>このパスワードハッシュは パスワードの大文字/小文字の
		情報を保持しており、よりセキュアなハッシュアルゴリズムを
		使用するため、LANMAN ハッシュより非常にセキュアであると
		考えられる。しかし、やはり同じパスワードを持つユーザが
		二人いる場合、このエントリも同一のものになってしまう (UNIX
		パスワードのようにパスワードが "加工(salted)" されていない)。
		</p><p><span class="emphasis"><em>警告!!</em></span>
		SMB/CIFS の認証プロトコルはチャレンジ/レスポンス方式で
		あるため、パスワードハッシュさえ知っていれば、 
		誰でもネットワーク上でそのユーザになりすますことができる。
		このため、これらのハッシュは
		<span class="emphasis"><em>暗号化されていないテキスト</em></span>
		と同等のものであり、root 以外には <span class="emphasis"><em>絶対に</em></span>
		漏らしてはならない。これらのパスワードを保護するため、
		smbpasswd ファイルは、root だけが読みとりや実行アクセス可能な
		ディレクトリに置き、ファイル自身は root だけに読み書き
		アクセス権を与えるべきである。</p></dd><dt><span class="term">Account Flags</span></dt><dd><p> これは、ユーザアカウントの属性を表すフラグで
		ある。このフィールドはブラケット '[' と ']' で囲まれており、長さは常に 13 文字
		になる ('[' と ']'も含む)。このフィールドの中には、以下のような文字が入る:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><em>U</em></span> - "User"
			アカウント、つまり一般のユーザを意味する。</p></li><li class="listitem"><p><span class="emphasis"><em>N</em></span> -
			アカウントがパスワードを持っていないことを意味する
			（LANMAN ハッシュと NT ハッシュのフィールドにある
			パスワード情報は無視される)。このフラグによって、
			<a class="citerefentry" href="smb.conf.5.html"><span class="citerefentry"><span class="refentrytitle">smb.conf</span>(5)</span></a> ファイル中の
			<em class="parameter"><code>null passwords</code></em> パラメータが
			設定されていている場合にのみ、ユーザはパスワードなしで
			ログインできるようになる。</p></li><li class="listitem"><p><span class="emphasis"><em>D</em></span> - 
			アカウントが無効であることを意味し、このユーザは
			SMB/CIFS ログオンが許可されない。</p></li><li class="listitem"><p><span class="emphasis"><em>X</em></span> - これは、パスワードが
			満了していないことを意味する。</p></li><li class="listitem"><p><span class="emphasis"><em>W</em></span> - アカウントが
			"Workstation Trust" アカウントであることを意味する。
			このアカウントは、Samba の PDC 機能で、Windows NT
			Workstation や Server を Samba PDC によるドメインに
			参加させるために利用される。</p></li></ul></div><p> 将来的にコードが拡張されれば、そのほかのフラグが
		追加されるかもしれない。このフィールドの残った部分は空白文字で
		埋められている。この場所でサポートされているフラグに関してさらなる情報は、
		<code class="literal">pdbedit</code>マニュアルページを参照して欲しい。</p></dd><dt><span class="term">Last Change Time</span></dt><dd><p>このフィールドには、アカウントが更新された
		最終時間を保持する。このフィールドには文字列 'LCT-'
		("Last Change Time" を意味する) に続けて、最後に更新が行われた
		UNIX 時間 (西暦 1970 年からの経過秒数) を数字で表した文字列が
		続く。</p></dd></dl></div><p>コロンで区切られた他のフィールドは、 現在すべて無視される。</p></div><div class="refsect1" title="バージョン"><a name="id2487324"/><h2>バージョン</h2><p>このマニュアルページは Samba 3 対応のものである。</p></div><div class="refsect1" title="関連項目"><a name="id2487335"/><h2>関連項目</h2><p><a class="citerefentry" href="smbpasswd.8.html"><span class="citerefentry"><span class="refentrytitle">smbpasswd</span>(8)</span></a>, <a class="citerefentry" href="Samba.7.html"><span class="citerefentry"><span class="refentrytitle">Samba</span>(7)</span></a>, および RFC1321
	(MD4アルゴリズムの詳細)
	</p></div><div class="refsect1" title="著者"><a name="id2487362"/><h2>著者</h2><p>オリジナルの Samba ソフトウェアと関連するユーティリティは、
	Andrew Tridgell によって作成された。現在 Samba は Samba Team
	によって、Linux カーネルの開発と同様の オープンソースプロジェクトと
	して開発が行なわれている。</p><p>オリジナルの Samba マニュアルページは Karl Auer によって
	作成された。マニュアルページは YODL 形式
	(<a class="ulink" href="ftp://ftp.icce.rug.nl/pub/unix/" target="_top">
	ftp://ftp.icce.rug.nl/pub/unix/</a> で入手可能な優れた
	オープンソースソフトウェア) に変換され、Samba 2.0 リリースに伴い、
	Jeremy Allison によって更新された。Samba 2.2 における DocBook
	形式への変換は、Gerald Carter によって行なわれた。Samba 3.0 における
	DocBook XML 4.2 形式への変換は Alexander Bokovoy によって行われた。
	</p></div><div class="refsect1" title="日本語訳"><a name="id2487401"/><h2>日本語訳</h2><p>このマニュアルページは Samba 3.2.4 - 3.5.6 対応のものである。</p><p>このドキュメントの Samba 3.0.0 対応の翻訳は、
	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>高橋 基信 (monyo@samba.gr.jp)</p></li><li class="listitem"><p>はせがわ ようすけ</p></li><li class="listitem"><p>山田 史朗 (shiro@miraclelinux.com)</p></li></ul></div><p>
によって行なわれた。</p><p>このドキュメントの Samba 3.2.4 - 3.5.6 対応の翻訳は、太田俊哉(ribbon@samba.gr.jp)によって行なわれた。</p></div></div></body></html>
