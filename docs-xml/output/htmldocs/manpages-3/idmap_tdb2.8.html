<?xml version="1.0" encoding="UTF-8"?>
<html><head><title>idmap_tdb2</title><link rel="stylesheet" href="../samba.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="refentry" title="idmap_tdb2"><a name="idmap_tdb2.8"/><div class="titlepage"/><div class="refnamediv"><h2>Name</h2><p>idmap_tdb2 — Samba の Winbind 用 idmap_tdb2 バックエンド</p></div><div class="refsynopsisdiv" title="説明"><h2>説明</h2><p>
    idmap_tdb2 プラグインはデフォルトの idmap_tdb バックエンドの代替と
    なるもので、Samba と CTDB におけるクラスタ環境において winbindd が
    SID/uid/gid の対応表を格納するのに使われる。
	</p><p>
    idmap_rid のようなバックエンドはリードオンリーであるが、これは
    割り当て機能を持つバックエンドだと言える。つまり、新しいマッピング
    を生成するために、新しいユーザやグループの ID を割り当てる必要が
    あるということである。(割り当てを受け持つ)アロケータを idmap_tdb2
    バックエンド自身が担当することもできるし、idmap_tdb や idmap_ldap
    といった他のバックエンドにその処理を依頼することもできる。この機能は
    <em class="parameter"><code>idmap alloc backend</code></em> パラメータにより有効となる。
	</p><p>
    注意：この(もしくは他のアロケータとなりうる)バックエンドで本機能が
    動作するためには、デフォルトのバックエンドが書き込み可能でなければ
    ならない。uid と gid の割り当てに使われる範囲は、"idmap uid"
    と "idmap gid" で構成されるデフォルトの範囲が使われる。
	</p><p>
    さらに、書き込み可能な idmap バックエンドを使うすべてのドメインの
    ために、割り当てを実行できる唯一のグローバルなバックエンドがあるので、
    明示的に tdb2 の idmap バックエンドで構成されたドメインは、
    同じ範囲をデフォルトの範囲として持つべきである。つまり、グローバルの
    uid / gid アロケータを使用する必要がある。以下の例を見て欲しい。
	</p></div><div class="refsect1" title="IDMAP オプション"><a name="id2489184"/><h2>IDMAP オプション</h2><div class="variablelist"><dl><dt><span class="term">range = low - high</span></dt><dd><p>
            バックエンドが割り当て権限を持っていて、かつ利用可能な uid と gid
            の範囲を定義する。このパラメータが指定されない場合 winbind は
            フェイルオーバーして、smb.conf の "idmap uid" と
             "idmap gid" オプションを使う。
		</p></dd></dl></div></div><div class="refsect1" title="IDMAP スクリプト"><a name="id2489216"/><h2>IDMAP スクリプト</h2><p>
    tdb2 idmap バックエンドは、id のマッピングをスクリプトで実行するための
    smb.conf の <em class="parameter"><code>idmap : script</code></em> オプションをサポート
    している。このスクリプトは、以下のコマンドラインオプションを受け付ける
    ようになっていなければならない。
	</p><pre class="programlisting">
	SIDTOID S-1-xxxx
	IDTOSID UID xxxx
	IDTOSID GID xxxx
	</pre><p>
    またそのスクリプトは、以下のいずれかのレスポンスを１行で返すように
    なっている必要がある。
	</p><pre class="programlisting">
	UID:yyyy
	GID:yyyy
	SID:yyyy
	ERR:yyyy
	</pre><p>
    注意：SID を UNIX の ID マッピングに対して渡すにあたり、このスクリプトは
    SID の全範囲をカバーするべきである。そうでないと、スクリプトではカバー
    されていない SID が、すでにスクリプトで割り当て済みの ID に割り当てられる
    恐れがある。 
	</p></div><div class="refsect1" title="設定例"><a name="id2489387"/><h2>設定例</h2><p>
    tdb2 がどのようにデフォルトの imapd バックエンドとして使われるかという
    例を以下に示す。全ドメインについて適用されるグローバルオプションで idmap
    の範囲を設定していることがわかる。これと同じ範囲が uid/gid の割り当て
    の際に使われる。
	</p><pre class="programlisting">
	[global]
	idmap backend = tdb2
	idmap uid = 1000000-2000000
	idmap gid = 1000000-2000000
	</pre></div><div class="refsect1" title="著者"><a name="id2489415"/><h2>著者</h2><p>
    オリジナルの Samba ソフトウェアと関連ユーティリティは、Andrew Tridgell
    により書かれた。Samba は現在 Samba チームの元で、Linux のカーネルと
    同様にオープンソースソフトウェアとして開発されている。
	</p></div><div class="refsect1" title="日本語訳"><a name="id2489434"/><h2>日本語訳</h2><p>このマニュアルページは Samba 3.3.6-3.4.11 対応のものである。</p><p>このドキュメントの翻訳は
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>堀田 倫英(hotta@net-newbie.com)</p></li></ul></div><p>
        によって行なわれた。</p></div></div></body></html>
