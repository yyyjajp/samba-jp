<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<chapter id="rights">
<chapterinfo>
        &author.jerry;
        &author.jht;
</chapterinfo>

<title>User Rights and Privileges</title>

<para>
<indexterm><primary>Windowsのユーザ</primary></indexterm>
<indexterm><primary>Windowsのグループ</primary></indexterm>
<indexterm><primary>マシンアカウント</primary></indexterm>
<indexterm><primary>ADS</primary></indexterm>
Sambaがドメインを制御しているネットワーク中で、Windowsのユーザ、グループとマシン
アカウントを管理するには、Microsoft Windowsネットワーク環境とUNIX OS環境の間で
インタフェースを取る必要がある。Windows セキュリティドメインにマシンを追加するための
権利(許可)は、Windows NT4ドメインとActive Directoryドメインの両方で、非管理者ユーザに
割り当て(設定)することができる。
</para>

<para>
<indexterm><primary>Windows NT4/2kX/XPPro</primary></indexterm>
<indexterm><primary>マシンアカウント</primary></indexterm>
<indexterm><primary>trusted</primary></indexterm>
<indexterm><primary>ユーザのログオン</primary></indexterm>
ドメインへWindows NT4/2kX/XPProましんを追加するには、追加されるマシンごとにマシン
アカウントを作成する必要がある。マシンアカウントは、ユーザのログオンを許可する
ために信頼できるマシンを検証するために使うのに必要である。
</para>

<para>
<indexterm><primary>ユーザアカウント</primary></indexterm>
<indexterm><primary>特別なアカウント</primary></indexterm>
<indexterm><primary>アカウント名</primary></indexterm>
<indexterm><primary>/bin/false</primary></indexterm>
<indexterm><primary>/dev/null</primary></indexterm>
<indexterm><primary>man-in-the-middle</primary></indexterm>
マシンアカウントはユーザアカウントに類似していて、そのため、Sambaをホスティングしている
UNIXマシンでの実装では(すなわちSambaが動いているマシン)、ユーザアカウントの特別なタイプ
として作成する必要がある。マシンアカウントは、通常のユーザアカウントと比べて、
アカウント名(ログインID)が<literal>$</literal>記号で終わっているところが異なる。
更に、このタイプのアカウントは、システムユーザとしてUNIX環境に決してログイン出来ない
ことと、ログインシェルが<command>/bin/false</command>に設定されていることと、ホーム
ディレクトリが<command>/dev/null</command>に設定されていることも違う。マシンアカウントは
起動時にドメインメンバのマシンであることを検証するためのみに使われる。このセキュリティ
対応は、ネットワークの完全性を破る中間者攻撃をブロックするために設計されている。
</para>

<note><para>
<indexterm><primary>コンピュータアカウント</primary></indexterm>
<indexterm><primary>ドメインメンバサーバ</primary></indexterm>
<indexterm><primary>ドメインコントローラ</primary></indexterm>
<indexterm><primary>credentials</primary></indexterm>
<indexterm><primary>安全な認証</primary></indexterm>
マシン(コンピュータ)アカウントは、ドメインメンバサーバとワークステーションのための
セキュリティ証明書(credentials)を格納するために、Windows NT OSファミリで使われる。
ドメインメンバの起動時、ドメインコントローラと証明書の交換を含む検証プロセスを
行う。もしもドメインコントローラが保持している証明書を使っての認証に失敗した
場合、マシンはドメインユーザからのアクセスが出来なくなる。コンピュータアカウント
は、Microsoft Windowsのセキュアな認証方法において必須のものである。
</para></note>

<para>
<indexterm><primary>UNIXシステムアカウント</primary></indexterm>
<indexterm><primary>システム管理者</primary></indexterm>
<indexterm><primary>root</primary></indexterm>
<indexterm><primary>UID</primary></indexterm>
UNIXシステムアカウントの作成は、<constant>root</constant>アカウントと言う方が通りがよい、
システム管理者の伝統的な唯一の権利であった。UNIX環境では、同じUIDを持つ複数のユーザを
作ることが可能である。UID=0のUNIXユーザはだれでも<constant>root</constant>アカウント
ユーザと本質的に同じである。
</para>

<para>
<indexterm><primary>システムインタフェーススクリプト</primary></indexterm>
<indexterm><primary>CIFS機能呼び出し</primary></indexterm>
<indexterm><primary>rootアカウント</primary></indexterm>
<indexterm><primary>UNIXホストシステム</primary></indexterm>
すべてのバージョンのSambaは、UNIX環境で、ユーザ、グループとマシンアカウントを管理する
ためのCIFS機能呼び出しを許可するシステムインタフェーススクリプトを呼び出す。3.0.10
を含むそれまでのすべてのバージョンのSambaは、それらのインタフェーススクリプトを
実行するために、明確にUNIXの<constant>root</constant>アカウントにマップされる
Windows管理者アカウントを使用することを要求する。こうする必要性は、無理もない話だが、
特に、UNIXホストシステムでconstant>root</constant>レベルのアクセスを行ってはならない
人が特権を得てしまう事について、Samba管理者の間では評判が悪い。
</para>

<sect1>
<title>権利の管理能力</title>

<para>
<indexterm><primary>Windowsの権限モデル</primary></indexterm>
<indexterm><primary>権限モデル</primary></indexterm>
<indexterm><primary>割り当てられた権利</primary></indexterm>
<indexterm><primary>SID</primary></indexterm>
Samba 3.0.11から、Windowsの権限モデルのサポートが導入された。このモデルは、特定の
権利をユーザかグループSIDに割り当てるというものである。この機能を有効にするため、
&smb.conf;ファイル中の<smbconfsection name="global"/>セクション中で、
<smbconfoption name="enable privileges">yes</smbconfoption>を定義しなければならない。
</para>

<para>
<indexterm><primary>権利</primary></indexterm>
<indexterm><primary>権限</primary></indexterm>
<indexterm><primary>権限の管理</primary></indexterm>
現在、Samba-3でサポートされている権利は<link linkend="rp-privs"/>に一覧がある。
この章の残りでは、Sambaサーバ上でどのように権限を管理し使うかについて説明する。
</para>

<indexterm><primary>SeMachineAccountPrivilege</primary></indexterm>
<indexterm><primary>SePrintOperatorPrivilege</primary></indexterm>
<indexterm><primary>SeAddUsersPrivilege</primary></indexterm>
<indexterm><primary>SeRemoteShutdownPrivilege</primary></indexterm>
<indexterm><primary>SeDiskOperatorPrivilege</primary></indexterm>
<indexterm><primary>SeTakeOwnershipPrivilege</primary></indexterm>
<table id="rp-privs">
        <title>現在有効な権限の一覧</title>
        <tgroup cols="2">
                <colspec align="right"/>
                <colspec align="left"/>
                <thead>
                        <row>
                                <entry align="left">権限</entry>
                                <entry align="left">説明</entry>
                        </row>
                </thead>
                <tbody>
                        <row>
                                <entry><para>SeMachineAccountPrivilege</para></entry>
                                <entry><para>マシンをドメインに追加する</para></entry>
                        </row>
                        <row>
                                <entry><para>SePrintOperatorPrivilege</para></entry>
                                <entry><para>プリンタの管理</para></entry>
                        </row>
                        <row>
                                <entry><para>SeAddUsersPrivilege</para></entry>
                                <entry><para>ドメインへのユーザとグループの追加</para></entry>
                        </row>
                        <row>
                                <entry><para>SeRemoteShutdownPrivilege</para></entry>
                                <entry><para>リモートシステムの強制シャットダウン</para></entry>
                        </row>
                        <row>
                                <entry><para>SeDiskOperatorPrivilege</para></entry>
                                <entry><para>ディスク共有の管理</para></entry>
                        </row>
<!-- These are not used at this time - so void them from the docs.
                        <row>
                                <entry><para>SeBackupPrivilege</para></entry>
                                <entry><para>Back up files and directories</para></entry>
                        </row>
                        <row>
                                <entry><para>SeRestorePrivilege</para></entry>
                                <entry><para>Restore files and directories</para></entry>
                        </row>
**** End of commented out section **** -->    
                        <row>
                                <entry><para>SeTakeOwnershipPrivilege</para></entry>
                                <entry><para>ファイルか他のオブジェクトに対する所有権の取得</para></entry>
                        </row>
            </tbody>
        </tgroup>
</table>

<sect2>
<title><quote>net rpc rights</quote>ユーティリティの使用</title>

<para>
<indexterm><primary>権利の管理</primary></indexterm>
<indexterm><primary>割り当てられた権利</primary></indexterm>
<indexterm><primary>ドメインに対するNT4ユーザマネージャ</primary></indexterm>
<indexterm><primary>コマンドラインユーティリティ</primary></indexterm>
<indexterm><primary>管理操作</primary></indexterm>
Sambaサーバ上でユーザとグループに権利を割り当てる管理には2つの主要な手段がある。
<command>止め引用のNT4ユーザマネージャ</command>はSambaドメインコントローラに接続
するためにWindows NT4、2000かXP Professionalのドメインメンバクライアントのどれから
でも使うことが出来、権限の割り当てを表示したり修正できる。しかし、このアプリケーション
は、Windows 2000かそれ以降のクライアント上で動かす時にはバグがある。そのため、管理
操作の実行を行うために必要なコマンドラインユーティリティを提供している。
</para>

<para>
Samba-3.0.11以降の<command>net rpc rights</command>ユーティリティは新しい3つの
サブコマンドを提供している:
</para>

<variablelist>
	<varlistentry><term>list [name|accounts]</term>
		<listitem><para>
<indexterm><primary>net</primary><secondary>rpc</secondary><tertiary>list</tertiary></indexterm>
<indexterm><primary>有効な権利</primary></indexterm>
<indexterm><primary>割り当てられた権限</primary></indexterm>
<indexterm><primary>特権アカウント</primary></indexterm>
		引数なしで起動した場合、<command>net rpc list</command>は単純にサーバ
		上の有効な権利の一覧を表示する。特定のユーザまたはグループを指定した
		場合、ツールは指定されたアカウントに割り当てられている現在の権限を
		表示する。<constant>accounts</constant>という特別な文字列を付けて起動
		した場合、<command>net rpc rights list</command>はサーバ上のすべての
		特権アカウントの一覧とそれに割り当てられた権利を表示する。
		</para></listitem>
	</varlistentry>

	<varlistentry><term>grant &lt;user&gt; &lt;right [right ...]&gt;</term>
		<listitem><para>
<indexterm><primary>権利の割り当て</primary></indexterm>
<indexterm><primary>権利の許可</primary></indexterm>
<indexterm><primary>クライアントマシンの追加</primary></indexterm>
<indexterm><primary>ユーザかグループ</primary></indexterm>
		引数なしで起動すると、この機能は指定されたユーザかグループに一連の
		権利を割り当てるのに使う。例えば、Sambaドメインコントローラ上の
		Domain Admins groupのメンバに、ドメインにクライアントマシンを追加する
		能力を許可するためには、以下のように実行する:
<screen>
&rootprompt; net -S server -U domadmin rpc rights grant \
	 'DOMAIN\Domain Admins' SeMachineAccountPrivilege
</screen>
		以下のような指定も同じ結果となる:
<indexterm><primary>net</primary><secondary>rpc</secondary><tertiary>rights grant</tertiary></indexterm>
<screen>
&rootprompt; net rpc rights grant 'DOMAIN\Domain Admins' \
     SeMachineAccountPrivilege -S server -U domadmin
</screen>
		空白で区切った権利の一覧を指定することで、複数の権限を割り当てることも
		可能である。パラメータ'Domain\Domain Admins'はシステムシェルによって
		バックスラッシュと空白が解釈されてしまうのを防ぐために、シングルクォート
		かダブルクォートで囲まなければならない。
		</para></listitem>
	</varlistentry>

	<varlistentry><term>revoke &lt;user&gt; &lt;right [right ...]&gt;</term>
		<listitem><para>
		このコマンドは<command>net rpc rights grant</command>と形式が似ている。
		これは、ユーザとグループから割り当てられた権利(か権利の一覧)を削除する。
		</para></listitem>
	</varlistentry>

</variablelist>

<note><para>
<indexterm><primary>member</primary></indexterm>
<indexterm><primary>Domain Admins</primary></indexterm>
<indexterm><primary>権限の削除</primary></indexterm>
、アカウントに割り当てられる権限の設定か削除を可能にするため、Domain Admins グループ
メンバとして接続する必要がある。この能力はDomain Adminsグループに固有で変更できない。
Domain Adminsのメンバに割り当てられた能力以外、既定値の権利と権限はない。これは、
すべての管理者の権利と権限(それらに割り当てられた能力以外)は、Domain Adminsグループ
でも明示的に割り当てられなければならないということを意味する。
</para></note>

<para>
<indexterm><primary>rootとして実行</primary></indexterm>
<indexterm><primary>必要な権利</primary></indexterm>
<indexterm><primary>add machine script</primary></indexterm>
<indexterm><primary></primary></indexterm>
いったんsmbdが、ユーザが必要な権利を持っていると確認した場合、特定の操作はrootとして
実行されるので、初期状態では、どのユーザに対しても、何らの権利は割り当てられない。
例えば、Windowsドメインにクライアントを参加させる時、<parameter>add machine script</parameter>
はほとんどの場合、スーパーユーザの権利で動作させる必要がある。この理由のため、アカウントに
対して権限を割り当てるのはとても注意すべきである。
</para>

<para>
<indexterm><primary>Access</primary></indexterm>
<indexterm><primary>root user</primary></indexterm>
<indexterm><primary>権限のバイパス</primary></indexterm>
root ユーザ(UID=0)としてのアクセスは、すべての権限チェックをバイパスする。
</para>

</sect2>

<sect2>
<title>権限の説明</title>

<para>
<indexterm><primary>privileges</primary></indexterm>
<indexterm><primary>additional privileges</primary></indexterm>
<indexterm><primary>house-keeping</primary></indexterm>
The privileges that have been implemented in Samba-3.0.11 are shown below.  It is possible, and likely, that
additional privileges may be implemented in later releases of Samba. It is also likely that any privileges
currently implemented but not used may be removed from future releases as a housekeeping matter, so it is
important that the successful as well as unsuccessful use of these facilities should be reported on the Samba
mailing lists.
</para>

<variablelist>
	<varlistentry><term>SeAddUsersPrivilege</term>
		<listitem><para>
<indexterm><primary>SeAddUsersPrivilege</primary></indexterm>
<indexterm><primary>smbd</primary></indexterm>
<indexterm><primary>net rpc user add</primary></indexterm>
		This right determines whether or not smbd will allow the
		user to create new user or group accounts via such tools
		as <command>net rpc user add</command> or 
		<command>NT4 User Manager for Domains.</command>
		</para></listitem>
	</varlistentry>

	<varlistentry><term>SeDiskOperatorPrivilege</term>
		<listitem><para>
<indexterm><primary>SeDiskOperatorPrivilege</primary></indexterm>
<indexterm><primary>add/delete/change share</primary></indexterm>
<indexterm><primary>ACL</primary></indexterm>
		Accounts that possess this right will be able to execute
		scripts defined by the <command>add/delete/change</command>
		share command in &smb.conf; file as root.  Such users will
		also be able to modify the ACL associated with file shares
		on the Samba server.
		</para></listitem>
	</varlistentry>

	<varlistentry><term>SeMachineAccountPrivilege</term>
		<listitem><para>
<indexterm><primary>SeMachineAccountPrivilege</primary></indexterm>
<indexterm><primary>right to join domain</primary></indexterm>
<indexterm><primary>join client</primary></indexterm>
		This right controls whether or not the user can join client
		machines to a Samba-controlled domain.
		</para></listitem>
	</varlistentry>

	<varlistentry><term>SePrintOperatorPrivilege</term>
		<listitem><para>
<indexterm><primary>SePrintOperatorPrivilege</primary></indexterm>
<indexterm><primary>privilege</primary></indexterm>
<indexterm><primary>global right</primary></indexterm>
<indexterm><primary>administrative rights</primary></indexterm>
<indexterm><primary>printers admin</primary></indexterm>
		This privilege operates identically to the <smbconfoption name="printer admin"/>
		option in the &smb.conf; file (see section 5 man page for &smb.conf;)
		except that it is a global right (not on a per-printer basis). 
		Eventually the smb.conf option will be deprecated and administrative
		rights to printers will be controlled exclusively by this right and
		the security descriptor associated with the printer object in the
		<filename>ntprinters.tdb</filename> file.
		</para></listitem>
	</varlistentry>

	<varlistentry><term>SeRemoteShutdownPrivilege</term>
		<listitem><para>
<indexterm><primary>SeRemoteShutdownPrivilege</primary></indexterm>
<indexterm><primary>rebooting server</primary></indexterm>
<indexterm><primary>aborting shutdown</primary></indexterm>
		Samba provides two hooks for shutting down or rebooting
		the server and for aborting a previously issued shutdown
		command.  Since this is an operation normally limited by
		the operating system to the root user, an account must possess this
		right to be able to execute either of these hooks.
		</para></listitem>
	</varlistentry>

	<varlistentry><term>SeTakeOwnershipPrivilege</term>
		<listitem><para>
<indexterm><primary>SeTakeOwnershipPrivilege</primary></indexterm>
<indexterm><primary>take ownership</primary></indexterm>
		This right permits users to take ownership of files and directories.
		</para></listitem>
	</varlistentry>

</variablelist>

</sect2>

<sect2>
<title>Privileges Suppored by Windows 2000 Domain Controllers</title>

<para>
    For reference purposes, a Windows NT4 Primary Domain Controller reports support for the following
	privileges:
<indexterm><primary>SeCreateTokenPrivilege</primary></indexterm>
<indexterm><primary>SeAssignPrimaryTokenPrivilege</primary></indexterm>
<indexterm><primary>SeLockMemoryPrivilege</primary></indexterm>
<indexterm><primary>SeIncreaseQuotaPrivilege</primary></indexterm>
<indexterm><primary>SeMachineAccountPrivilege</primary></indexterm>
<indexterm><primary>SeTcbPrivilege</primary></indexterm>
<indexterm><primary>SeSecurityPrivilege</primary></indexterm>
<indexterm><primary>SeTakeOwnershipPrivilege</primary></indexterm>
<indexterm><primary>SeLoadDriverPrivilege</primary></indexterm>
<indexterm><primary>SeSystemProfilePrivilege</primary></indexterm>
<indexterm><primary>SeSystemtimePrivilege</primary></indexterm>
<indexterm><primary>SeProfileSingleProcessPrivilege</primary></indexterm>
<indexterm><primary>SeIncreaseBasePriorityPrivilege</primary></indexterm>
<indexterm><primary>SeCreatePagefilePrivilege</primary></indexterm>
<indexterm><primary>SeCreatePermanentPrivilege</primary></indexterm>
<indexterm><primary>SeBackupPrivilege</primary></indexterm>
<indexterm><primary>SeRestorePrivilege</primary></indexterm>
<indexterm><primary>SeShutdownPrivilege</primary></indexterm>
<indexterm><primary>SeDebugPrivilege</primary></indexterm>
<indexterm><primary>SeAuditPrivilege</primary></indexterm>
<indexterm><primary>SeSystemEnvironmentPrivilege</primary></indexterm>
<indexterm><primary>SeChangeNotifyPrivilege</primary></indexterm>
<indexterm><primary>SeRemoteShutdownPrivilege</primary></indexterm>
<screen>
         SeCreateTokenPrivilege  Create a token object
  SeAssignPrimaryTokenPrivilege  Replace a process level token
          SeLockMemoryPrivilege  Lock pages in memory
       SeIncreaseQuotaPrivilege  Increase quotas
      SeMachineAccountPrivilege  Add workstations to domain
                 SeTcbPrivilege  Act as part of the operating system
            SeSecurityPrivilege  Manage auditing and security log
       SeTakeOwnershipPrivilege  Take ownership of files or other objects
          SeLoadDriverPrivilege  Load and unload device drivers
       SeSystemProfilePrivilege  Profile system performance
          SeSystemtimePrivilege  Change the system time
SeProfileSingleProcessPrivilege  Profile single process
SeIncreaseBasePriorityPrivilege  Increase scheduling priority
      SeCreatePagefilePrivilege  Create a pagefile
     SeCreatePermanentPrivilege  Create permanent shared objects
              SeBackupPrivilege  Back up files and directories
             SeRestorePrivilege  Restore files and directories
            SeShutdownPrivilege  Shut down the system
               SeDebugPrivilege  Debug programs
               SeAuditPrivilege  Generate security audits
   SeSystemEnvironmentPrivilege  Modify firmware environment values
        SeChangeNotifyPrivilege  Bypass traverse checking
      SeRemoteShutdownPrivilege  Force shutdown from a remote system
</screen>
	And Windows 200x/XP Domain Controllers and workstations reports to support the following privileges:
<indexterm><primary>SeCreateTokenPrivilege</primary></indexterm>
<indexterm><primary>SeAssignPrimaryTokenPrivilege</primary></indexterm>
<indexterm><primary>SeLockMemoryPrivilege</primary></indexterm>
<indexterm><primary>SeIncreaseQuotaPrivilege</primary></indexterm>
<indexterm><primary>SeMachineAccountPrivilege</primary></indexterm>
<indexterm><primary>SeTcbPrivilege</primary></indexterm>
<indexterm><primary>SeSecurityPrivilege</primary></indexterm>
<indexterm><primary>SeTakeOwnershipPrivilege</primary></indexterm>
<indexterm><primary>SeLoadDriverPrivilege</primary></indexterm>
<indexterm><primary>SeSystemProfilePrivilege</primary></indexterm>
<indexterm><primary>SeSystemtimePrivilege</primary></indexterm>
<indexterm><primary>SeProfileSingleProcessPrivilege</primary></indexterm>
<indexterm><primary>SeIncreaseBasePriorityPrivilege</primary></indexterm>
<indexterm><primary>SeCreatePagefilePrivilege</primary></indexterm>
<indexterm><primary>SeCreatePermanentPrivilege</primary></indexterm>
<indexterm><primary>SeBackupPrivilege</primary></indexterm>
<indexterm><primary>SeRestorePrivilege</primary></indexterm>
<indexterm><primary>SeShutdownPrivilege</primary></indexterm>
<indexterm><primary>SeDebugPrivilege</primary></indexterm>
<indexterm><primary>SeAuditPrivilege</primary></indexterm>
<indexterm><primary>SeSystemEnvironmentPrivilege</primary></indexterm>
<indexterm><primary>SeChangeNotifyPrivilege</primary></indexterm>
<indexterm><primary>SeRemoteShutdownPrivilege</primary></indexterm>
<indexterm><primary>SeUndockPrivilege</primary></indexterm>
<indexterm><primary>SeSyncAgentPrivilege</primary></indexterm>
<indexterm><primary>SeEnableDelegationPrivilege</primary></indexterm>
<indexterm><primary>SeManageVolumePrivilege</primary></indexterm>
<indexterm><primary>SeImpersonatePrivilege</primary></indexterm>
<indexterm><primary>SeCreateGlobalPrivilege</primary></indexterm>
<screen>
         SeCreateTokenPrivilege  Create a token object
  SeAssignPrimaryTokenPrivilege  Replace a process level token
          SeLockMemoryPrivilege  Lock pages in memory
       SeIncreaseQuotaPrivilege  Increase quotas
      SeMachineAccountPrivilege  Add workstations to domain
                 SeTcbPrivilege  Act as part of the operating system
            SeSecurityPrivilege  Manage auditing and security log
       SeTakeOwnershipPrivilege  Take ownership of files or other objects
          SeLoadDriverPrivilege  Load and unload device drivers
       SeSystemProfilePrivilege  Profile system performance
          SeSystemtimePrivilege  Change the system time
SeProfileSingleProcessPrivilege  Profile single process
SeIncreaseBasePriorityPrivilege  Increase scheduling priority
      SeCreatePagefilePrivilege  Create a pagefile
     SeCreatePermanentPrivilege  Create permanent shared objects
              SeBackupPrivilege  Back up files and directories
             SeRestorePrivilege  Restore files and directories
            SeShutdownPrivilege  Shut down the system
               SeDebugPrivilege  Debug programs
               SeAuditPrivilege  Generate security audits
   SeSystemEnvironmentPrivilege  Modify firmware environment values
        SeChangeNotifyPrivilege  Bypass traverse checking
      SeRemoteShutdownPrivilege  Force shutdown from a remote system
              SeUndockPrivilege  Remove computer from docking station
           SeSyncAgentPrivilege  Synchronize directory service data
    SeEnableDelegationPrivilege  Enable computer and user accounts to
                                 be trusted for delegation
        SeManageVolumePrivilege  Perform volume maintenance tasks
         SeImpersonatePrivilege  Impersonate a client after authentication
        SeCreateGlobalPrivilege  Create global objects
</screen>
<indexterm><primary>equivalence</primary></indexterm>
    The Samba Team is implementing only those privileges that are logical and useful in the UNIX/Linux
    environment. Many of the Windows 200X/XP privileges have no direct equivalence in UNIX.
    </para>

</sect2>

</sect1>

<sect1>
<title>The Administrator Domain SID</title>

<para>
<indexterm><primary>domain Administrator</primary></indexterm>
<indexterm><primary>User Rights and Privileges</primary></indexterm>
<indexterm><primary>passdb backend</primary></indexterm>
<indexterm><primary>SID</primary></indexterm>
<indexterm><primary>net getlocalsid</primary></indexterm>
Please note that every Windows NT4 and later server requires a domain Administrator account. Samba versions
commencing with 3.0.11 permit Administrative duties to be performed via assigned rights and privileges
(see <link linkend="rights">User Rights and Privileges</link>).  An account in the server's passdb backend can
be set to the well-known RID of the default administrator account.  To obtain the domain SID on a Samba domain
controller, run the following command:
<screen>
&rootprompt; net getlocalsid
SID for domain FOO is: S-1-5-21-4294955119-3368514841-2087710299
</screen>
<indexterm><primary>RID</primary></indexterm>
You may assign the domain administrator RID to an account using the <command>pdbedit</command>
command as shown here:
<indexterm><primary>pdbedit</primary></indexterm>
<screen>
&rootprompt; pdbedit -U S-1-5-21-4294955119-3368514841-2087710299-500 -u root -r
</screen>
</para>

<note><para>
<indexterm><primary>RID 500</primary></indexterm>
<indexterm><primary>well known RID</primary></indexterm>
<indexterm><primary>rights and privileges</primary></indexterm>
<indexterm><primary>root account</primary></indexterm>
The RID 500 is the well known standard value of the default Administrator account. It is the RID
that confers the rights and privileges that the Administrator account has on a Windows machine
or domain. Under UNIX/Linux the equivalent is UID=0 (the root account).
</para></note>

<para>
<indexterm><primary>without Administrator account</primary></indexterm>
<indexterm><primary>equivalent rights and privileges</primary></indexterm>
<indexterm><primary>Windows group account</primary></indexterm>
<indexterm><primary>3.0.11</primary></indexterm>
Releases of Samba version 3.0.11 and later make it possible to operate without an Administrator account
provided equivalent rights and privileges have been established for a Windows user or a Windows
group account. 
</para>

</sect1>

<sect1>
<title>Common Errors</title>

	<sect2>
	<title>What Rights and Privileges Will Permit Windows Client Administration?</title>

	<para>
<indexterm><primary>domain global</primary></indexterm>
<indexterm><primary>local group</primary></indexterm>
<indexterm><primary>administrative rights</primary></indexterm>
<indexterm><primary>Windows client</primary></indexterm>
	When a Windows NT4 (or later) client joins a domain, the domain global <literal>Domain Admins</literal> group
	is added to the membership of the local <literal>Administrators</literal> group on the client. Any user who is
	a member of the domain global <literal>Domain Admins</literal> group will have administrative rights on the
	Windows client.
	</para>

	<para>
<indexterm><primary>desirable solution</primary></indexterm>
<indexterm><primary>administrative rights and privileges</primary></indexterm>
<indexterm><primary>Power Users</primary></indexterm>
<indexterm><primary>domain global user</primary></indexterm>
<indexterm><primary>domain global group</primary></indexterm>
	This is often not the most desirable solution because it means that the user will have administrative
	rights and privileges on domain servers also. The <literal>Power Users</literal> group on Windows client
	workstations permits local administration of the workstation alone. Any domain global user or domain global
	group can be added to the membership of the local workstation group <literal>Power Users</literal>.
	</para>

	<para>
<indexterm><primary>Nested Group Support</primary></indexterm>
<indexterm><primary>add domain users and groups to a local group</primary></indexterm>
<indexterm><primary>net</primary></indexterm>
<indexterm><primary>Windows workstation.</primary></indexterm>
	See <link linkend="nestedgrpmgmgt">Nested Group Support</link> for an example of how to add domain users
	and groups to a local group that is on a Windows workstation. The use of the <command>net</command>
	command permits this to be done from the Samba server.
	</para>

	<para>
<indexterm><primary>cmd</primary></indexterm>
<indexterm><primary>cmd shell</primary></indexterm>
<indexterm><primary>net</primary><secondary>localgroup</secondary></indexterm>
	Another way this can be done is to log onto the Windows workstation as the user
	<literal>Administrator</literal>, then open a <command>cmd</command> shell, then execute:
<screen>
&dosprompt; net localgroup administrators /add <userinput>domain_name\entity</userinput>
</screen>
	where <literal>entity</literal> is either a domain user or a domain group account name.
	</para>

	</sect2>

</sect1>

</chapter>
