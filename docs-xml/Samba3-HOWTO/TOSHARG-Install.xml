<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<chapter id="install">
<chapterinfo>
	&author.tridge;
	&author.jelmer;
	&author.jht;
	&author.kauer;
	&author.danshearer;
	<!-- Isn't some of this written by others as well? -->

</chapterinfo>

<title>SAMBAのインストールとテスト方法</title>

<sect1>
	<title>Sambaの入手とインストール</title>

	<para>
	<indexterm><primary>パッケージ</primary></indexterm>
        SambaのバイナリパッケージはほとんどのLinuxかUNIXディストリビューション
        に含まれている。また、
        <ulink url="http://samba.org/">the Samba home page(本家)</ulink>にも
        いくつかのパッケージが置いてある。使用するOSに合わせたパッケージのイン
        ストールの詳細については、OSのマニュアルを参照してほしい。
	</para>

	<para>
	<indexterm><primary>コンパイル</primary></indexterm>
        もしもソースからSambaをコンパイルすることが必要ならば、
	<link linkend="compiling">Sambaのコンパイル方法</link>をチェックしてほしい。
	</para>

</sect1>

<sect1>
	<title>Sambaの設定 (smb.conf)</title>

	<para>
	<indexterm><primary>/etc/samba/smb.conf</primary></indexterm>
	<indexterm><primary>SWAT</primary></indexterm>
        Sambaの設定は&smb.conf;ファイルに格納され、それは、通常
	<filename>/etc/samba/smb.conf</filename> か 
        <filename>/usr/local/samba/lib/smb.conf</filename>にある。このファイル
        を自分自身で編集するか、あるいは、たとえば、Sambaに含まれているWebベー
        スのインタフェースSWATのような、種々のGUIツールのどれかを使って編集する
        ことができる。
	</para>

	<sect2>
	<title>設定ファイルの文法</title>

	<para>
	<indexterm><primary>セクション名</primary></indexterm>
	&smb.conf; ファイルは、昔のWindows 3.1で使われていたいろいろな
        <filename>.ini</filename>ファイルと同じ文法を使う。おのおののファイル
        はいくつかのセクションからなり、それらは行の先頭が大括弧
        (<literal>[]</literal>)で囲まれた、セクション名から開始される。それぞれ
        は0またはそれ以上の、等号(<literal>=</literal>)で分離されたキー/値ペア
        を含む。ファイルは単なるテキストファイルなので、好みの編集ツールで開い
        て編集できる。
	</para>

	<para>
	<indexterm><primary>meta-service</primary></indexterm>
	<indexterm><primary>print</primary><secondary>queue</secondary></indexterm>
	<indexterm><primary>share</primary></indexterm>
	<indexterm><primary>spooler.</primary></indexterm>
	<indexterm><primary>print</primary><secondary>spooler</secondary></indexterm>
	<indexterm><primary>spool</primary><secondary>directory</secondary></indexterm>
        &smb.conf;ファイル中にあるおのおののセクションは、共有か、Sambaサーバ上
        のメタサービスを記述している。<literal>[global]</literal>セクションは特
        別であり、Sambaサーバ全体にたいして適用する設定を含む。Sambaは複数の
        メタサービスをサポートし、おのおのは固有の機能を提供する。例えば、
        <literal>[homes]</literal>共有は、メタサービスであり、おのおののユーザ
        のための、個別のホーム共有を提供させる。<literal>[printers]</literal>は
        メタサービスであり、プリントキューサポートを確立し、それは、Windows
        クライアントから、UNIX/Linuxプリントスプーラに対してプリントジョブが
        送られることに先立ち、中間スプールディレクトリの位置を指定する。
	</para>

	<para>
<indexterm><primary>printers</primary></indexterm>
<indexterm><primary>meta-service</primary></indexterm>
<indexterm><primary>printcap</primary></indexterm>
<indexterm><primary>lpstat</primary></indexterm>
<indexterm><primary>CUPS API</primary></indexterm>
<indexterm><primary>browseable</primary></indexterm>
	<literal>printers</literal> メタサービスは、<literal>printcap</literal>
        ファイル中で指定されたものか、<command>lpstat</command>コマンドか
        CUPS API経由かでのすべてのプリンタを共有プリントキューとして公開する
        ようにする。&smb.conf;ファイル中の<literal>printers</literal>節は
        browseable でないように設定できる。もしもbrowseableに設定すると、
        共有として見えるようになる。これは、WindowsプリントキューとしてUNIX
        システムプリンタを有効にするのみ反応するこのメタサービスをTmakes no
        sense。もしも、<literal>comment</literal>パラメータが指定されるならば、
        その値がWindowsエクスプローラのブラウズリスト中にプリンタ名の一部と
        して表示される。
	</para>

	<para>
	<indexterm><primary>節</primary></indexterm>
        共有またはメタサービスを指定する&smb.conf;ファイル中のおのおののセクション
        は節(stanza)と呼ばれる(訳注:日本ではセクションという呼び名が通用している
        ため、以下はすべてセクションとする)。<literal>global</literal>セクション
        は&smb.conf;ファイル中のすべての他のセクションに影響する設定を指定する。
        設定パラメータは&smb.conf;マニュアルページに説明がある。いくつかのパラメータ
        は<literal>global</literal>セクションのみで使われ、その他いくつかは通常の
        共有またはメタサービスセクションでのみ使われ、いくつかは、グローバルまたは
        共有、メタサービスセクションで使える。
	</para>

	<para>
	<indexterm><primary>最小の</primary><secondary>設定</secondary></indexterm>
	<link linkend="smbconfminimal">最小のsmb.conf</link> はとても小さい&smb.conf;を含む。
	<indexterm><primary>最小の設定</primary></indexterm>
	</para>

	<example id="smbconfminimal">
		<title>最小のsmb.conf</title>
		<smbconfblock>

		<smbconfsection name="[global]"/>
		<smbconfoption name="workgroup">WKG</smbconfoption>
		<smbconfoption name="netbios name">MYNAME</smbconfoption>
		<smbconfsection name="[share1]"/>
		<smbconfoption name="path">/tmp</smbconfoption>

		<smbconfsection name="[share2]"/>
		<smbconfoption name="path">/my_shared_folder</smbconfoption>
		<smbconfoption name="comment">Some random files</smbconfoption>
	</smbconfblock>
	</example>

</sect2>

<sect2 id="tdbdocs">
	<title>TDBデータベースファイルの情報</title>

	<para>
        このセクションインはSamba-3で使われるデータベースの簡単な説明を含む。
	</para>

	<para>
<indexterm><primary>tdbファイルの位置</primary></indexterm>
        Sambaが格納するtdbファイルのディレクトリの位置は、コンパイル時オプ
        ションによって変わる。Samba-3は2つの場所にtdbファイルを格納する。
        その位置を決める最も良い方法は、以下のコマンドを実行する:
<screen>
&rootprompt; smbd -b | grep PRIVATE_DIR
   PRIVATE_DIR: /etc/samba/private
</screen>
        これは、秘密のtdbファイルが<filename>/etc/samba/private</filename>
        ディレクトリに格納されることを意味している。Samba-3はまた、より
        ありふれたデータを含むいくつかのtdbファイルを使う。それらのファイルの
        位置は以下を実行することで見つけられる:
<screen>
&rootprompt; smbd -b | grep LOCKDIR
   LOCKDIR: /var/lib/samba
</screen>
        それゆえ、令の中で表示されている残りの制御ファイルは
	<filename>/var/lib/samba</filename> ディレクトリに格納される。
	</para>

	<para>
<indexterm><primary>tdbファイルの説明</primary></indexterm>
        継続的に使われるtdbファイルは
        <link linkend="tdbpermfiledesc">継続的なTDBファイルの説明一覧</link>
        にある。すべての継続的なtdbファイルは通常バックアップすべきである。
        tdbファイルバックアップのために<command>tdbbackup</command>ユー
        ティリティを使うこと。すべての継続的なtdbファイルはマシンの
        マイグレーション、アップデートとアップグレードの間保存すべきである。
	</para>

	<para>
        一時的なtdbファイルはバックアップの必要性はなく、マイグレーション、
        アップデートとアップグレードの間保存する必要もない。一時的なtdb
        ファイルは
        <link linkend="tdbtempfiledesc">一時的なTDBファイルの説明</link>
        に説明がある。
	</para>

        <table frame='all' id="tdbpermfiledesc"><title>継続的なTDBファイルの説明</title>
        <tgroup cols='2'>
			<colspec align="left"/>
			<colspec align="justify" colwidth="1*"/>
			<colspec align="left"/>
                <thead>
                <row>
                        <entry align="left">名前</entry>
                        <entry align="justify">説明</entry>
                </row>
                </thead>
                <tbody>
		<row>
			<entry>account_policy</entry>
			<entry><para>Samba/NTアカウントポリシーの設定、パスワード満了の設定を含む。</para></entry>
		</row>
		<row>
			<entry>group_mapping</entry>
			<entry><para>Windows グループ/SID から UNIXグループへのマッピングテーブル。</para></entry>
		</row>
		<row>
			<entry>ntdrivers</entry>
			<entry><para>プリンタ単位の、インストール済みドライバ情報を格納。</para></entry>
		</row>
		<row>
			<entry>ntforms</entry>
			<entry><para>プリンタ単位の、インストール済みフォーム情報を格納。</para></entry>
		</row>
		<row>
			<entry>ntprinters</entry>
			<entry><para>プリンタ単位の、devmode構成設定情報を格納。</para></entry>
		</row>
		<row>
			<entry>passdb</entry>
			<entry><para>
                                tdbsamパスワードバックエンドが使われる時のみ存
                                在。このファイルはSambaSAMAccount情報を格納する。
                                注意:このファイルは/etc/passwdファイルからか他
                                の代替システムソースからのユーザのPOSIXアカウント
                                を必要とする。
			</para></entry>
		</row>
		<row>
			<entry>registry</entry>
			<entry><para>
                                winreg RPC経由で種々のデータベーステーブルをエ
                                クスポートすることをサポートするための、読み出
                                し専用Windowsレジストリスケルトンデータベース。
			</para></entry>
		</row>
		<row>
			<entry>secrets</entry>
			<entry><para>
                                このファイルはWorkgroup/Domain/Machine SID、
                                LDAPディレクトリ更新パスワードとSambaが正常に
                                動作するために必要な重要な環境データのさらなる
                                集合。このファイルには、秘匿しなければならない
                                とても機密性のある情報が含まれている。このファ
                                イルはPRIVATE_DIRディレクトリに格納される。
			</para></entry>
		</row>
		<row>
			<entry>share_info</entry>
			<entry><para>共有単位のACL情報を格納。</para></entry>
		</row>
		<row>
			<entry>winbindd_idmap</entry>
			<entry><para>Winbinddのローカル IDMAPデータベース。</para></entry>
		</row>
		</tbody>
	</tgroup>
	</table>

        <table frame='all' id="tdbtempfiledesc"><title>一時的なTDBファイルの説明</title>
        <tgroup cols='3'>
			<colspec align="left"/>
			<colspec align="justify" colwidth="1*"/>
			<colspec align="left"/>
                <thead>
                <row>
                        <entry align="left">名前</entry>
                        <entry align="justify">説明</entry>
                        <entry align="center">バックアップ</entry>
                </row>
                </thead>
                <tbody>
		<row>
			<entry>brlock</entry>
			<entry><para>バイトレンジロック情報。</para></entry>
			<entry>No</entry>
		</row>
		<row>
			<entry>connections</entry>
			<entry><para>最大接続数を拡張するために使われる一時的な接続上のキャッシュ。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>eventlog/*tdb</entry>
			<entry><para>イベントログエントリのレコードほとんどの環境ではこれはシステムログのキャッシュである。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>gencache</entry>
			<entry><para>WINSサーバと信頼されるドメインデータのための汎用キャッシュデータベース。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>login_cache</entry>
			<entry><para>ログイン情報のための一時的なキャッシュで、特に不正なパスワード試行用。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>messages</entry>
			<entry><para>smbdによって処理されるメッセージの一時的な格納用。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>netsamlogon_cache</entry>
			<entry><para>net_samloginリクエストからのユーザnet_info_3 構造データのキャッシュ(ドメインメンバとして)。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>perfmon/*.tdb</entry>
			<entry><para>パフォーマンスカウンタ情報。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>printing/*.tdb</entry>
			<entry><para>プリントサービス単位で作成されるlpqコマンドのキャッシュされた出力。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>schannel_store</entry>
			<entry><para>
                                機密ファイルで、PRIVATE_DIRに格納され、接続セッ
                                トアッププロセスの再ネゴシエーションの必要なし
                                で再接続可能な一時的な切断が可能になるための暗
                                号化した接続情報を含む。
			</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>sessionid</entry>
			<entry><para>種々のセッション情報とutmp処理のための一時的なキャッシュ。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>unexpected</entry>
			<entry><para>どのプロセスもリッスンしていない時に受け取ったパケットを格納する。</para></entry>
			<entry>no</entry>
		</row>
		<row>
			<entry>winbindd_cache</entry>
			<entry><para>NT4ドメインかADSから受け取ったアイデンテティ
                        情報のキャッシュ。ユーザリストなどを含む。</para></entry>
			<entry>yes</entry>
		</row>
		</tbody>
	</tgroup>
	</table>

</sect2>

<sect2>
	<title>Sambaを起動する</title>

	<para>
	<indexterm><primary>daemon</primary></indexterm>
        Sambaは2つまたは3つのdaemonから構成される。daemonはバックグラウンドで動
        作し、サービスを提供するUNIXのアプリケーションである。サービスの例としては、
        <command>httpd</command> と呼ばれるdaemonが Apache Webサーバである。
        Sambaの場合は、3つのdaemonがあり、そのうち2つが最低必要である。
	</para>

	<para>
        Sambaサーバは以下のdaemonから成り立っている:
	</para>

	<variablelist>
		<varlistentry><term>nmbd</term>
			<listitem><para>
			<indexterm><primary>smbd</primary></indexterm>
			<indexterm><primary>samba</primary><secondary>smbd</secondary>の開始</indexterm>
                        このdaemonはすべての名前登録と名前解決要求を処理する。
                        これはネットワークブラウジング中で必要とされる主要な
                        伝達手段である。これは、すべてのUDPベースのプロトコル
                        を処理する。<command>nmbd</command>daemonはSamba開始
                        プロセスの一部分として最初にコマンドを起動すべきである。
			</para></listitem>
		</varlistentry>

		<varlistentry><term>smbd</term>
			<listitem><para>
			<indexterm><primary>nmbd</primary></indexterm>
			<indexterm><primary>samba</primary><secondary>nmbd</secondary>の開始</indexterm>
                        このdaemonはファイルと印刷関係の操作のための、TCP/IP
                        ベースのすべてのコネクションサービスを処理する。また、
                        ローカルでの認証も管理する。これは
                        <command>nmbd</command>の開始に引き続いて起動すべきで
                        ある。
			</para></listitem>
		</varlistentry>

		<varlistentry><term>winbindd</term>
			<listitem><para>
			<indexterm><primary>winbindd</primary></indexterm>
			<indexterm><primary>samba</primary><secondary>winbindd</secondary>の起動</indexterm>
                        このdaemonはWindows NT4またはADSドメインのメンバの時に
                        起動すべきである。また、他のドメインとの信頼関係を結ぶ
                        時にも必要である。<command>winbindd</command>daemonは
                        <parameter>idmap uid</parameter>と
                        <parameter>idmap gid</parameter>パラメータが&smb.conf;
                        ファイル中に存在するかどうかをチェックする。もしもそれ
                        らが見つかった場合、<command>winbindd</command>はUIDと
                        GIDの割り当てのために指定された値を使う。もしも、パラメー
                        タが指定されていなければ、<command>winbindd</command>
                        は起動するが、UIDとGIDの割り当てが出来ない。
			</para></listitem>
		</varlistentry>
	</variablelist>

	<para>
	<indexterm><primary>process</primary><secondary>の開始</secondary></indexterm>
        SambaがOSベンダによってパッケージ化されている時、開始プロセスは通常プラッ
        トフォーム全体に渡って統合された固有の機能となっている。Sambaの起動の正
        しい管理に関する特定の情報のためにOSプラットフォームの管理マニュアルを
        参照してほしい。
	</para>

</sect2>
	
<sect2>
	<title>設定の例</title>
	
	<para>
	<indexterm><primary>examples</primary></indexterm>
	<indexterm><primary>source code</primary></indexterm>
	<indexterm><primary>distribution</primary></indexterm>
	<indexterm><primary>tarball</primary></indexterm>
	<indexterm><primary>package</primary></indexterm>
	There are sample configuration files in the examples subdirectory in the source code distribution tarball
	package. It is suggested you read them carefully so you can see how the options go together in practice. See
	the man page for all the options.  It might be worthwhile to start out with the
	<filename>smb.conf.default</filename> configuration file and adapt it to your needs. It contains plenty of comments.
	</para>

	<para>
	<indexterm><primary>simplest</primary><secondary>configuration</secondary></indexterm>
	The simplest useful configuration file would contain something like that shown in
	<link linkend="simple-example">Another simple smb.conf File</link>.
	<indexterm><primary>simple configuration</primary></indexterm>
	</para>

<example id="simple-example">
<title>Another simple smb.conf File</title>
<smbconfblock>
<smbconfsection name="[global]"/>
<smbconfoption name="workgroup">&example.workgroup;</smbconfoption>

<smbconfsection name="[homes]"/>
<smbconfoption name="guest ok">no</smbconfoption>
<smbconfoption name="read only">no</smbconfoption>
</smbconfblock>
</example>
	
	<para>
	<indexterm><primary>connections</primary></indexterm>
	<indexterm><primary>account</primary></indexterm>
	<indexterm><primary>login name</primary></indexterm>
	<indexterm><primary>service name</primary></indexterm>
	This will allow connections by anyone with an account on the server, using either
	their login name or <smbconfsection name="homes"/> as the service name.
	(Note: The workgroup that Samba should appear in must also be set. The default
	workgroup name is WORKGROUP.)
	</para>
	
	<para>
	<indexterm><primary>smbd</primary></indexterm>
	Make sure you put the &smb.conf; file in the correct place. Note, the correct location of this file
	depends on how the binary files were built. You can discover the correct location by executing from
	the directory that contains the <command>smbd</command> command file:
<screen>
&rootprompt; smbd -b | grep smb.conf
</screen>
	</para>

	<para>
	<indexterm><primary>security</primary><secondary>settings</secondary></indexterm>
	For more information about security settings for the <smbconfsection name="[homes]"/> share, please refer to 
	<link linkend="securing-samba">Securing Samba</link>.
	</para>

<sect3>
	<title>Test Your Config File with <command>testparm</command></title>

	<para>
	<indexterm><primary>validate</primary></indexterm>
	<indexterm><primary>testparm</primary></indexterm>
	<indexterm><primary>misconfigurations</primary></indexterm>
	It's important to validate the contents of the &smb.conf; file using the &testparm; program.
	If testparm runs correctly, it will list the loaded services. If not, it will give an error message.
	Make sure it runs correctly and that the services look reasonable before proceeding. Enter the command: 
	<screen>
	&rootprompt; testparm /etc/samba/smb.conf
	</screen>
	Testparm will parse your configuration file and report any unknown parameters or incorrect syntax.
	It also performs a check for common misconfigurations and will issue a warning if one is found.
	</para>

	<para>
	Always run testparm again whenever the &smb.conf; file is changed!
	</para>

	<para>
	<indexterm><primary>smbd</primary></indexterm>
	<indexterm><primary>nmbd</primary></indexterm>
	<indexterm><primary>winbindd</primary></indexterm>
	<indexterm><primary>configuration</primary><secondary>documentation</secondary></indexterm>
	The &smb.conf; file is constantly checked by the Samba daemons <command>smbd</command> and every instance of
	itself that it spawns, <command>nmbd</command> and <command>winbindd</command>. It is good practice to
	keep this file as small as possible. Many administrators prefer to document Samba configuration settings
	and thus the need to keep this file small goes against good documentation wisdom. One solution that may
	be adopted is to do all documentation and configuration in a file that has another name, such as
	<filename>smb.conf.master</filename>. The <command>testparm</command> utility can be used to generate a
	fully optimized &smb.conf; file from this master configuration and documtenation file as shown here:
<screen>
&rootprompt; testparm -s smb.conf.master > smb.conf
</screen>
	This administrative method makes it possible to maintain detailed configuration change records while at
	the same time keeping the working &smb.conf; file size to the minimum necessary.
	</para>

</sect3>
</sect2>

<sect2>
	<title>SWAT</title>

	<para>
	<indexterm><primary>swat</primary></indexterm>
	SWAT is a Web-based interface that can be used to facilitate the configuration of Samba.  SWAT might not
	be available in the Samba package that shipped with your platform, but in a separate package. If it is
	necesaary to built SWAT please read the SWAT man page regarding compilation, installation, and
	configuration of SWAT from the source code.
	</para>

	<para>
	To launch SWAT, just run your favorite Web browser and point it to
	<ulink url="http://localhost:901/" noescape="1">http://localhost:901/</ulink>.
	Replace <replaceable>localhost</replaceable> with the name of the computer on which
	Samba is running if that is a different computer than your browser.
	</para>

	<para>
	SWAT can be used from a browser on any IP-connected machine, but be aware that connecting from a remote
	machine leaves your connection open to password sniffing because passwords will be sent over the wire in the clear. 
	</para>

	<para>
	More information about SWAT can be found in <link linkend="SWAT">The Samba Web Administration Tool</link>.
	</para>

</sect2>

</sect1>

<sect1>
	<title>List Shares Available on the Server</title>

	<para>
	To list shares that are available from the configured Samba server, execute the
	following command:
	</para>

<para><screen>
&prompt;<userinput>smbclient -L <replaceable>yourhostname</replaceable></userinput>
</screen></para>

	<para>
	You should see a list of shares available on your server. If you do not, then
	something is incorrectly configured. This method can also be used to see what shares 
	are available on other SMB servers, such as Windows 2000.
	</para>

	<para>
	If you choose user-level security, you may find that Samba requests a password
	before it will list the shares. See the <command>smbclient</command> man page for details.
	You can force it to list the shares without a password by adding the option
	<option>-N</option> to the command line. 
	</para>
</sect1>

<sect1>
	<title>Connect with a UNIX Client</title>
	
	<para>
	Enter the following command:
<screen>
&prompt;<userinput>smbclient <replaceable> //yourhostname/aservice</replaceable></userinput>
</screen></para>
	
	<para>Typically <replaceable>yourhostname</replaceable> is the name of the host on which &smbd;
	has been installed. The <replaceable>aservice</replaceable> is any service that has been defined in the &smb.conf;
	file. Try your username if you just have a <smbconfsection name="[homes]"/> section in the &smb.conf; file.</para>

	<para>Example: If the UNIX host is called <replaceable>bambi</replaceable> and a valid login name
	is <replaceable>fred</replaceable>, you would type:</para>

<para><screen>
&prompt;<userinput>smbclient //<replaceable>bambi</replaceable>/<replaceable>fred</replaceable></userinput>
</screen></para>
</sect1>

<sect1>
	<title>Connect from a Remote SMB Client</title>

	<para>
	Now that Samba is working correctly locally, you can try to access it from other clients. Within a few
	minutes, the Samba host should be listed in the Network Neighborhood on all Windows clients of its subnet.
	Try browsing the server from another client or "mounting" it.
	</para>

	<para>
	Mounting disks from a DOS, Windows, or OS/2 client can be done by running a command such as:
<screen>
&dosprompt;<userinput>net use m: \\servername\service</userinput>
</screen>
	Where the drive letter m: is any available drive letter. It is important to double-check that the
	service (share) name that you used does actually exist.
	</para>

	<para>
	Try printing, for example,
<screen>
&dosprompt;<userinput>net use lpt1:	\\servername\spoolservice</userinput>
</screen>
	The <literal>spoolservice</literal> is the name of the printer (actually the print queue) on the target
	server. This will permit all print jobs that are captured by the lpt1: port on the Windows client to
	be sent to the printer that owns the spoolservice that has been specified.
	</para>

<para>
<screen>&dosprompt;<userinput>print filename</userinput>
</screen></para>

	<sect2>
	<title>What If Things Don't Work?</title>
	
	<para>
	You might want to read <link linkend="diagnosis">The Samba Checklist</link>.  If you are still
	stuck, refer to <link linkend="problems">Analyzing and Solving Samba Problems</link>.  Samba has
	been successfully installed at thousands of sites worldwide.  It is unlikely that your particular problem is
	unique, so it might be productive to perform an Internet search to see if someone else has encountered your
	problem and has found a way to overcome it.
	</para>

	<para>
	If you are new to Samba, and particularly if you are new to Windows networking, or to UNIX/Linux,
	the book <quote>Samba-3 by Example</quote> will help you to create a validated network environment.
	Simply choose from the first five chapters the network design that most closely matches site needs,
	then follow the simple step-by-step procedure to deploy it. Later, when you have a working network
	you may well want to refer back to this book for further insight into opportunities for improvement.
	</para>

	</sect2>

	<sect2>
	<title>Still Stuck?</title>

	<para>
	The best advice under the stress of abject frustration is to cool down! That may be challenging
	of itself, but while you are angry or annoyed your ability to seek out a solution is somewhat
	undermined. A cool head clears the way to finding the answer you are looking for. Just remember,
	every problem has a solution &smbmdash; there is a good chance that someone else has found it
	even though you can't right now. That will change with time, patience and learning.
	</para>

	<para>
	Now that you have cooled down a bit, please refer to <link linkend="diagnosis">the Samba Checklist</link>
	for a process that can be followed to identify the cause of your problem.
	</para>

	</sect2>

</sect1>

<sect1>
<title>Common Errors</title>

<para>
The following questions and issues are raised repeatedly on the Samba mailing list.
</para>

<sect2>
	<title>Large Number of smbd Processes</title>

	<para>
	Samba consists of three core programs: &nmbd;, &smbd;, and &winbindd;. &nmbd; is the name server message daemon,
	&smbd; is the server message daemon, and &winbindd; is the daemon that handles communication with domain controllers.
	</para>

	<para>
	If Samba is <emphasis>not</emphasis> running as a WINS server, then there will be one single instance of
	 &nmbd; running on your system. If it is running as a WINS server, then there will be
	two instances &smbmdash; one to handle the WINS requests.
	</para>

	<para>
	&smbd; handles all connection requests. It spawns a new process for each client
	connection made. That is why you may see so many of them, one per client connection.
	</para>

	<para>
	&winbindd; will run as one or two daemons, depending on whether or not it is being
	run in <emphasis>split mode</emphasis> (in which case there will be two instances).
	</para>

	</sect2>

	<sect2>
		<title>Error Message: open_oplock_ipc</title>

	<para>
	An error message is observed in the log files when &smbd; is started: <quote>open_oplock_ipc: Failed to
	get local UDP socket for address 100007f. Error was Cannot assign requested.</quote>
	</para>

	<para>
	Your loopback device isn't working correctly. Make sure it is configured correctly. The loopback
	device is an internal (virtual) network device with the IP address <emphasis>127.0.0.1</emphasis>.
	Read your OS documentation for details on how to configure the loopback on your system.
	</para>

	</sect2>

	<sect2>
		<title><quote><errorname>The network name cannot be found</errorname></quote></title>

		<para>
		This error can be caused by one of these misconfigurations:
		</para>

		<itemizedlist>
			<listitem><para>You specified a nonexisting path
			for the share in &smb.conf;.</para></listitem>

			<listitem><para>The user you are trying to access the share with does not 
			have sufficient permissions to access the path for
			the share. Both read (r) and access (x) should be possible.</para></listitem>

			<listitem><para>The share you are trying to access does not exist.</para></listitem>
	</itemizedlist>

	</sect2>
</sect1>

</chapter>
