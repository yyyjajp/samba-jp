<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<chapter id="Other-Clients">
<chapterinfo>
	&author.jelmer;
	&author.jht;
	&author.danshearer;
	<author>&person.jmcd;<contrib>OS/2</contrib></author>
	<pubdate>5 Mar 2001</pubdate>
</chapterinfo>

<title>Samba と他の CIFS クライアント</title>

<para>この章では、クライアント固有の情報について記述している。</para>

<sect1>
<title>Macintoshクライアント</title>

<para>
<indexterm><primary>DAVE</primary></indexterm>
もちろん対応している。<ulink url="http://www.thursby.com/">Thursby</ulink>は、
<ulink url="http://www.thursby.com/products/dave.html">DAVE</ulink>という
CIFS client/serverを提供している。これはWindows 95、Windows NT/200x/XPとSambaに対して、
互換性についてテストされている。これを書いている時点で、DAVEはバージョン 5.1である。
この製品についての情報はThursbyのWebサイトを参照してほしい。
</para>

<para> 
<indexterm><primary>Netatalk</primary></indexterm>
<indexterm><primary>CAP</primary></indexterm>
ある種のUNIXといくつかの商用のものに対する、2つのAppleTalkの自由な実装を含む代替品が
ある。これらの製品はMacintocth上で追加のサポートなしに、Macintoshユーザにネイティブな
ファイルサービスと印刷サービスを動かすことが出来る。2つの自由な実装は、
<ulink url="http://www.umich.edu/~rsug/netatalk/">Netatalk</ulink>と
<ulink url="http://www.cs.mu.oz.au/appletalk/atalk.html">CAP</ulink>である。
SambaがMicrosoft Windows ユーザに対してサービスを提供するのに対し、それらの
パッケージははMacのユーザにサービスを提供する。これらのパッケージ、Sambaと
Linux(と他のUNIXベースのシステム)についての詳細は、
<ulink noescape="1" url="http://www.eats.com/linux_mac_win.html">http://www.eats.com/linux_mac_win.html.</ulink>
を参照のこと。
</para>

<para>Macintoshの新しいバージョン (Mac OS X) はSambaが含まれる</para>

</sect1>

<sect1>
<title>OS2 Client</title>

	<sect2>
		<title>OS/2 Warp Connect または OS/2 Warp 4の設定</title>

		<para>基本的に以下の3つのコンポーネントが必要である:</para>
		
		<itemizedlist>
			<listitem><para>The File and Print Client (IBM peer)</para></listitem>
			<listitem><para>TCP/IP (Internet support) </para></listitem>
			<listitem><para>The <quote>NetBIOS over TCP/IP</quote> driver (TCPBEUI)</para></listitem>
		</itemizedlist>
		
		<para>Warpマニュアル中で説明されているblankシステム上に、ベースOSと共に
		最初の2つを一緒にインストールする。もしもWarpがすでにインストールされて
		いるが、ネットワークサポートを使いたいならば、<quote>System Setup</quote>
		フォルダ中の<quote>Selective Install for Networking</quote>オブジェクトを
		使うこと。</para>

		<para>マニュアルに書いていない、オンラインのドキュメントにもほとんど
		書いていない、<quote>NetBIOS over TCP/IP</quote>を追加する。
		<command>MPTS.EXE</command>を開始し、<guiicon>OK</guiicon>をクリックし、
		<guimenu>Configure LAPS</guimenu>をクリックし、
		<guilabel>Protocols</guilabel>中の
		<guimenu>IBM OS/2 NETBIOS OVER TCP/IP</guimenu>をクリックする。
		この行は次に<guilabel>Current Configuration</guilabel>に移動する。
		この行を選択し、<guimenuitem>Change number</guimenuitem>をクリックし、
		値を0から1に増やす。この設定を保存する。</para>

		<para>もしも、Sambaサーバがローカルサブネット上にない場合、
		<guimenu>Names List</guimenu>にそれらのサーバのIP名とアドレスを
		追加するか、WINSサーバ(IBMとRFCの用語ではNetBIOS Nameserver)を指定する
		事も可能である。Warp Connectでは、Warp 4と同じレベルにするために、
		<constant>IBM Peer</constant>に対するアップデートをダウンロードする
		必要があるかもしれない。IBM OS/2 Warp Webページを参照のこと。</para>
	</sect2>
	
	<sect2>
		<title>他のOS/2バージョンでの設定</title>
	
		<para>この節では、OS/2 Warp 3(Connectでない)、OS/2 1.2、1.3、
		  あるいは2.xの設定について記述する。</para>
		
		<para>
		<ulink noescape="1" url="ftp://ftp.microsoft.com/BusSys/Clients/LANMAN.OS2/">
                ftp://ftp.microsoft.com/BusSys/Clients/LANMAN.OS2/</ulink>にある、
		OS/2用の、自由に使えるMicrosoft LAN Manager 2.2cクライアントを使うことが
		できる。nutshellで、OS/2 ブートパーティションのrootディレクトリ中にある
		<filename>\OS2VER</filename>ファイルを編集し、クライアントインストールの
		前に、以下の行を追加する:</para>
		
		<para><programlisting>
		20=setup.exe
		20=netwksta.sys
		20=netvdd.sys
		</programlisting></para>
		
		<para>また、バグだらけなので同梱されているNE2000ドライバを使ってはならない。
		その代わりに、
		<ulink noescape="1" url="ftp://ftp.cdrom.com/pub/os2/network/ndis/">
                ftp://ftp.cdrom.com/pub/os2/network/ndis/</ulink>からNE2000かNS2000
		ドライバをダウンロードする。
		</para>
	</sect2>
	
	<sect2>
		<title>OS/2クライアント用のプリンタドライバのダウンロード</title>

		<para>誰でもが書き込み可能な、<smbconfsection name="[PRINTDRV]"/>という
		共有を作成する。そこに使用しているOS/2ドライバファイルをコピーする。
		<filename>.EA_</filename>ファイルは引き続き分離しなければならないので、
		オリジナルのインストールファイルを使う必要があり、OS/2システムからの
		インストールされたドライバをコピーしてはいけない。</para>
		
		<para>そのプリンタに対し、NTドライバを最初にインストールする。次に、
		使用している&smb.conf;に、パラメータ
		<smbconfoption name="os2 driver map"><replaceable>filename</replaceable></smbconfoption>
		を追加する。次に、<replaceable>filename</replaceable>で指定されるファイル中に、
		以下のようにNTドライバ名をOS/2ドライバ名にマップするように記述する:</para>
		
		<para><parameter><replaceable>nt driver name</replaceable> = <replaceable>os2 driver name</replaceable>.<replaceable>device name</replaceable></parameter>, e.g.,</para>

		<para><parameter>
		HP LaserJet 5L = LASERJET.HP LaserJet 5L</parameter></para>

		<para>このファイル中にマップされた複数のドライバを定義できる。</para>
	
		<para>もしも、OS/2ドライバ名のみを指定し、デバイス名を指定しない場合、
		ドライバを最初にダウンロードするときには、実際にファイルをダウンロード
		するが、OS/2クライアントは、ドライバが有効でないと表示する。2回目に
		ダウンロードするときには動く。これは、マッピングにデバイス名を追加する
		ことにより簡単に解決し、その後、最初のダウンロード要求で動くようになる。
		</para>
	</sect2>
</sect1>

<sect1>
<title>Windows for Workgroups</title>

<sect2>
<title>Microsoftからの最新版 TCP/IPスタック</title>

<para>もしもWindows for Workgroupsを使うのであれば、Microsoftから最新のTCP/IPスタックを
使う。古いTCP/IPスタックにはたくさんのバグがある。</para>

<para> 
MicrosoftはそのTCP/IP 32ビットVxDドライバの増分更新を公開している。最新のリリースは、
ftp.microsoft.comの<filename>/Softlib/MSLFILES/TCP32B.EXE</filename>にある。そこには
修正された問題について説明してあるupdate.txtがある。そこには更新された
<filename>WINSOCK.DLL</filename>, <filename>TELNET.EXE</filename>, <filename>WSOCK.386</filename>,
<filename>VNBT.386</filename>, <filename>WSTCP.386</filename>, <filename>TRACERT.EXE</filename>,
<filename>NETSTAT.EXE</filename>,<filename>NBTSTAT.EXE</filename>ファイルがある。
</para>

<para>
このパッチについての詳細情報は、
<ulink url="http://support.microsoft.com/kb/q99891/">Knowledge Base article 99891</ulink>
にある。
</para>

</sect2>

<sect2>
<title>パスワード変更後に.pwlファイルの削除</title>

<para>
Windows for Workgroupsは、パスワード管理の出来が悪い。UNIXマシンかPCのどちらかで
パスワードを変更した時、最も安全にするにはWindowsディレクトリ中の.pwlファイルを
削除することである。PCはそのファイルが見つからないと警告を出すが、間もなく、
新しいパスワードが入力できるようになる。
</para>

<para> 
もしもこれをしないと、新しいものを入れても、Windows for Workgroupsは古いパスワードを
記憶してそれを使うようになるかもしれない。
</para>

<para> 
しばしばWindows for Workgroupsはダイアログボックス中で入力したパスワードを完全に無視する。
</para>

</sect2>

<sect2>
<title>Windows for Workgroupsにおけるパスワードの取り扱い方法の設定</title>

<para>
<indexterm><primary>admincfg.exe</primary></indexterm>
WFS 3.11ディスクセットの最後のディスク(8枚目)に、<filename>admincfg.exe</filename>という
プログラムがある。これをインストールするためには、
<userinput>EXPAND A:\ADMINCFG.EX_ C:\WINDOWS\ADMINCFG.EXE</userinput>と入力する。
次に、<application>Program Manager</application>の<guimenu>New</guimenu>経由でアイコンを
追加する。このプログラムは、どのようにWFWがパスワードを扱うか、パスワードのキャッシュを
無効にするなどを、<smbconfoption name="security">user</smbconfoption>用に制御する。
</para>

</sect2>

<sect2>
<title>パスワードにおける大文字小文字の区別</title>

<para>Windows for Workgroupsはサーバに送る前にパスワードをすべて大文字にする。しかし、
UNIXのパスワードは大文字小文字を区別する。チェックするときにどの文字をSambaが大文字と
して試すべきかを指定するための、<smbconfoption name="password level"/>上の
&smb.conf;情報をチェックすること。

</sect2>

<sect2>
<title>既定値のプロトコルとしてTCP/IPの使用</title>

<para>印刷キューの通知をサポートするために、Windows for Workgroups下でTCP/IPを
既定値のプロトコルとして使う事が必要である。もしもNetBEUIを既定値のままにすると、
あるシステム上では印刷キューの通知がうまくいかない。これはおそらく
Windows for Workgroupsのバグであろう。</para>

</sect2>

<sect2 id="speedimpr">
<title>処理速度の改善</title>

<para>
ある人によると、Windows for Workgroupsの中にある<filename>SYSTEM.INI</filename>ファイルの
<smbconfsection name="[MSTCP]"/>セクション中に<parameter>DefaultRcvWindow</parameter>の
設定を3072にすると、速度が大幅に改善したと報告している。
</para>

<para>
実際にDefaultRcvWindowについて実験してみたら、より大きな値(16384かそれ以上)の値を使うと
より処理速度が改善した。他の人は、3072より大きな値は、かえって大幅にスピードが落ちると
報告している。ある人の報告では、3072から8192間での間で、30の倍数の時にスピードが落ちる
というものもあった。
</para>
</sect2>
</sect1>

<sect1>
<title>Windows 95/98</title>

<para>
When using Windows 95 OEM SR2, the following updates are recommended where Samba
is being used. Please note that the changes documented in 
<link linkend="speedimpr">Speed Improvement</link> will affect you once these
updates  have been installed.
</para>

<para> 
There are more updates than the ones mentioned here. Refer to the
Microsoft Web site for all currently available updates to your specific version
of Windows 95.
</para>

<simplelist>
<member>Kernel Update: KRNLUPD.EXE</member>
<member>Ping Fix: PINGUPD.EXE</member>
<member>RPC Update: RPCRTUPD.EXE</member>
<member>TCP/IP Update: VIPUPD.EXE</member>
<member>Redirector Update: VRDRUPD.EXE</member>
</simplelist>

<para>
Also, if using <application>MS Outlook,</application> it is desirable to 
install the <command>OLEUPD.EXE</command> fix. This
fix may stop your machine from hanging for an extended period when exiting
Outlook, and you may notice a significant speedup when accessing network
neighborhood services.
</para>

<sect2>
<title>Speed Improvement</title>

<para>
Configure the Windows 95 TCP/IP registry settings to give better
performance. I use a program called <command>MTUSPEED.exe</command> that I got off the
Internet. There are various other utilities of this type freely available.
</para>

</sect2>

</sect1>

<sect1>
<title>Windows 2000 Service Pack 2</title>

<para> 
There are several annoyances with Windows 2000 SP2, one of which
only appears when using a Samba server to host user profiles
to Windows 2000 SP2 clients in a Windows domain. This assumes
that Samba is a member of the domain, but the problem will
most likely occur if it is not.
</para>

<para> 
In order to serve profiles successfully to Windows 2000 SP2 
clients (when not operating as a PDC), Samba must have 
<smbconfoption name="nt acl support">no</smbconfoption>
added to the file share that houses the roaming profiles.
If this is not done, then the Windows 2000 SP2 client will
complain about not being able to access the profile (Access 
Denied) and create multiple copies of it on disk (DOMAIN.user.001,
DOMAIN.user.002, and so on). See the &smb.conf; man page
for more details on this option. Also note that the 
<smbconfoption name="nt acl support"/> parameter was formally a global parameter in
releases prior to Samba 2.2.2.
</para>

<para> 
<link linkend="minimalprofile">Following example</link> provides a minimal profile share.
</para>

<example id="minimalprofile">
<title>Minimal Profile Share</title>
<smbconfblock>
<smbconfsection name="[profile]"/>
<smbconfoption name="path">/export/profile</smbconfoption>
<smbconfoption name="create mask">0600</smbconfoption>
<smbconfoption name="directory mask">0700</smbconfoption>
<smbconfoption name="nt acl support">no</smbconfoption>
<smbconfoption name="read only">no</smbconfoption>
</smbconfblock>
</example>

<para>
The reason for this bug is that the Windows 200x SP2 client copies
the security descriptor for the profile that contains
the Samba server's SID, and not the domain SID. The client
compares the SID for SAMBA\user and realizes it is
different from the one assigned to DOMAIN\user; hence,
<errorname>access denied</errorname> message.
</para>

<para>
When the <smbconfoption name="nt acl support"/> parameter is disabled, Samba will send
the Windows 200x client a response to the QuerySecurityDescriptor trans2 call, which causes the client
to set a default ACL for the profile. This default ACL includes:
</para>

<para><emphasis>DOMAIN\user 	<quote>Full Control</quote></emphasis>></para>

<note><para>This bug does not occur when using Winbind to
create accounts on the Samba host for Domain users.</para></note>

</sect1>

<sect1>
<title>Windows NT 3.1</title>

<para>If you have problems communicating across routers with Windows 
NT 3.1 workstations, read <ulink url="http://support.microsoft.com/default.aspx?scid=kb;Q103765">this Microsoft Knowledge Base article:</ulink>.

</para>

</sect1>

</chapter>
