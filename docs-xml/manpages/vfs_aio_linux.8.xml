<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE refentry PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<refentry id="vfs_aio_linux.8">

<refmeta>
	<refentrytitle>vfs_aio_linux</refentrytitle>
	<manvolnum>8</manvolnum>
	<refmiscinfo class="source">Samba</refmiscinfo>
	<refmiscinfo class="manual">システム管理ツール</refmiscinfo>
	<refmiscinfo class="version">4.0</refmiscinfo>
</refmeta>


<refnamediv>
	<refname>vfs_aio_linux</refname>
	<refpurpose>Linux kernel aio コールを利用するSamba vfs中での非同期I/Oの実装</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<cmdsynopsis>
		<command>vfs objects = aio_linux</command>
	</cmdsynopsis>
</refsynopsisdiv>

<refsect1>
	<title>説明</title>

	<para>このVFSモジュールは
	<citerefentry><refentrytitle>samba</refentrytitle>
	<manvolnum>7</manvolnum></citerefentry>システムの一部である。</para>

	<para><command>aio_linux</command> VFS モジュールは、POSIX AIOインタフェースを
	使わない、kernel AIO コールが有効なLinuxカーネル上でSamba用の非同期I/Oを有効に
	する。Posix AIO はきつい制限がある。たとえば、あるLinuxバージョン上では
        それが使うリアルタイムシグナルは、高負荷の時には動作しない。glibc(ほとんどの
        Linuxシステム)ベースのシステムは、glibc実装を使うシステム上でPosix AIOが本質的に
	無効になってしまう、ファイル記述子あたり単一の未処理要求のみ許可される。</para>

	<para>これらすべての制限を回避するために、aio_linux モジュールが書かれた。
	これは、非同期に、読み出しと書き込み呼び出しを許可するため、内部の POSIX AIO
	インタフェースの代わりに Linux kernel AIO インタフェースを使う。
	128イベントのキューサイズは既定値として使われる。この制限を変更するためには、
	以下で述べる"aio num events"を設定する。
	</para>

	<para>
	smb.conf パラメーター<command>aio read size</command>と
	<command>aio write size</command>は、このモジュールを有効にするために、
	適切に設定することも必要であるということに注意。
	</para>

	<para>このモジュールは、Samba VFS pread/pwrite インタフェースがスレッドセーフで
	ないため、他のモジュールスタックの後に配置しなければならない。このモジュールは
	直接preadとpwriteシステムコールを呼び出し、Samba VFS pread と pwriteインタフェースを
	使わないことに注意。</para>

</refsect1>


<refsect1>
	<title>使用例</title>

	<para>簡単な使い方:</para>

<programlisting>
        <smbconfsection name="[cooldata]"/>
	<smbconfoption name="path">/data/ice</smbconfoption>
	<smbconfoption name="aio read size">1024</smbconfoption>
	<smbconfoption name="aio write size">1024</smbconfoption>
	<smbconfoption name="vfs objects">aio_linux</smbconfoption>
</programlisting>

</refsect1>

<refsect1>
	<title>オプション</title>

	<variablelist>

		<varlistentry>
		<term>aio_linux:aio num events = INTEGER</term>
		<listitem>
		<para>未処理のIO要求を制限するために使われる、イベントキューの
		最大値を設定する。
		</para>
		<para>既定値は 128 である。</para>
		</listitem>
		</varlistentry>

	</variablelist>
</refsect1>
<refsect1>
	<title>バージョン</title>

	<para>このマニュアルページは、バージョン 4.0.0 のSambaシステム用である。
	</para>
</refsect1>

<refsect1>
	<title>著者</title>

	<para>オリジナルの Samba ソフトウェアと関連するユーティリティは、Andrew
	Tridgell によって作成された。現在 Samba は Samba Team に
	よって、Linuxカーネルの開発と同様のオープンソースプロジェクト
	として開発が行なわれている。</para>

</refsect1>

<refsect1>
	<title>日本語訳</title>
	<para>このマニュアルページは、Samba 4.0.0 対応のものである。</para>	
    <para>このドキュメントの翻訳は
		<itemizedlist>
			<listitem><para>太田俊哉 (ribbon@samba.gr.jp)</para></listitem>
		</itemizedlist>	
        によって行なわれた。</para>
</refsect1>

</refentry>
