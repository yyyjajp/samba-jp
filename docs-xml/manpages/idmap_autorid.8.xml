<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE refentry PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<refentry id="idmap_autorid.8">

<refmeta>
	<refentrytitle>idmap_autorid</refentrytitle>
	<manvolnum>8</manvolnum>
	<refmiscinfo class="source">Samba</refmiscinfo>
	<refmiscinfo class="manual">システム管理ツール</refmiscinfo>
	<refmiscinfo class="version">4.0</refmiscinfo>
</refmeta>


<refnamediv>
	<refname>idmap_autorid</refname>
	<refpurpose>Samba の Winbind 用 idmap_autoridバックエンド</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<title>説明</title>
	<para>The idmap_autorid backend provides a way to use an algorithmic
	mapping scheme to map UIDs/GIDs and SIDs that is more deterministic
	than idmap_tdb and easier to configure than idmap_rid.</para>
	<para>idmap_autoridバックエンドは、idmap_tdbよりもより確実に決まる、UID/GIDと
	SIDをマップするためのアルゴリズム的なマッピング方法を提供し、idmap_rid
	よりもより簡単に設定できる。</para>
	<para>The module works similar to idmap_rid, but it automatically
	configures the range to be used for each domain, so there is no need
	to specify a specific range for each domain in the forest, the only
	configuration that is needed is the range of uid/gids that shall
	be used for user/group mappings and an optional size of the ranges
	to be used.</para>
	<para>モジュールはidmap_ridと同じように動作するが、各ドメインに対して使われる
	レンジを自動的に設定するので、フォレスト中の各ドメインに対しては、
	特定のレンジを指定する必要がなく、唯一設定できる項目は、
	user/groupマッピングのために使われることができるuid/gidのレンジと、
	オプションの、レンジのサイズである。</para>
	<para>The mappings of which domain is mapped to which range is stored
	in autorid.tdb, thus you should backup this database regularly.</para>
	<para>ドメインのマッピングはレンジにマップされ、それはautorid.tdbに
	格納されるので、このデータベースを常時バックアップする必要がある。</para>
	<para>Due to the algorithm being used, it is the module that is
	most easy to use as it only requires a minimal configuration.</para>
	<para>アルゴリズムによって処理が行われるので、これは、最小の設定のみで済む、
	もっとも簡単に使うことが出来るモジュールである。
	</para>
</refsynopsisdiv>

<refsect1>
	<title>IDMAP オプション</title>

	<variablelist>
		<varlistentry>
		<term>rangesize = numberofidsperdomain</term>
		<listitem><para>
			Defines the available number of uids/gids per domain. The
			minimum needed value is 2000. SIDs with RIDs larger than this
			value cannot be mapped, are ignored and the corresponding map
			is discarded. Choose this value carefully, as this should
			not be changed after the first ranges for domains have been
			defined, otherwise mappings between domains will get intermixed
			leading to unpredictable results. Please note that RIDs in Windows
			Domains usually start with 500 for builtin users and 1000
			for regular users. As the parameter cannot be changed later, please
			plan accordingly for your expected number of users in a domain
			with safety margins.</para>
			<para>ドメイン毎のuid/gidの有効範囲を定義する。一番小さい値は2000
			である。この値より大きいRIDを伴うSIDはマップされず、無視され、
			対応するマップは無視される。これはドメインのための最初のレンジ
			が定義された後に変更すべきではないため、この値は十分に注意して
                        選ばなければならず、そうでないと、ドメイン間のマッピングは、
                        予知できない結果によりまぜこぜになってしまうだろう。
                        WindowsドメインのRIDは通常、ビルトインユーザーでは500から、
                        通常のユーザーは1000から始まることに注意してほしい。後でパラメーター
                        の値を変えられないため、安全なマージンをとって、予想される
                        ドメイン中のユーザー数に対応するように設定を行ってほしい。
		</para>
                <para>One range will be used for local users and groups and for
                      non-domain well-known SIDs like Everyone (S-1-1-0) or Creator Owner (S-1-3-0).
                     A chosen list of well-known SIDs will be preallocated on first start
                     to create deterministic mappings for those.</para>
		<para>
                Thus the number of local users and groups that can be created is
                limited by this option as well. If you plan to create a large amount
                of local users or groups, you will need set this parameter accordingly.
		</para>
		<para>1つのレンジはローカルユーザーとグループ用と、Everyone (S-1-1-0)
		あるいは Creator Owner (S-1-3-0) のような、非ドメインでの、よく使われる
		SIDに使われる。選択されたよく使われるSIDのリストは、それらのマッピングを
		作成する時に、最初に事前割り当てされる。</para>
		<para>
		それゆえ、作成出来るローカルユーザーとグループの数は、このオプションに
		よって制限される。もしも、ローカルユーザーとグループを大量に作る計画が
		あるならば、このパラメーターを適切に設定する必要がある。
                </para>
		<para>既定値は 100000である。</para>
		</listitem>
		</varlistentry>
                <varlistentry>
                <term>read only = [ yes | no ]</term>
                <listitem><para>Turn the module into read-only mode. No new ranges will be allocated
                nor will new mappings be created in the idmap pool. Defaults to no.</para>
		<para>モジュールをリードオンリモードにする。idmap poolには、新規のレンジを
		割り当てる事も、新しいマッピングを作成する事もできない。既定値は no で
		ある。</para>
		</listitem>
		</varlistentry>
	</variablelist>
</refsect1>

<refsect1>
	<title>マッピング作成方法</title>
	<para>
		The Unix ID for a RID is calculated this way:
		RIDのためのUnix IDは以下の方法で計算される:
		<programlisting>
			ID = IDMAP UID LOW VALUE + DOMAINRANGENUMBER * RANGESIZE + RID
		</programlisting>
	</para>
	<para>
		Correspondingly, the formula for calculating the RID for a
		given Unix ID is this:
		同じように、与えられたUnix IDのためのRID計算方式は
		以下のようになる:
		<programlisting>
			RID = ID - IDMAP UID LOW VALUE - DOMAINRANGENUMBER * RANGESIZE
		</programlisting>
	</para>
</refsect1>

<refsect1>
	<title>設定例</title>
	<para>
		This example shows you the minimal configuration that will
		work for the principial domain and 19 trusted domains.
		この例はプリンシパルドメインと19の信頼されたドメインのために
		動作する最低限の設定例である。
	</para>

	<programlisting>
	[global]
	security = ads
	workgroup = CUSTOMER
	realm = CUSTOMER.COM

        idmap config * : backend = autorid
        idmap config * : range = 1000000-1999999

	</programlisting>

	<para>
		This example shows how to configure idmap_autorid as default
		for all domains with a potentially large amount of users
		plus a specific configuration for a trusted domain
		that uses the SFU mapping scheme. Please note that idmap
		ranges and sfu ranges are not allowed to overlap.
	</para>
	<para>
		この例は、大量のユーザーが存在しうるすべてのドメインと、それに
		加えて、SFUマッピング方法を使う信頼されたドメインのための
		特定の設定のために、既定値としてidmap_autoridを設定する方法を
		示す。idmapレンジとsfuレンジはオーバーラップが許されない
		事に注意してほしい。
	</para>

	<programlisting>
	[global]
	security = ads
	workgroup = CUSTOMER
	realm = CUSTOMER.COM

        idmap config * : backend = autorid
        idmap config * : range = 1000000-19999999
	autorid:rangesize = 1000000

	idmap config TRUSTED : backend  = ad
	idmap config TRUSTED : range    = 50000 - 99999
	autorid:rangesize = 1000000
	</programlisting>

</refsect1>

<refsect1>
	<title>著者</title>

        <para>
    オリジナルの Samba ソフトウェアと関連ユーティリティは、Andrew Tridgell
    により書かれた。Samba は現在 Samba チームの元で、Linux のカーネルと
    同様にオープンソースソフトウェアとして開発されている。
        </para>

</refsect1>

<refsect1>
    <title>日本語訳</title>
    <para>このマニュアルページは Samba 4.0.6 - 4.0.14 に対応する。</para>
        <para>このドキュメントの翻訳は
    <itemizedlist>
        <listitem><para>太田俊哉(ribbon@samba.gr.jp)</para></listitem>
    </itemizedlist>
        によって行なわれた。</para>
</refsect1>

</refentry>
