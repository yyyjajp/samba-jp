<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE refentry PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<refentry id="idmap_ad.8" lang="ja">

<refmeta>
	<refentrytitle>idmap_ad</refentrytitle>
	<manvolnum>8</manvolnum>
	<refmiscinfo class="source">Samba</refmiscinfo>
	<refmiscinfo class="manual">システム管理ツール</refmiscinfo>
	<refmiscinfo class="version">4.6</refmiscinfo>>
</refmeta>


<refnamediv>
	<refname>idmap_ad</refname>
	<refpurpose>Winbind用のSambaの idmap_adバックエンド</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<title>説明</title>
	<para>idmap_ad プラグインは、RFC2307/SFU スキーマ拡張を使う AD サーバーからの
	id マッピングを Winbind が読み出す手段を提供する。このモジュールは &quot;idmap&quot;
	API 実装するだけであり、読み取り機能のみである。
	マッピングは、ユーザに対応する uidNumber 属性と、グループに対応する
	gidNumbe 属性を、AD 中に、管理者によって
	前もって追加されることが必要である。Winbind は、 uidNumber を
	持ち、かつ、そのプライマリグループが、  gidNumber 属性に設定されて
	いるユーザのみをマップする。しかしながら、使用指定するすべての
	グループが、 gidNumber 属性を持つことを推奨する。</para>

        <para>
	現在 <parameter>ad</parameter> バックエンドは idmap バックエンドの既定値には
	なっていない。ドメインにおいてこれを利用する場合は、すべてのドメインにわたって
	idmap の設定範囲が重複しないように設定する必要がある。
	また、BUILTIN sid や他の信頼されたドメインをマップ出来るようにするため、
	たとえば <parameter>tdb</parameter> バックエンドや <parameter>ldap</parameter> 
	バックエンドを用いる場合には、	書き込み可能な 既定値の idmap 範囲を
	設定するのが普通である。
	書き込み可能な既定値の 設定は、グループマッピングを作成するためにも
	必要である。この包括的な
	既定値の idmap 設定は、idmap バックエンド <parameter>ad</parameter> を使う
	任意の明示的に設定されたドメインから disjoint された設定範囲でなければならない。
	以下の例を参照のこと。</para>

</refsynopsisdiv>

<refsect1>
	<title>IDMAP オプション</title>

	<variablelist>
		<varlistentry>
		<term>range = low - high</term>
		<listitem><para>
			このバックエンドが割り当て権限をもつ UID および GID の範囲を定義する。
			この範囲はフィルターとして処理されることに注意。
			AD 内に格納される、指定された任意の UID または GID が
			レンジを外れていると、この範囲指定は無視され、対応する
			マップは破棄される。これは、
			ローカルとリモートで定義された ID が、偶然 UID/GID が重なって
			しまうことを防ぐという意図がある。
		</para></listitem>
		</varlistentry>
		<varlistentry>
		<term>schema_mode = &lt;rfc2307 | sfu | sfu20&gt;</term>
		<listitem><para>
                                                                        			Active Directory に関するユーザーとグループ情報を問い合わせるときに、idmap_adを
		使うべきであるスキーマを定義する。これは、Windows 2003 R2またはService for Unix(SFU)
スキーマ中に含まれているRFC2307スキーマサポートよりも簡単である。
    SFU 3.0と3.5は、"sfu" を、SFU 2.0は、"sfu20"を選択すること。
    プライマルグループメンバーシップの動作は、<emphasis>unix_primary_group</emphasis>
    オプションによって制御されることに注意。
		</para></listitem>
		</varlistentry>
                <varlistentry>
                <term>unix_primary_group = yes/no</term>
                <listitem><para>
		ユーザのプライマリグループを、SFU属性か、あるいはADのプライマリグループ
		から取り出すかの定義。これが<parameter>yes</parameter>に設定された
		場合、プライマリグループメンバシップは LDAP属性 (gidNumber)から
		取り出される。
		<parameter>no</parameter>に設定された場合には、プライマリグループ
		メンバシップは "primaryGroupID" LDAP 属性から計算される。
               </para>
               <para>既定値: no</para>
               </listitem>
               </varlistentry>
               <varlistentry>
               <term>unix_nss_info = yes/no</term>
               <listitem>
	       <para>これを<parameter>yes</parameter>に設定した場合、winbind は
	       LDAP 属性からログインシェルとホームディレクトリ情報を検索する。
	       <parameter>no</parameter>に設定した場合か、 AD の LDAP エントリに
	       SFU 属性がない場合は、オプション <emphasis>template shell</emphasis>と
	       <emphasis>template homedir</emphasis>が使われる。
	       </para>
               <para>既定値: no</para>
                </listitem>
               </varlistentry>
	</variablelist>
</refsect1>

<refsect1>
	<title>使用例</title>
	<para>
        以下の例は、プリンシパルと信頼された AD ドメインから相対的な id マッピングを
	検索する方法を示している。もしも、信頼されたドメインが存在する id と競合するならば、
	それは、あらかじめ解決されていなければならず、順番が競合したマッピングはその時点
	で解決されていることについては何らの保証もない。

	この例はまた、どのように、BULITINのような内部のバックエンドを使うことが出来る
ローカルのid割り当てのために競合しない小さなレンジを残すための方法を示している。</para>

	<programlisting>
	[global]
	workgroup = CORP
        idmap config * : backend = tdb
        idmap config * : range = 1000000-1999999

	idmap config CORP : backend  = ad
	idmap config CORP : range = 1000-999999
	</programlisting>
</refsect1>

<refsect1>
	<title>著者</title>

	<para>
オリジナルの Samba ソフトウェアと関連するユーティリティは、 Andrew Tridgell によって作成された。現在 Samba は Samba Team によって、 Linux カーネルの開発と同様のオープンソースプロジェクトとして開発が 行なわれている。</para>
</refsect1>
<refsect1>
	<title>日本語訳</title>
	<para>このマニュアルページは Samba 4.6.2 - 4.6.6  に対応する。</para>
        <para>このドキュメントの翻訳は
	<itemizedlist>
		<listitem><para>武田保真</para></listitem>
		<listitem><para>たかはしもとのぶ</para></listitem>
		<listitem><para>太田俊哉(ribbon@samba.gr.jp)</para></listitem>
	</itemizedlist>	
        によって行なわれた。</para>
</refsect1>
</refentry>
