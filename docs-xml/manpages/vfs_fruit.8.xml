<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE refentry PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<refentry id="vfs_fruit.8" lang="ja">

<refmeta>
	<refentrytitle>vfs_fruit</refentrytitle>
	<manvolnum>8</manvolnum>
	<refmiscinfo class="source">Samba</refmiscinfo>
<!-- 原文 samba-4.4.15
	<refmiscinfo class="manual">System Administration tools</refmiscinfo>
-->
	<refmiscinfo class="manual">システム管理ツール</refmiscinfo>
	<refmiscinfo class="version">4.4</refmiscinfo>
</refmeta>


<refnamediv>
	<refname>vfs_fruit</refname>
<!-- 原文 samba-4.4.15
	<refpurpose>Enhanced OS X and Netatalk interoperability</refpurpose>
-->
	<refpurpose>OS X と Netatalk との相互運用性を強化する</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<cmdsynopsis>
		<command>vfs objects = fruit</command>
	</cmdsynopsis>
</refsynopsisdiv>

<refsect1>
<!-- 原文 samba-4.4.15
	<title>DESCRIPTION</title>
-->
	<title>説明</title>

<!-- 原文 samba-4.4.15
	<para>This VFS module is part of the
	<citerefentry><refentrytitle>samba</refentrytitle>
	<manvolnum>7</manvolnum></citerefentry> suite.</para>
-->
	<para>この VFS モジュールは
	<citerefentry><refentrytitle>samba</refentrytitle>
	<manvolnum>7</manvolnum></citerefentry> システムの一部である。</para>

<!-- 原文 samba-4.4.15
	<para>The <command>vfs_fruit</command> module provides
	enhanced compatibility with Apple SMB clients and
	interoperability with a Netatalk 3 AFP fileserver.</para>
-->
	<para><command>vfs_fruit</command> モジュールは、Apple SMB クライアント
	との互換性向上と、Netatalk 3 AFP ファイルサーバーとの相互運用性を提供する。
	</para>

<!-- 原文 samba-4.4.15
	<para>The module should be stacked with
	<command>vfs_catia</command> if enabling character conversion and
	must be stacked with <command>vfs_streams_xattr</command>, see the
	example section for the correct config.</para>
-->
	<para>このモジュールは、もしも文字変換をするのであれば、
	<command>vfs_catia</command> といっしょに使うべきであり、さらに、
	<command>vfs_streams_xattr</command> と共に使わなければならない。
	正しい設定方法は、例 の節を参照のこと。</para>

<!-- 原文 samba-4.4.15
	<para>The module enables alternate data streams (ADS) support
	for a share, intercepts the OS X special streams "AFP_AfpInfo"
	and "AFP_Resource" and handles them in a special way. All
	other named streams are deferred to
	<command>vfs_streams_xattr</command> which must be loaded
	together with <command>vfs_fruit</command>.</para>
-->
	<para>モジュールは、共有に対して、代替データストリーム (ADS)
	のサポートと、OS X 特有のストリーム "AFP_AfpInfo" と "AFP_Resource"
	を横取りし、それを特別な方法で扱う機能を有効にする。
	その他すべての名前付きストリームは、<command>vfs_fruit</command>
	といっしょにロードされねばならない <command>vfs_streams_xattr</command>
	にゆだねられる。</para>

<!-- 原文 samba-4.4.15
	<para>Having shares with ADS support enabled for OS X client
	is worthwhile because it resembles the behaviour of Apple's
	own SMB server implementation and it avoids certain severe
	performance degradations caused by Samba's case sensitivity
	semantics.</para>
-->
	<para>OS X クライアントに対する、ADS サポートが有効な共有
	があると言うことは、Apple 固有の SMB サーバ実装の動作と似て、
	Samba が大文字と小文字を区別することにより引き起こされる
	深刻なパフォーマンスの低下を回避すると言う点において価値がある。
	</para>

<!-- 原文 samba-4.4.15
	<para>The OS X metadata and resource fork stream can be stored
	in a way compatible with Netatalk 3 by setting
	<command>fruit:resource = file</command> and
	<command>fruit:metadata = netatalk</command>.</para>
-->
	<para>OS X メタデータとリソースフォークストリームは、Netatalk 3 と
	互換性のある方法で、下記のように設定することにより格納される。
	<command>fruit:resource = file</command> と
	<command>fruit:metadata = netatalk</command></para>

<!-- 原文 samba-4.4.15
	<para>OS X maps NTFS illegal characters to the Unicode private
	range in SMB requests. By setting <command>fruit:encoding =
	native</command>, all mapped characters are converted to
	native ASCII characters.</para>
-->
	<para>OS X は、NTFS の不正な文字を、SMB 要求中で、Unicode
	のプライベート領域にマップする。
	<command>fruit:encoding = native</command> を設定することにより、
	すべてのマップされた文字は ネイティブな ASCII 文字に変換される。
	</para>

<!-- 原文 samba-4.4.15
	<para>Finally, share access modes are optionally checked
	against Netatalk AFP sharing modes by setting
	<command>fruit:locking = netatalk</command>.</para>
-->
	<para>最後に、共有アクセスモードは、
	<command>fruit:locking = netatalk</command>
	を設定することにより、Netatalk AFP 共有モードに対して
	チェックすることもできる。</para>

<!-- 原文 samba-4.4.15
	<para>This module is not stackable other then described in
	this manpage.</para>
-->
	<para>このモジュールは、このマニュアルページで言及されている
	もの以外に対してはスタックできない。</para>

</refsect1>

<refsect1>
<!-- 原文 samba-4.4.15
	<title>GLOBAL OPTIONS</title>
-->
	<title>グローバルオプション</title>

<!-- 原文 samba-4.4.15
	<para>The following options must be set in the global smb.conf section
	and won't take effect when set per share.</para>
-->
        <para>以下のオプションは smb.conf のグローバルセクションに記述しなければ
	ならず、共有ごとのセクションに設定しても効果がない。</para>

        <variablelist>

          <varlistentry>
            <term>fruit:aapl = yes | no</term>
            <listitem>
<!-- 原文 samba-4.4.15
	      <para>A <emphasis>global</emphasis> option whether to enable Apple's SMB2+
	      extension codenamed AAPL. Default
	      <emphasis>yes</emphasis>. This extension enhances
	      several deficiencies when connecting from Macs:</para>
-->
              <para><emphasis>グローバル</emphasis> オプションで、
	      コードネーム AAPL という、Apple の SMB2+ 拡張を有効にするかを指定する。
	      既定値は <emphasis>yes</emphasis> である。
	      この拡張は、Mac から繋ぐときに、いくつか欠けている点を
	      機能を追加する:</para>

	      <itemizedlist>
<!-- 原文 samba-4.4.15
		<listitem><para>directory enumeration is enriched with
		Mac relevant filesystem metadata (UNIX mode,
		FinderInfo, resource fork size and effective
		permission), as a result the Mac client doesn't need
		to fetch this metadata individuallly per directory
		entry resulting in an often tremendous performance
		increase.</para></listitem>
-->
                <listitem><para>ディレクトリ一覧表示において、
		Mac に関連したファイルシステムメタデータ (UNIX モード、
		ファインダ情報、リソースフォークと実行パーミッション)
		が強化されているため、その結果として、Mac クライアントは
		このメタデータを、個々ののディレクトリエントリごと個別に
		取得する必要はなく、その結果、しばしば大幅にパフォーマンス
		が向上する。
		</para></listitem>

<!-- 原文 samba-4.4.15
		<listitem><para>The ability to query and modify the
		UNIX mode of directory entries.</para></listitem>
-->
                <listitem><para>ディレクトリエントリの UNIX モード情報を
		得たり、変更する機能。</para></listitem>
              </itemizedlist>

<!-- 原文 samba-4.4.15
	      <para>There's a set of per share options that come into play when
	      <emphasis>fruit:aapl</emphasis> is enabled. These opions, listed
	      below, can be used to disable the computation of specific Mac
	      metadata in the directory enumeration context, all are enabled by
	      default:</para>
-->
	      <para><emphasis>fruit:aapl</emphasis> が有効になっているときに
	      使える、共有単位のオプションがある。以下で説明する、それらの
	      オプションは、ディレクトリ一覧表示時に、特定の Mac
	      メタデータの処理を無効にする。なお、それらのオプションにおける
	      既定値は 有効 である: </para>

              <itemizedlist>
                <listitem><para>readdir_attr:aapl_rsize = yes | no</para></listitem>
                <listitem><para>readdir_attr:aapl_finder_info = yes | no</para></listitem>
                <listitem><para>readdir_attr:aapl_max_access = yes | no</para></listitem>
              </itemizedlist>

<!-- 原文 samba-4.4.15
	      <para>See below for a description of these options.</para>
-->
              <para>以下では、上記のオプションの説明を記載する。</para>

            </listitem>
          </varlistentry>

          <varlistentry>
            <term>fruit:nfs_aces = yes | no</term>
            <listitem>
<!-- 原文 samba-4.4.15
	      <para>A <emphasis>global</emphasis> option whether support for
	      querying and modifying the UNIX mode of directory entries via NFS
	      ACEs is enabled, default <emphasis>yes</emphasis>.</para>
-->
	      <para><emphasis>グローバル</emphasis> オプションであり、NFS ACE 経由の、
	      ディレクトリエントリに対する UNIX モードの問合せと変更のサポートが有効化か
	      どうかを指定する。既定値は <emphasis>yes</emphasis> である。
	      </para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>fruit:copyfile = yes | no</term>
            <listitem>
<!-- 原文 samba-4.4.15
	      <para>A <emphasis>global</emphasis> option whether to enable OS X
	      specific copychunk ioctl that requests a copy of a whole file
	      along with all attached metadata.</para>
-->
	      <para><emphasis>グローバル</emphasis> オプションであり、
	      すべての添付されたメタデータとともに、すべてのファイルの
	      コピーを要求する、OS X 固有の copychunk ioctl を有効にするかの
	      指定。</para>
<!-- 原文 samba-4.4.15
	      <para>WARNING: the copyfile request is blocking the
	      client while the server does the copy.</para>.
	      <para>The default is <emphasis>no</emphasis>.</para>
-->
              <para>注意: サーバーがコピー実行中、copyfile 要求は、
	      クライアントをブロックする。</para>
              <para>既定値は <emphasis>no</emphasis> である。</para>
            </listitem>
          </varlistentry>

        </variablelist>
</refsect1>
	      
<refsect1>
<!-- 原文 samba-4.4.15
	<title>OPTIONS</title>
-->
	<title>オプション</title>

<!-- 原文 samba-4.4.15
	<para>The following options can be set either in the global smb.conf section
	or per share.</para>
-->
	<para>以下のオプションは、smb.conf のグローバルセクションか、
	個々の共有セクションに設定できる。</para>
	
	<variablelist>

	  <varlistentry>
	    <term>fruit:resource = [ file | xattr | stream ]</term>
	    <listitem>
<!-- 原文 samba-4.4.15
	      <para>Controls where the OS X resource fork is stored.</para>
-->
	      <para>どこに OSX リソースフォークを格納するかを制御する。</para>


<!-- 原文 samba-4.4.15
	      <para><emphasis>Important: </emphasis>Due to a
	      misspelling in the option parser in all Samba versions
	      4.5 and earlier, this options must be given as
	      <emphasis>fruit:ressource</emphasis>, ie with two
	      <emphasis>s</emphasis>.</para>
-->
              <para><emphasis>重要:</emphasis> Samba バージョン 4.5 以前では、
	      オプション処理においてスペルミスがあったため、このオプションは 
	      <emphasis>fruit:ressource</emphasis> のように <emphasis>s</emphasis>
	      を 2 つ記述する必要がある。</para>

<!-- 原文 samba-4.4.15
	      <para>Users who set this opion to any non-default
	      setting were still using the default setting of
	      <emphasis>file</emphasis> and are advised to adjust
	      their smb.conf to reflect the effective setting and set
	      <emphasis>fruit:ressource=file</emphasis> in their
	      smb.conf. Removing the option line altogether works as
	      well.</para>
-->
	      <para>このオプションを、既定値以外に設定する場合、
	      ひきつづき <emphasis>file</emphasis>
	      の既定値設定を使うので、有効な設定を反映するように、
	      smb.conf を調整し、<emphasis>fruit:ressource=file</emphasis>
	      を追加する事を推奨する。オプション行をすべて削除しても
	      同じように動作する。
	      </para>

<!-- 原文 samba-4.4.15
	      <para>Samba 4.6 will accept both the correct and the
	      wrong spelling, from Samba 4.7 onwards only the correct
	      spelling will be accepted.</para>
-->
              <para>Samba 4.6 では、正しい/間違ったスペル両方とも
	      処理できるが、Samba 4.7 以降では 正しいスペルのみ受け付ける。
	      </para>

<!-- 原文 samba-4.4.15
	      <para>Settings:</para>
-->
              <para>設定:</para>

	      <itemizedlist>
<!-- 原文 samba-4.4.15
		<listitem><para><command>file (default)</command> - use a ._
		AppleDouble file compatible with OS X and
		Netatalk</para></listitem>
-->
		<listitem><para><command>file (既定値)</command> -
		OS X と Netatalk 互換の ._ AppleDouble ファイル
		を使う。</para></listitem>

<!-- 原文 samba-4.4.15
		<listitem><para><command>xattr</command> - use a
		xattr, requires a filesystem with large xattr support
		and a file IO API compatible with xattrs, this boils
		down to Solaris and derived platforms and
		ZFS</para></listitem>
-->
		<listitem><para><command>xattr</command> - 
		拡張属性 (xattr) を使用する。これは、大きなサイズの拡張属性をサポート
		するファイルシステムと、拡張属性に準拠した
		ファイル IO API が必要となる。つまり、
		Solaris と Solaris 派生プラットフォームの ZFS が必須である。
		</para></listitem>

<!-- 原文 samba-4.4.15
		<listitem><para><command>stream (experimental)</command> - pass
		the stream on to the next module in the VFS stack.
		<emphasis>Warning: </emphasis> this option should not be used
		with the <emphasis>streams_xattr</emphasis> module due to the
		extended attributes size limitations of most
		filesytems.</para></listitem>
-->
		<listitem><para><command>stream (実験的)</command> - 
		VFS スタック内において、ストリームを次のモジュールに渡す。
		<emphasis>警告:</emphasis> たいていのファイルシステム
		には拡張属性のサイズ制限があるため、このオプションを
		<emphasis>streams_xattr</emphasis> モジュールとともに利用しないこと。
		</para></listitem>
	      </itemizedlist>

	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>fruit:metadata = [ stream | netatalk ]</term>
	    <listitem>
<!-- 原文 samba-4.4.15
	      <para>Controls where the OS X metadata stream is stored:</para>
-->
	      <para>OS X メタデータストリームが格納される場所を指定する。</para>

	      <itemizedlist>
<!-- 原文 samba-4.4.15
		<listitem><para><command>netatalk (default)</command> - use
		Netatalk compatible xattr</para></listitem>
-->
		<listitem><para><command>netatalk (既定値)</command> - 
		Netatalk 互換の xattr を使う</para></listitem>

<!-- 原文 samba-4.4.15
		<listitem><para><command>stream</command> - pass the
		stream on to the next module in the VFS
		stack</para></listitem>
-->
		<listitem><para><command>stream</command> - 
		VFS スタックの次のモジュールにストリームを渡す</para></listitem>
	      </itemizedlist>

	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>fruit:locking = [ netatalk | none ]</term>
	    <listitem>
	      <para></para>
	      <itemizedlist>
<!-- 原文 samba-4.4.15
		<listitem><para><command>none (default)</command> - no
		cross protocol locking</para></listitem>
-->
		<listitem><para><command>none (既定値)</command> - 
		cross protocol locking を使わない</para></listitem>

<!-- 原文 samba-4.4.15
		<listitem><para><command>netatalk</command> - use
		cross protocol locking with Netatalk</para></listitem>
-->
		<listitem><para><command>netatalk</command> - 
		Netatalk で cross protocol locking を使う</para></listitem>

	      </itemizedlist>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>fruit:encoding = [ native | private ]</term>
	    <listitem>

<!-- 原文 samba-4.4.15
	      <para>Controls how the set of illegal NTFS ASCII
	      character, commonly used by OS X clients, are stored in
	      the filesystem:</para>
-->
	      <para>ファイルシステムに格納される、OS X クライアントで一般的に
	      使われる、不正な NTFS ASCII 文字セットを制御:</para>

	      <itemizedlist>

<!-- 原文 samba-4.4.15
		<listitem><para><command>private (default)</command> -
		store characters as encoded by the OS X client: mapped
		to the Unicode private range</para></listitem>
-->
		<listitem><para><command>private (規定値)</command> -
		OS Xクライアントによってエンコードされた形で文字を格納:
		Unicode プライベート領域にマップされる</para></listitem>

<!-- 原文 samba-4.4.15
		<listitem><para><command>native</command> - store
		characters with their native ASCII
		value</para></listitem>
-->
		<listitem><para><command>native</command> - 
		そのままのASCII値として文字を格納</para></listitem>

	      </itemizedlist>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>fruit:veto_appledouble = yes | no</term>

	    <listitem>
<!-- 原文 samba-4.4.15
	      <para><emphasis>Note:</emphasis> this option only applies when
	      <parameter>fruit:resource</parameter> is set to
	      <parameter>file</parameter> (the default).</para>
-->
              <para><emphasis>参考:</emphasis> このオプションは、
	      <parameter>fruit:resource</parameter> が
	      <parameter>file</parameter> (既定値) に設定されている
	      場合にのみ適用される。</para>


<!-- 原文 samba-4.4.15
	      <para>When <parameter>fruit:resource</parameter> is set to
	      <parameter>file</parameter>, vfs_fruit may create ._ AppleDouble
	      files. This options controls whether these ._ AppleDouble files
	      are vetoed which prevents the client from accessing them.</para>
-->
	      <para><parameter>fruit:resource</parameter> が
	      <parameter>file</parameter> に設定された場合、
	      vfs_fruit は ._ AppleDouble ファイルを生成する。
	      このオプションは、クライアントからファイルに対するアクセスを
	      防ぐために、._ AppleDouble を見えなくする(veto)
	      かを制御する。</para>
	<!-- 重複していた訳: 一時的保存
	    <para> Mac リソースフォークを格納する目的のため、 vfs_fruit それ自身に
	    よって作成された、内部 AppleDouble ファイルの閲覧と変更を、クライアントから
	    防止するため、._ AppleDouble ファイルを見せなくするかどうかの指定。</para>
	-->
<!-- 原文 samba-4.4.15
	      <para>Vetoing ._ files may break some applications, eg
	      extracting Mac ZIP archives from Mac clients failes,
	      because they contain ._ files. Setting this option to
	      false will fix this, but the abstraction leak of
	      exposing the internally created ._ files may have other
	      unknown side effects.</para>
	      <para>The default is <emphasis>yes</emphasis>.</para>
-->
	      <para> ._ ファイルをアクセス不可にすると、いくつかのアプリケーションで
	      誤動作を引き起こすことがある。たとえば、Mac クライアントから
	      Mac ZIP アーカイブのを展開すると、アーカイブ中に ._ ファイルが
	      含まれているために失敗する。
	      このオプションを false にすることでこの問題を回避できるが、
	      内部向けに作成された ._ ファイルが露見してしまうことで
              未知の副作用を引き起こすかもしれない。</para>
	      <para>既定値は <emphasis>yes</emphasis> である。</para>
	<!-- 重複していた訳: 一時的保存
	    <para> ._ ファイルを見せなくすると、いくつかのアプリケーションが動かなくなる
	    ことがある。たとえば、 ._ ファイルを含むため、Mac クライアントからの Mac ZIP
	    の回答は失敗する。このオプションを false に設定すると、これを修正するが、
	    内部的に作成された ._ ファイルの露出をリークする概念は、他の不明な
	    副作用を引き起こすかもしれない。</para>
	    <para>既定値は <emphasis>yes</emphasis> である。</para>
	-->
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>fruit:posix_rename = yes | no</term>
	    <listitem>
<!-- 原文 samba-4.4.15
	      <para>Whether to enable POSIX directory rename behaviour
	      for OS X clients. Without this, directories can't be
	      renamed if any client has any file inside it
	      (recursive!) open.</para>
	      <para>The default is <emphasis>yes</emphasis>.</para>
-->
	      <para>OS X クライアントで、POSIX の改名動作を有効にするかどうかの指定。
	      このオプションを指定しないと、クライアントは、(再帰的にも!)
	      対象ディレクトリ中にオープンしているファイルがある場合、
	      ディレクトリを改名出来ない。
	      </para>
	      <para>既定値は <emphasis>yes</emphasis> である。</para>
	    </listitem>
	   </varlistentry>

          <varlistentry>
            <term>readdir_attr:aapl_rsize = yes | no</term>
            <listitem>
<!-- 原文 samba-4.4.15
	      <para>Return resource fork size in SMB2 FIND responses.</para>
	      <para>The default is <emphasis>yes</emphasis>.</para>
-->
              <para>SMB2 FIND の応答で リソースフォークのサイズを返す。</para>
              <para>既定値は <emphasis>yes</emphasis> である。</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>readdir_attr:aapl_finder_info = yes | no</term>
            <listitem>
<!-- 原文 samba-4.4.15
	      <para>Return FinderInfo in SMB2 FIND responses.</para>
	      <para>The default is <emphasis>yes</emphasis>.</para>
-->
              <para>SMB2 FIND の応答で FinderInfo を返す。</para>
              <para>既定値は <emphasis>yes</emphasis> である。</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>readdir_attr:aapl_max_access = yes | no</term>
            <listitem>
<!-- 原文 samba-4.4.15
	      <para>Return the user's effective maximum permissions in SMB2 FIND
	      responses. This is an expensive computation, setting this to off
	      pretends the use has maximum effective permissions.</para>
	      <para>The default is <emphasis>yes</emphasis>.</para>
-->
              <para>SMB2 FIND の応答で、ユーザの有効な最大のアクセス許可
	      を返す。これは計算に時間がかかるので、設定を off にすると、
	      最大の有効なアクセス許可を持っているとみなす。</para>
              <para>既定値は <emphasis>yes</emphasis> である。</para>
            </listitem>
          </varlistentry>

	</variablelist>
</refsect1>

<refsect1>
<!-- 原文 samba-4.4.15
	<title>EXAMPLES</title>
-->
	<title>例</title>

<programlisting>
        <smbconfsection name="[share]"/>
	<smbconfoption name="vfs objects">catia fruit streams_xattr</smbconfoption>
	<smbconfoption name="fruit:resource">file</smbconfoption>
	<smbconfoption name="fruit:metadata">netatalk</smbconfoption>
	<smbconfoption name="fruit:locking">netatalk</smbconfoption>
	<smbconfoption name="fruit:encoding">native</smbconfoption>
</programlisting>

</refsect1>

<refsect1>
<!-- 原文 samba-4.4.15
	<title>AUTHOR</title>
-->
	<title>著者</title>

<!-- 原文 samba-4.4.15
	<para>The original Samba software and related utilities
	were created by Andrew Tridgell. Samba is now developed
	by the Samba Team as an Open Source project similar
	to the way the Linux kernel is developed.</para>
-->
	<para>
	オリジナルの Samba ソフトウェアと関連するユーティリティは、Andrew
	Tridgell によって作成された。現在 Samba は Samba Team に
	よって、Linuxカーネルの開発と同様のオープンソースプロジェクト
	として開発が行なわれている。
	</para>

</refsect1>
<refsect1>
    <title>日本語訳</title>
    <para>このマニュアルページは Samba 4.4.11 - 4.4.13 に対応する。</para>
    <para>このドキュメントの Samba 4.2.0 - 4.4.13 対応の翻訳は
    <itemizedlist>
        <listitem><para>太田俊哉 (ribbon@samba.gr.jp)</para></listitem>
    </itemizedlist>
    によって行なわれた。</para>
</refsect1>

</refentry>
