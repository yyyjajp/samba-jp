<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE refentry PUBLIC "-//Samba-Team//DTD DocBook V4.2-Based Variant V1.0//EN" "http://www.samba.org/samba/DTD/samba-doc">
<refentry id="traffic_learner.7" lang="ja">

<refmeta>
	<refentrytitle>traffic_learner</refentrytitle>
	<manvolnum>7</manvolnum>
	<refmiscinfo class="source">Samba</refmiscinfo>
	<refmiscinfo class="manual">ユーザーコマンド</refmiscinfo>
	<refmiscinfo class="version">&doc.version;</refmiscinfo>
</refmeta>


<refnamediv>
	<refname>traffic_learner</refname>
	<refpurpose>トラフィック生成を支援する Samba ツール
	</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<cmdsynopsis>
		<command>traffic_learner</command>
		<arg choice="req">-o OUTPUT_FILE ...</arg>
		<arg choice="opt">-h</arg>
		<arg choice="opt">--dns-mode {inline|count}</arg>
		<arg choice="opt">SUMMARY_FILE</arg>
		<arg choice="opt">SUMMARY_FILE ...</arg>
	</cmdsynopsis>
</refsynopsisdiv>

<refsect1>
	<title>説明</title>
	<para>このプログラムは <citerefentry><refentrytitle>samba</refentrytitle>
	<manvolnum>7</manvolnum></citerefentry> システムの一部である。</para>
<!-- Samba 4.8.0
	<para>This tool assists with generation of Samba traffic.
	It takes a traffic-summary file (produced by
	<command>traffic_summary.pl</command>) as input and produces a
	traffic-model file that can be used by <command>traffic_replay</command>
	for traffic generation.</para>

	<para>The model file summarizes the types of traffic ('conversations'
	between a host and a Samba DC) that occur on a network. The model file
	describes the traffic in a way that allows it to be scaled so that
	either more (or fewer) packets get sent, and the packets can be sent at
	a faster (or slower) rate than that seen in the network.</para>
-->
        <para>このツールは Samba トラフィックを生成するために利用する。
	このツールでは、<command>traffic_summary.pl</command> によって生成される
	トラフィックサマリファイルを入力として、
        トラフィックモデルファイルを生成する。
        このファイルを <command>traffic_replay</command> が処理することで、トラフィックが生成される。
	</para>
	
	<para>モデルファイルには、ネットワーク上に発生するトラフィックの種類
	（ホストと Samba DC 間の 'やりとり'）がまとめられている。
        当該ファイルに記述されたトラフィックはスケール可能な形式であるため、
	ネットワーク上で観察される状態に対して、送信されるパケット数を増減したり、
	パケットの送信レートを増減したりできる
	</para>
</refsect1>

<refsect1>
	<title>オプション</title>

	<variablelist>

	<varlistentry>
	<term>-h|--help</term>
	<listitem><para>
	コマンドラインオプションの要約を表示する。
	</para></listitem>
	</varlistentry>

	<varlistentry>
	<term>SUMMARY_FILE</term>
<!-- samba-4.8.0
        <listitem><para>
	File containing a network traffic-summary. The traffic-summary file
	should be generated by <command>traffic_summary.pl</command> from a
	packet capture of actual network traffic.
	More than one file can be specified, in which case the traffic will
	be combined into a single traffic-model. If no SUMMARY_FILE is
	specified, this tool will read the traffic-summary from STDIN, i.e.
	you can pipe the output from traffic_summary.pl directly to this tool.
	</para></listitem>
-->
        <listitem><para>
	ネットワークのトラフィック要約を含むファイル。トラフィック要約ファイル
	は、実際のネットワークのパケットキャプチャから、
	<command>traffic_summary.pl</command> によって生成されなければならない。
	複数のファイルが指定でき、その場合は、トラフィックは、
	1つのトラフィックモデルにまとめられる。
	SUMMARY_FILE を指定しない場合、このツールはトラフィック要約を、
	標準入力から読む。すなわち、traffic_summary.pl からの出力を
	パイプでつないで直接このツールに繋げられる。
	</para></listitem>
        </varlistentry>

	<varlistentry>
	<term>-o|--out OUTPUT_FILE</term>
<!--- Samba 4.8.0
	<listitem><para>
	The traffic-model that is produced will be written to this file. The
	OUTPUT_FILE can then be passed to <command>traffic_replay</command>
	to generate (and manipulate) Samba network traffic.
	</para></listitem>
	</varlistentry>
-->
        <listitem><para>
	生成されたトラフィックモデルを書き込むファイルを指定する。
	OUTPUT_FILE は、Samba のネットワークトラフィックを生成
	(および操作)するために、<command>traffic_replay</command>
	に渡すことができる。
	</para></listitem>
	</varlistentry>

	<varlistentry>
	<term>--dns-mode [inline|count]</term>
<!-- Samba 4.8.0
	<listitem><para>
	How DNS traffic should be handled by the model.
	</para></listitem>
-->
        <listitem><para>
	モデルによって扱われる DNS トラフィックの指定。
	</para></listitem>
	</varlistentry>

	</variablelist>
</refsect1>

<refsect1>
	<title>例</title>

<!-- Samba 4.8.0
	<para>To take a traffic-summary file and produce a traffic-model
	file, use:</para>

	<para><command>traffic_learner traffic-summary.txt
	-o traffic-model.txt</command></para>

	<para>To generate a traffic-model from a packet capture, you can
	pipe the traffic summary to STDIN using:</para>

	<para><command>tshark -r capture.pcapng -T pdml |
	traffic_summary.pl | traffic_learner -o traffic-model.txt</command></para>
-->
        <para>traffic-summary ファイルを使い、traffic-model ファイルを
	生成するには、以下のように行なう:</para>

	<para><command>traffic_learner traffic-summary.txt
	-o traffic-model.txt</command></para>

	<para>パケットキャプチャから traffic-model を生成するには、
	以下のように、traffic summary を標準入力に繋ぐ:</para>

	<para><command>tshark -r capture.pcapng -T pdml |
	traffic_summary.pl | traffic_learner -o traffic-model.txt</command></para>
</refsect1>

<refsect1>
	<title>出力ファイル形式</title>

<!-- Samba 4.8.0
        <para>The output model file describes a Markov model estimating the
	probability of a packet occurring given the last two packets.</para>

	<para>The count of each continuation after a pair of
	successive packets is stored, and the ratios of these counts
	is used to calculate probabilities for the next packet.
	</para>
-->

<!-- Samba 4.10.0	
	<para>The model is stored in JSON format, and also contains
	information about the packet rate and DNS traffic rate.</para>
-->
        <para>出力モデルファイルは、最後の2つのパケットが与えられた時に
        発生するパケットの確率を推定するマルコフモデルを記述する。</para>

	<para>連続したパケットの組の後に来る、各(パケットの)連続が格納され、
	それらのカウントの比率が、次のパケットの確率を計算するのに使われる。
	</para>

	<para>モデルは JSON 形式で格納され、さらに、 パケットレートと
	DNS トラフィックレートについての情報も格納されている。
	</para>


<refsect2>
	<title>ngram listingの例</title>
<!--
        <para>The following listing shows a contrived example of a single ngram entry.
        </para>
-->
	<para>以下のリストは、単一の ngram エントリの不自然な例である。
        </para>

        <programlisting>
          "ngrams": {
             "ldap:0\tdcerpc:11": {
                 "lsarpc:77": 1,
                 "ldap:2": 370,
                 "ldap:3": 62,
                 "wait:3": 2,
                 "-": 1
             }, <lineannotation>[...]</lineannotation>
          }
        </programlisting>
<!-- Samba 4.8.0
        <para> This counts the observed continuations after an ldap
        packet with opcode 0 (a bind) followed by a dcerpc packet with
        opcode 11 (also a bind). The most common next packet is
        "<code>ldap:2</code>" which is an unbind, so this is the most
        likely packet type to be selected in replay. At the other
        extreme, lsarpc opcode 77 (lookup names) has been seen only
        once, and it is unlikely but possible that this will be
        selected in replay.
        </para>
-->
        <para>これは、LDAPパケット opcode 0 (バインド)に続いて
	dcerpc パケットが opcode 11(これもバインド)が来た後、
	観察された継続をカウントする。次に来るパケットで最も一般的な
	ものは、"<code>ldap:2</code>" という unbind を意味するものであり、
	これは、リプライで、最もよく選ばれるパケットタイプである。
	極端な別の例としては、lsarpc opcode 77 (lookup names) であり、
	これは1回だけ現れ、めったに発生しないが、リプライで選択される
	可能性はある。
        </para>
<!-- Samba 4.8.0
        <para> There are two special packet types here.
        "<code>wait:3</code>" refers to a temporary pause in the
        conversation, where the "<code>3</code>" pseudo-opcode indicates
        the length of the wait on an exponential scale. That is, a
        "<code>wait:4</code>" pause would be about 2.7 times longer that
        a "<code>wait:3</code>", which in turn would be similarly longer
        than a "<code>wait:2</code>".
	</para>
-->
        <para> 2つの特別なパケットタイプがある。
        "<code>wait:3</code>" は、 通信中の一時的な中断を参照し、
	"<code>3</code>" 疑似オペコードは、待ち時間の長さを指数形式で指示する。
        そのため、"<code>wait:4</code>" は、 "<code>wait:3</code>", よりも
	約 2.7 倍長くなり、同様に "<code>wait:2</code>" よりも長くなる。
        </para>

<!-- Samba 4.8.0
	<para>The other special packet is "-", which represents the
	limit of the conversation. In the example, this indicates that
	one observed conversation ended after this particular ngram.
	This special opcode is also used at the beginning of
	conversations, which are indicated by the ngram "<code>-\t-</code>".
	</para>
-->
	<para>その他の特別なパケットは "-" で、これは 通信の限界を示す。
	先の例では、この特定の ngram の後で、1つの観測された
	通信が終わることを指定する。この特別なオペコードは、
	ngram "<code>-\t-</code>" と示すことで、通信の開始にも使う。
	</para>


</refsect2>
</refsect1>

<refsect1>
	<title>バージョン</title>

	<para>このマニュアルページは Samba バージョン &doc.version; 用である。</para>

</refsect1>

<refsect1>
	<title>参照</title>
	<para>
	<citerefentry>
	<refentrytitle>traffic_replay</refentrytitle><manvolnum>7</manvolnum>
	</citerefentry>.
	</para>
</refsect1>

<refsect1>
	<title>著者</title>
	
	<para>オリジナルの Samba ソフトウェアと関連ユーティリティは、Andrew
	Tridgell によって作成された。現在 Samba は、Samba Team によって Linux
	カーネルの開発と同様に、オープンソースプロジェクトとして開発されている。
	</para>

<!-- Samba 4.8.0
	<para>The traffic_learner tool was developed by the Samba team at
	Catalyst IT Ltd.</para>

	<para>The traffic_learner manpage was written by Tim Beale.</para>
-->
        <para>traffic_learner ツールは、Catalyst IT Ltd の Samba team
	によって開発された。</para>

	<para>traffic_learner マニュアルページは Tim Beale が執筆した。</para>
</refsect1>

<refsect1>
	<title>日本語訳</title>
	<para>このマニュアルページは Samba 4.10.0 - 4.17.0 に対応する。</para>
        <para>このドキュメントの Samba 4.8.0 - 4.17.0 の翻訳は
	<itemizedlist>
		<listitem><para>太田俊哉 (ribbon@samba.gr.jp) </para></listitem>
	</itemizedlist>	
	によって行なわれた。</para>
</refsect1>


</refentry>
